!function(t){function e(e){for(var o,r,a=e[0],i=e[1],c=e[2],s=0,l=[];s<a.length;s++)r=a[s],Object.prototype.hasOwnProperty.call(E,r)&&E[r]&&l.push(E[r][0]),E[r]=0;for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);for(L&&L(e);l.length;)l.shift()();return P.push.apply(P,c||[]),n()}function n(){for(var t,e=0;e<P.length;e++){for(var n=P[e],o=!0,r=1;r<n.length;r++){var a=n[r];0!==E[a]&&(o=!1)}o&&(P.splice(e--,1),t=C(C.s=n[0]))}return t}var o=window.webpackHotUpdate;window.webpackHotUpdate=function(t,e){!function(t,e){if(!k[t]||!w[t])return;for(var n in w[t]=!1,e)Object.prototype.hasOwnProperty.call(e,n)&&(y[n]=e[n]);0==--g&&0===b&&j()}(t,e),o&&o(t,e)};var r,a=!0,i="677b77261b8b6aefaf63",c={},s=[],l=[];function u(t){var e={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:r!==t,active:!0,accept:function(t,n){if(void 0===t)e._selfAccepted=!0;else if("function"==typeof t)e._selfAccepted=t;else if("object"==typeof t)for(var o=0;o<t.length;o++)e._acceptedDependencies[t[o]]=n||function(){};else e._acceptedDependencies[t]=n||function(){}},decline:function(t){if(void 0===t)e._selfDeclined=!0;else if("object"==typeof t)for(var n=0;n<t.length;n++)e._declinedDependencies[t[n]]=!0;else e._declinedDependencies[t]=!0},dispose:function(t){e._disposeHandlers.push(t)},addDisposeHandler:function(t){e._disposeHandlers.push(t)},removeDisposeHandler:function(t){var n=e._disposeHandlers.indexOf(t);n>=0&&e._disposeHandlers.splice(n,1)},check:S,apply:x,status:function(t){if(!t)return p;f.push(t)},addStatusHandler:function(t){f.push(t)},removeStatusHandler:function(t){var e=f.indexOf(t);e>=0&&f.splice(e,1)},data:c[t]};return r=void 0,e}var f=[],p="idle";function d(t){p=t;for(var e=0;e<f.length;e++)f[e].call(null,t)}var h,y,m,g=0,b=0,v={},w={},k={};function A(t){return+t+""===t?+t:t}function S(t){if("idle"!==p)throw new Error("check() is only allowed in idle status");return a=t,d("check"),(e=1e4,e=e||1e4,new Promise((function(t,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var o=new XMLHttpRequest,r=C.p+""+i+".hot-update.json";o.open("GET",r,!0),o.timeout=e,o.send(null)}catch(t){return n(t)}o.onreadystatechange=function(){if(4===o.readyState)if(0===o.status)n(new Error("Manifest request to "+r+" timed out."));else if(404===o.status)t();else if(200!==o.status&&304!==o.status)n(new Error("Manifest request to "+r+" failed."));else{try{var e=JSON.parse(o.responseText)}catch(t){return void n(t)}t(e)}}}))).then((function(t){if(!t)return d("idle"),null;w={},v={},k=t.c,m=t.h,d("prepare");var e=new Promise((function(t,e){h={resolve:t,reject:e}}));for(var n in y={},E)O(n);return"prepare"===p&&0===b&&0===g&&j(),e}));var e}function O(t){k[t]?(w[t]=!0,g++,function(t){var e=document.createElement("script");e.charset="utf-8",e.src=C.p+""+t+"."+i+".hot-update.js",document.head.appendChild(e)}(t)):v[t]=!0}function j(){d("ready");var t=h;if(h=null,t)if(a)Promise.resolve().then((function(){return x(a)})).then((function(e){t.resolve(e)}),(function(e){t.reject(e)}));else{var e=[];for(var n in y)Object.prototype.hasOwnProperty.call(y,n)&&e.push(A(n));t.resolve(e)}}function x(e){if("ready"!==p)throw new Error("apply() is only allowed in ready status");var n,o,r,a,l;function u(t){for(var e=[t],n={},o=e.map((function(t){return{chain:[t],id:t}}));o.length>0;){var r=o.pop(),i=r.id,c=r.chain;if((a=R[i])&&!a.hot._selfAccepted){if(a.hot._selfDeclined)return{type:"self-declined",chain:c,moduleId:i};if(a.hot._main)return{type:"unaccepted",chain:c,moduleId:i};for(var s=0;s<a.parents.length;s++){var l=a.parents[s],u=R[l];if(u){if(u.hot._declinedDependencies[i])return{type:"declined",chain:c.concat([l]),moduleId:i,parentId:l};-1===e.indexOf(l)&&(u.hot._acceptedDependencies[i]?(n[l]||(n[l]=[]),f(n[l],[i])):(delete n[l],e.push(l),o.push({chain:c.concat([l]),id:l})))}}}}return{type:"accepted",moduleId:t,outdatedModules:e,outdatedDependencies:n}}function f(t,e){for(var n=0;n<e.length;n++){var o=e[n];-1===t.indexOf(o)&&t.push(o)}}e=e||{};var h={},g=[],b={},v=function(){console.warn("[HMR] unexpected require("+S.moduleId+") to disposed module")};for(var w in y)if(Object.prototype.hasOwnProperty.call(y,w)){var S;l=A(w);var O=!1,j=!1,x=!1,P="";switch((S=y[w]?u(l):{type:"disposed",moduleId:w}).chain&&(P="\nUpdate propagation: "+S.chain.join(" -> ")),S.type){case"self-declined":e.onDeclined&&e.onDeclined(S),e.ignoreDeclined||(O=new Error("Aborted because of self decline: "+S.moduleId+P));break;case"declined":e.onDeclined&&e.onDeclined(S),e.ignoreDeclined||(O=new Error("Aborted because of declined dependency: "+S.moduleId+" in "+S.parentId+P));break;case"unaccepted":e.onUnaccepted&&e.onUnaccepted(S),e.ignoreUnaccepted||(O=new Error("Aborted because "+l+" is not accepted"+P));break;case"accepted":e.onAccepted&&e.onAccepted(S),j=!0;break;case"disposed":e.onDisposed&&e.onDisposed(S),x=!0;break;default:throw new Error("Unexception type "+S.type)}if(O)return d("abort"),Promise.reject(O);if(j)for(l in b[l]=y[l],f(g,S.outdatedModules),S.outdatedDependencies)Object.prototype.hasOwnProperty.call(S.outdatedDependencies,l)&&(h[l]||(h[l]=[]),f(h[l],S.outdatedDependencies[l]));x&&(f(g,[S.moduleId]),b[l]=v)}var _,T=[];for(o=0;o<g.length;o++)l=g[o],R[l]&&R[l].hot._selfAccepted&&b[l]!==v&&T.push({module:l,errorHandler:R[l].hot._selfAccepted});d("dispose"),Object.keys(k).forEach((function(t){!1===k[t]&&function(t){delete E[t]}(t)}));for(var M,L,F=g.slice();F.length>0;)if(l=F.pop(),a=R[l]){var G={},D=a.hot._disposeHandlers;for(r=0;r<D.length;r++)(n=D[r])(G);for(c[l]=G,a.hot.active=!1,delete R[l],delete h[l],r=0;r<a.children.length;r++){var N=R[a.children[r]];N&&((_=N.parents.indexOf(l))>=0&&N.parents.splice(_,1))}}for(l in h)if(Object.prototype.hasOwnProperty.call(h,l)&&(a=R[l]))for(L=h[l],r=0;r<L.length;r++)M=L[r],(_=a.children.indexOf(M))>=0&&a.children.splice(_,1);for(l in d("apply"),i=m,b)Object.prototype.hasOwnProperty.call(b,l)&&(t[l]=b[l]);var U=null;for(l in h)if(Object.prototype.hasOwnProperty.call(h,l)&&(a=R[l])){L=h[l];var I=[];for(o=0;o<L.length;o++)if(M=L[o],n=a.hot._acceptedDependencies[M]){if(-1!==I.indexOf(n))continue;I.push(n)}for(o=0;o<I.length;o++){n=I[o];try{n(L)}catch(t){e.onErrored&&e.onErrored({type:"accept-errored",moduleId:l,dependencyId:L[o],error:t}),e.ignoreErrored||U||(U=t)}}}for(o=0;o<T.length;o++){var W=T[o];l=W.module,s=[l];try{C(l)}catch(t){if("function"==typeof W.errorHandler)try{W.errorHandler(t)}catch(n){e.onErrored&&e.onErrored({type:"self-accept-error-handler-errored",moduleId:l,error:n,originalError:t}),e.ignoreErrored||U||(U=n),U||(U=t)}else e.onErrored&&e.onErrored({type:"self-accept-errored",moduleId:l,error:t}),e.ignoreErrored||U||(U=t)}}return U?(d("fail"),Promise.reject(U)):(d("idle"),new Promise((function(t){t(g)})))}var R={},E={0:0},P=[];function C(e){if(R[e])return R[e].exports;var n=R[e]={i:e,l:!1,exports:{},hot:u(e),parents:(l=s,s=[],l),children:[]};return t[e].call(n.exports,n,n.exports,function(t){var e=R[t];if(!e)return C;var n=function(n){return e.hot.active?(R[n]?-1===R[n].parents.indexOf(t)&&R[n].parents.push(t):(s=[t],r=n),-1===e.children.indexOf(n)&&e.children.push(n)):(console.warn("[HMR] unexpected require("+n+") from disposed module "+t),s=[]),C(n)},o=function(t){return{configurable:!0,enumerable:!0,get:function(){return C[t]},set:function(e){C[t]=e}}};for(var a in C)Object.prototype.hasOwnProperty.call(C,a)&&"e"!==a&&"t"!==a&&Object.defineProperty(n,a,o(a));return n.e=function(t){return"ready"===p&&d("prepare"),b++,C.e(t).then(e,(function(t){throw e(),t}));function e(){b--,"prepare"===p&&(v[t]||O(t),0===b&&0===g&&j())}},n.t=function(t,e){return 1&e&&(t=n(t)),C.t(t,-2&e)},n}(e)),n.l=!0,n.exports}C.m=t,C.c=R,C.d=function(t,e,n){C.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},C.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},C.t=function(t,e){if(1&e&&(t=C(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(C.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)C.d(n,o,function(e){return t[e]}.bind(null,o));return n},C.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return C.d(e,"a",e),e},C.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},C.p="",C.h=function(){return i};var _=window.webpackJsonp=window.webpackJsonp||[],T=_.push.bind(_);_.push=e,_=_.slice();for(var M=0;M<_.length;M++)e(_[M]);var L=T;P.push([415,1]),n()}({235:function(t,e,n){},238:function(t,e,n){},242:function(t,e,n){},243:function(t,e,n){},244:function(t,e,n){},245:function(t,e,n){},246:function(t,e,n){},247:function(t,e,n){},248:function(t,e,n){},249:function(t,e,n){},250:function(t,e,n){},251:function(t,e,n){},252:function(t,e,n){},253:function(t,e,n){},254:function(t,e,n){},255:function(t,e,n){},256:function(t,e,n){},257:function(t,e,n){},258:function(t,e,n){},259:function(t,e,n){},260:function(t,e,n){},261:function(t,e,n){},262:function(t,e,n){},263:function(t,e,n){},264:function(t,e,n){},265:function(t,e,n){},302:function(t){t.exports=JSON.parse('{"en":{"Account":"Account","Account changed, page will reload!":"Account changed, app will reload!","Add":"Add","Add any GPX, GeoJSON, KML files or WMS layers to map from layers menu or drag and drop file.":"Add any GPX, GeoJSON, KML files or WMS layers to map from layers menu or drag and drop file.","Add caches and map objects to geotrip. Reorder geotrip.":"Add caches and map objects to geotrip. Reorder geotrip.","Add caches to map":"Add caches to map","Add features from map":"Add features from map","Add File layer":"Add File layer","Add geocaches to map":"Add geocaches to map","Add to geotrip":"Add to geotrip","Add WMS layer":"Add WMS layer","Added":"Added","Aerial":"Aerial","Aerial Estonia":"Aerial Estonia","An unknown error occurred.":"An unknown error occurred.","and copy page content to textbox below":"and copy page content to textbox below","and drop it on map or import file from layers menu":"and drop it on map or import file from layers menu","and log in":"and log in","Angle":"Angle","App resetted, page will reload!":"App resetted, app will reload!","App will recognize if geocaches are added to map.":"App will recognize if geocaches are added to map.","Archived":"Archived","Area":"Area","As crow flies":"As crow flies","Available":"Available","Bookmark deleted!":"Bookmark deleted!","Caches":"Caches","Change language. App will reload after change!":"Change language. App will reload after change!","Clear trip":"Clear trip","Close":"Close","Config":"Config","Coordinate":"Coordinate","Coordinates":"Coordinates","copied to clipboard":"copied to clipboard","Country codes":"Country codes","Debug":"Debug","Debug changed, app will reload!":"Debug changed, app will reload!","Debug mode. Will write debug logs into file. App will reload after change!":"Debug mode. Will write debug logs into file. App will reload after change!","Directions":"Directions","Directions from here":"Directions from here","Directions to here":"Directions to here","Disabled":"Disabled","Download":"Download","Download debug log":"Download debug log","download GPX from":"download GPX from","Driving":"Driving","Driving directions between points or from your current location":"Driving directions between points or from your current location","Edit OSM here":"Edit OSM here","Empty file":"Empty file","Enter geopeitus.ee or geocaching.com username. App will reload after change!":"Enter geopeitus.ee or geocaching.com username. App will reload after change!","Error creating layer":"Error creating layer","Feature":"Feature","Features":"Features","features":"features","Filter":"Filter","Filter and search caches on map.":"Filter and search caches on map.","Find streetview link and measure tools from context menu.":"Find streetview link and measure tools from context menu.","Found":"Found","GeocacheLoader":"Load geocaches","Geocaches":"Geocaches","Geocache|Event Cache":"Event Cache","Geocache|Letterbox Hybrid":"Letterbox Hybrid","Geocache|Locationless Cache":"Locationless Cache","Geocache|Multi-cache":"Multi-cache","Geocache|Traditional Cache":"Traditional Cache","Geocache|Unknown Cache":"Unknown Cache","Geocache|Virtual Cache":"Virtual Cache","Geocache|Webcam Cache":"Webcam Cache","Geocache|Whereigo Cache":"Whereigo Cache","Geop is progressive web application with partial offline support.":"Geop is progressive web application with partial offline support.","Geotrip":"Geotrip","Geotrip reordered by optimum path":"Geotrip reordered by optimum path","Go to":"Go to","gpxActive":"Active caches","gpxAll":"All caches (active, archived, unavailable)","here":"here","Hiking":"Hiking","Insert WMS/WMTS URL":"Insert WMS/WMTS URL","Install app to home screen":"Install app to home screen","Install it to Your home screen.":"Install it to Your home screen.","Install web app to your home screen.":"Install web app to your home screen.","Invalid route":"Invalid route","Keep awake":"Keep awake","Keep screen on. Use with caution, might train device battery!":"Keep screen on. Use with caution, might train device battery!","Language":"Language","Language changed, page will reload!":"Language changed, app will reload!","Large":"Large","Layers":"Layers","Length":"Length","Less than 2 pair of coordinates, aborting!":"Less than 2 pair of coordinates, aborting!","Limit address search with comma separated list of country codes (ee,fi - Estonia, Finland). Empty means no limit.":"Limit address search with comma separated list of country codes (ee,fi - Estonia, Finland). Empty means no limit.","Location information is unavailable.":"Location information is unavailable.","Map":"Map","Measure":"Measure","Micro":"Micro","Missing LAYERS parameter":"Missing LAYERS parameter","Missing provider, aborting!":"Missing provider, aborting!","Missing SRS parameter":"Missing SRS parameter","My location":"My location","Navigate to cache with two tracking mode":"Navigate to cache with two tracking mode","NB! Turning this off and sharing bookmark will store possibly big amount of data in service. It might fail. Use with caution!":"NB! Turning this off and sharing bookmark will store possibly big amount of data in service. It might fail. Use with caution!","New Cache":"New Cache","No baselyers added":"No baselyers added","No overlays added":"No overlays added","No result":"No result","No route between start and destination":"No route between start and destination","No valid input coordinates, aborting!":"No valid input coordinates, aborting!","North up!":"North up!","Not Found":"Not Found","Not valid GeoJSON":"Not valid GeoJSON","Off":"Off","On":"On","Optimize":"Optimize","or":"or","or open":"or open","Owner":"Owner","Query string empty, aborting!":"Query string empty, aborting!","Query string too short, aborting!":"Query string too short, aborting!","Quick links":"Quick links","Radius":"Radius","Regular":"Regular","Reset":"Reset","Reset app":"Reset app","Reset app to default. App will reload!":"Reset app to default. App will reload!","Retry directions":"Retry directions","Routing":"Routing","Routing disabled":"Routing disabled","Routing input test failed, aborting!":"Routing input test failed, aborting!","Search":"Search","Search and display coordinates in WGS, L-Est, UTM and MGRS system.":"Search and display coordinates in WGS, L-Est, UTM and MGRS system.","Search coordinates":"Search coordinates","Select routing profile or disable routing":"Select routing profile or disable routing","Settings":"Settings","Share":"Share","Share bookmark":"Share bookmark","Share only features added to geotrip.":"Share only features added to geotrip.","Share only geotrip features":"Share only geotrip features","Share snapshot of app state via link or QR-code. Download geotrip as GPX-file.":"Share snapshot of app state via link or QR-code. Download geotrip as GPX-file.","Show 160m radius":"Show 160m radius","Show distance and duration along route, not from beginning to end":"Show distance and duration along route, not from beginning to end","Small":"Small","Street view":"Street view","The request to get user location timed out.":"The request to get user location timed out.","to finish, click on beginning":"to finish, click on beginning","to finish, click on end":"to finish, click on end","Toggle fullscreen":"Toggle fullscreen","Too Many Requests":"Too Many Requests","Topo":"Topo","Unable to copy to clipboard":"Unable to copy to clipboard","Unable to delete bookmark":"Unable to delete bookmark","Unable to determine ordering":"Unable to determine ordering","Unable to find layer extent":"Unable to find layer extent","Unable to find location.":"Unable to find location.","Unable to find route":"Unable to find route","Unable to get routing result":"Unable to get routing result!","Unable to load bookmark":"Unable to load bookmark","Unable to perform search!":"Unable to perform search!","Unable to save bookmark":"Unable to save bookmark","Unavailable":"Unavailable","Unknown":"Unknown","Unsupported file type":"Unsupported file type","URL":"URL","URL is not valid WMS resource!":"URL is not valid WMS resource!","User denied the request for Geolocation.":"User denied the request for Geolocation.","Username":"Username","Waypoint|Final Location":"Final Location","Waypoint|Parking Area":"Parking Area","Waypoint|Physical Stage":"Physical Stage","Waypoint|Reference Point":"Reference Point","Waypoint|Stages of a Multicache":"Stages of a Multicache","Waypoint|Trailhead":"Trailhead","Waypoint|Virtual Stage":"Virtual Stage","Zoom in":"Zoom in","Zoom out":"Zoom out"},"et":{"Account":"Konto","Account changed, page will reload!":"Konto muudetud, teeme restardi!","Add":"Lisa","Add any GPX, GeoJSON, KML files or WMS layers to map from layers menu or drag and drop file.":"Lisa GPX, GeoJSON, KML fail või WMS kiht kaardile. Kasuta kihtide menüüd või lohista fail kaardile.","Add caches and map objects to geotrip. Reorder geotrip.":"Lisa aardeid ja kaardiobjekte geotuurile. Järjesta geotuuri.","Add caches to map":"Lisa aardeid kaardile","Add features from map":"Lisa kaardilt objekte","Add File layer":"Lisa fail","Add geocaches to map":"Lisa aarded kaardile","Add to geotrip":"Lisa geotuuri","Add WMS layer":"Lisa WMS","Added":"Lisatud","Aerial":"Satipilt","Aerial Estonia":"Foto","An unknown error occurred.":"Tekkis tundmatu viga.","and copy page content to textbox below":"ja kopeeri lehe sisu alla tekstikasti","and drop it on map or import file from layers menu":"ja lohista fail kaardile või impordi fail kihtide menüüst","and log in":"ja logi sisse","Angle":"Nurk","App resetted, page will reload!":"Rakendus lähtestatud, teeme restardi!","App will recognize if geocaches are added to map.":"Rakendus saab aru, kui aarded on kaardile lisatud.","Archived":"Arhiveeritud","Area":"Pindala","As crow flies":"Linnulennult","Available":"Aktiivsed","Bookmark deleted!":"Järjehoidja kustutatud!","Caches":"Aarded","Change language. App will reload after change!":"Muuda rakenduse keel. Rakendus taaskäivitub peale muutmist!","Clear trip":"Tühjenda","Close":"Sulge","Config":"Seaded","Coordinate":"Koordinaat","Coordinates":"Koordinaadid","copied to clipboard":"kopeeritud","Country codes":"Riigi kood","Debug":"Silumine","Debug changed, app will reload!":"Silumisrežiimi muutus. Rakendus taaskäivitub!","Debug mode. Will write debug logs into file. App will reload after change!":"Silumisrežiim. Silumise logid kirjutatakse faili. Rakendus taaskäivitub peale muutmist!","Directions":"Teekond","Directions from here":"Teekonna algus","Directions to here":"Teekonna lõpp","Disabled":"Keelatud","Download":"Lae alla","Download debug log":"Lae alla logifail","download GPX from":"lae GPX","Driving":"Auto","Driving directions between points or from your current location":"Teekonna arvutus kahe punkti või kaardiobjekti vahel ja kasutaja asukohast sihtpunkti.","Edit OSM here":"Muuda OSMi","Empty file":"Tühi fail","Enter geopeitus.ee or geocaching.com username. App will reload after change!":"Sisesta geopeitus.ee või geocaching.com kasutajanimi. Rakendus taaskäivitub peale muutmist!","Error creating layer":"Kihi loomine ebaõnnestus","Feature":"Objekt","Features":"Objektid","features":"objekti","Filter":"Filter","Filter and search caches on map.":"Filtreeri ja otsi aardeid.","Find streetview link and measure tools from context menu.":"Parema kliki menüüst leiad tänavavaate ja mõõtmise tööriistad.","Found":"Leitud","GeocacheLoader":"Lae aarded","Geocaches":"Aarded","Geocache|Event Cache":"Sündmusaare","Geocache|Letterbox Hybrid":"Kirjakastiaare","Geocache|Locationless Cache":"Asukohata aare","Geocache|Multi-cache":"Multiaare","Geocache|Traditional Cache":"Tavaline aare","Geocache|Unknown Cache":"Mõistatusaare","Geocache|Virtual Cache":"Virtuaalne aare","Geocache|Webcam Cache":"Veebikaamera aare","Geocache|Whereigo Cache":"Whereigo aare","Geop is progressive web application with partial offline support.":"Geop on progressiivne veebirakendus (PWA) osalise võrguta töötamise toega.","Geotrip":"Geotuur","Geotrip reordered by optimum path":"Geotuur järjestatud lühima teekonna järgi","Go to":"Mine","gpxActive":"Aktiivsed aarded","gpxAll":"Kõik aarded (aktiivsed, arhiveeritud, ajutiselt kättesaamatud)","here":"siit","Hiking":"Matk","Insert WMS/WMTS URL":"Sisesta siia kasti WMS/WMTS aadress","Install app to home screen":"Paigalda rakendus","Install it to Your home screen.":"Paigalda rakendus avalehele.","Install web app to your home screen.":"Paigalda rakendus oma seadmesse.","Invalid route":"Vale teekond","Keep awake":"Hoia ekraan töös","Keep screen on. Use with caution, might train device battery!":"Hoia ekraan aktiivne. Pidevalt töötav ekraan kulutab akut!","Language":"Keel","Language changed, page will reload!":"Keel muudetud, teeme restardi!","Large":"Suur","Layers":"Kihid","Length":"Vahemaa","Less than 2 pair of coordinates, aborting!":"Peab olema vähemalt kaks punkti, lõpetan!","Limit address search with comma separated list of country codes (ee,fi - Estonia, Finland). Empty means no limit.":"Piira aadressiotsingut riigiti. Mitme riigi otsingu jaoks eralda komaga (ee,fi - Eesti, Soome). Tühi otsib üle maailma.","Location information is unavailable.":"Asukoha info ei ole kättesaadav.","Map":"Kaart","Measure":"Mõõda","Micro":"Mikro","Missing LAYERS parameter":"WMS aadress peab sisaldama LAYERS parameetrit","Missing provider, aborting!":"Puudub teenus!","Missing SRS parameter":"WMS aadress peab sisaldama SRS parameetrit","My location":"Asukoht","Navigate to cache with two tracking mode":"Asukoha näitamine kahes režiimis (asukoht liigub ekraanil; asukoht on ekraanil fikseeritud).","NB! Turning this off and sharing bookmark will store possibly big amount of data in service. It might fail. Use with caution!":"NB! Ei soovita seda välja lülitada, järjehoidja salvestamisel võidakse saata teenusesse suur hulk andmeid!","New Cache":"Uued aarded","No baselyers added":"Pole aluskaarte","No overlays added":"Pole kaardikihte","No result":"Otsingutulemused puuduvad","No route between start and destination":"Teekond alguse ja sihtpunkti vahel puudub","No valid input coordinates, aborting!":"Sisendkoordinaadid ei vasta nõuetele, ei otsi!","North up!":"Põhi!","Not Found":"Leidmata","Not valid GeoJSON":"Ei ole korrektne GeoJSON","Off":"Off","On":"On","Optimize":"Optimeeri","or":"või","or open":"või ava","Owner":"Omanik","Query string empty, aborting!":"Otsingutekst puudu, ei otsi!","Query string too short, aborting!":"Otsingutekst liiga lühike, ei otsi!","Quick links":"Kiirviited","Radius":"Raadius","Regular":"Normaalne","Reset":"Lähtesta","Reset app":"Rakenduse vaikeseaded","Reset app to default. App will reload!":"Taasta rakenduse vaikeseaded. Rakendus taaskäivitub peale muutmist!","Retry directions":"Uuesti","Routing":"Teekond","Routing disabled":"Teekonna leidmine keelatud","Routing input test failed, aborting!":"Teekonna sisendid ei ole õiged!","Search":"Otsi","Search and display coordinates in WGS, L-Est, UTM and MGRS system.":"Otsi ja kuva koordinaate WGS, L-Est, UTM ja MGRS koordinaatsüsteemides.","Search coordinates":"Otsi koordinaate","Select routing profile or disable routing":"Vali teekonna profiil või keela teekond","Settings":"Seaded","Share":"Jaga","Share bookmark":"Jaga järjehoidjat","Share only features added to geotrip.":"Jaga ainult objekte, mis on lisatud geotuurile.","Share only geotrip features":"Jaga ainult geotuuri","Share snapshot of app state via link or QR-code. Download geotrip as GPX-file.":"Jaga kaardivaadet lingi või QR-koodiga. Ekspordi geotripp GPX-failina.","Show 160m radius":"Näita 160m raadiuseid","Show distance and duration along route, not from beginning to end":"Kuva teekonna pikkus ja aeg mööda teekonda, mitte linnulennult","Small":"Väike","Street view":"Tänavavaade","The request to get user location timed out.":"Asukoha päring ebaõnnestus.","to finish, click on beginning":"lõpetamiseks vajuta algusesse","to finish, click on end":"lõpetamiseks vajuta viimasele","Toggle fullscreen":"Täisekraan","Too Many Requests":"Päringute limiit on täis","Topo":"Põhikaart","Unable to copy to clipboard":"Ei saanud kopeerida","Unable to delete bookmark":"Ei saanud järjehoidjat kustutada!","Unable to determine ordering":"Ei saa järjekorda määrata!","Unable to find layer extent":"Ei leia kihi ulatust","Unable to find location.":"Ei leia asukohta!","Unable to find route":"Ei leia teekonda","Unable to get routing result":"Tulemus puudub!","Unable to load bookmark":"Ei saanud järjehoidjat laadida!","Unable to perform search!":"Otsing luhtus!","Unable to save bookmark":"Ei saanud järjehoidjat salvestada!","Unavailable":"Ajutiselt kättesaamatud","Unknown":"Teadmata","Unsupported file type":"Seda faili ei toeta hetkel","URL":"URL","URL is not valid WMS resource!":"URL ei ole õige!","User denied the request for Geolocation.":"Kasutaja tühistas päringu.","Username":"Kasutajanimi","Waypoint|Final Location":"Lõpp-punkt","Waypoint|Parking Area":"Parkla","Waypoint|Physical Stage":"Vahepunkt","Waypoint|Reference Point":"Lisapunkt","Waypoint|Stages of a Multicache":"Vahepunkt","Waypoint|Trailhead":"Matkaraja algus","Waypoint|Virtual Stage":"Virtuaalne vahepunkt","Zoom in":"Suurenda","Zoom out":"Vähenda"}}')},355:function(t,e,n){var o=n(235);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(235,(function(){var e=n(235);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},359:function(t,e,n){var o=n(238);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(238,(function(){var e=n(238);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},386:function(t,e,n){var o=n(242);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(242,(function(){var e=n(242);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},387:function(t,e,n){var o=n(243);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(243,(function(){var e=n(243);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},388:function(t,e,n){var o=n(244);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(244,(function(){var e=n(244);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},389:function(t,e,n){var o=n(245);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(245,(function(){var e=n(245);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},390:function(t,e,n){var o=n(246);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(246,(function(){var e=n(246);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},391:function(t,e,n){var o=n(247);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(247,(function(){var e=n(247);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},395:function(t,e,n){var o=n(248);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(248,(function(){var e=n(248);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},396:function(t,e,n){var o=n(249);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(249,(function(){var e=n(249);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},397:function(t,e,n){var o=n(250);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(250,(function(){var e=n(250);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},400:function(t,e,n){var o=n(251);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(251,(function(){var e=n(251);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},401:function(t,e,n){var o=n(252);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(252,(function(){var e=n(252);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},402:function(t,e,n){var o=n(253);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(253,(function(){var e=n(253);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},403:function(t,e,n){var o=n(254);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(254,(function(){var e=n(254);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},404:function(t,e,n){var o=n(255);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(255,(function(){var e=n(255);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},405:function(t,e,n){var o=n(256);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(256,(function(){var e=n(256);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},406:function(t,e,n){var o=n(257);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(257,(function(){var e=n(257);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},407:function(t,e,n){var o=n(258);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(258,(function(){var e=n(258);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},408:function(t,e,n){var o=n(259);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(259,(function(){var e=n(259);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},409:function(t,e,n){var o=n(260);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(260,(function(){var e=n(260);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},410:function(t,e,n){var o=n(261);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(261,(function(){var e=n(261);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},411:function(t,e,n){var o=n(262);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(262,(function(){var e=n(262);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},412:function(t,e,n){var o=n(263);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(263,(function(){var e=n(263);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},413:function(t,e,n){var o=n(264);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(264,(function(){var e=n(264);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},414:function(t,e,n){var o=n(265);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(t.exports=o.locals),t.hot.accept(265,(function(){var e=n(265);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,o=0;for(n in t){if(!e||t[n]!==e[n])return!1;o++}for(n in e)o--;return 0===o}(o.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(e)})),t.hot.dispose((function(){a()}))},415:function(t,e,n){"use strict";n.r(e),n.d(e,"reloadApp",(function(){return Qc}));n(131),n(39),n(38),n(44),n(27),n(272),n(94),n(15),n(22),n(75),n(25),n(26),n(18),n(19),n(281),n(76),n(61),n(343);var o=n(299),r=n.n(o),a=n(300),i=n.n(a),c=n(52),s=n(190);n(282);function l(t){return function(t){for(var e=2,n="",o=t.length,r=0,a=0;a<o;a++)e=a%3,a>0&&4*a/3%76==0&&(n+="\r\n"),r|=t[a]<<(16>>>e&24),2!==e&&t.length-a!=1||(n+=String.fromCharCode(u(r>>>18&63),u(r>>>12&63),u(r>>>6&63),u(63&r)),r=0);return n.substr(0,n.length-2+e)+(2===e?"":1===e?"=":"==")}(function(t){for(var e,n,o=t.length,r=0,a=0;a<o;a++)n=t.charCodeAt(a),r+=n<128?1:n<2048?2:n<65536?3:n<2097152?4:n<67108864?5:6;e=new Uint8Array(r);for(var i=0,c=0;i<r;c++)(n=t.charCodeAt(c))<128?e[i++]=n:n<2048?(e[i++]=192+(n>>>6),e[i++]=128+(63&n)):n<65536?(e[i++]=224+(n>>>12),e[i++]=128+(n>>>6&63),e[i++]=128+(63&n)):n<2097152?(e[i++]=240+(n>>>18),e[i++]=128+(n>>>12&63),e[i++]=128+(n>>>6&63),e[i++]=128+(63&n)):n<67108864?(e[i++]=248+(n>>>24),e[i++]=128+(n>>>18&63),e[i++]=128+(n>>>12&63),e[i++]=128+(n>>>6&63),e[i++]=128+(63&n)):(e[i++]=252+n/1073741824,e[i++]=128+(n>>>24&63),e[i++]=128+(n>>>18&63),e[i++]=128+(n>>>12&63),e[i++]=128+(n>>>6&63),e[i++]=128+(63&n));return e}(t))}function u(t){return t<26?t+65:t<52?t+71:t<62?t-4:62===t?43:63===t?47:65}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var p=new r.a,d=[];function h(t){return new Promise((function(e,n){try{var o=document.createElement("textarea");o.value=t,o.style.position="absolute",o.style.left="-9999px",document.body.appendChild(o),o.select();var r=document.execCommand("copy");document.body.removeChild(o),r?e():n(Error(r))}catch(t){n(t)}}))}function y(t,e){!function(t,e){var n=document.createEvent("MouseEvent"),o=document.createElement("a");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.setAttribute("href",e),o.setAttribute("download",t),o.dispatchEvent(n)}(t,"data:text/gpx+xml;base64,"+l('<?xml version="1.0" encoding="utf-8"?>'+(new s.a).writeFeatures(e)))}function m(){p.enable(),document.removeEventListener("click",m,!1)}function g(t){return 360*t/(2*Math.PI)}function b(t){return t*Math.PI*2/360}function v(t){return 1/Math.cos(b(t[1]))}function w(t){if(t&&t.length>1)try{return JSON.parse('{"'+t.slice(1).replace(/&/g,'","').replace(/=/g,'":"')+'"}',(function(t,e){return""===t?e:decodeURIComponent(e)}))}catch(t){return null}}function k(t){var e=t.match(/^(?:(https?:)\/\/)?(([^:/?#]*)(?::([0-9]+))?)([/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);return e&&{href:t,protocol:e[1],host:e[2],hostname:e[3],port:e[4],pathname:e[5],search:e[6],hash:e[7],query:w(e[6])||{}}}function A(t){var e=Object.keys(t.query).map((function(e){return e+"="+t.query[e]})).join("&");return t.protocol+"//"+t.host+t.pathname+"?"+e}function S(){return Math.random().toString(36).substr(2,10)}function O(t,e){var n;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(t))return 3===(n=t.substring(1).split("")).length&&(n=[n[0],n[0],n[1],n[1],n[2],n[2]]),"rgba("+[(n="0x"+n.join(""))>>16&255,n>>8&255,255&n].join(",")+","+e+")";throw new Error("Bad Hex")}function j(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[2,2];if(e||(e=Object(c.c)(t)),e>1e4){var o=Math.pow(10,n[0]);return"".concat(Math.round(e/1e3*o)/o," km")}var r=Math.pow(10,n[1]);return"".concat(Math.round(e*r)/r," m")}function x(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[2,2];if(e||(e=Object(c.a)(t)),e>1e6){var o=Math.pow(10,n[0]);return"".concat(Math.round(e/1e6*o)/o," km<sup>2</sup>")}var r=Math.pow(10,n[0]);return"".concat(Math.round(e*r)/r," m<sup>2</sup>")}function R(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Date(t),o=(1+n.getMonth()).toString();o=o.length>1?o:"0"+o;var r=n.getDate().toString();return r=r.length>1?r:"0"+r,e?r+"."+o:n.getFullYear()+"."+o+"."+r}function E(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"timestamp",n=null;switch(e){case"timestamp":n=new Date(t).toTimeString().slice(0,8);break;case"seconds":var o=Math.floor(t/60/60),r=Math.floor(60*(t/60/60-o)),a=Math.floor(60*(60*(t/60/60-o)-r));n="".concat(o,"h ").concat(r,"m ").concat(a,"s")}return n}function P(t){return JSON.parse(JSON.stringify(t))}function C(t,e){var n=g(Math.atan2(e[0]-t[0],e[1]-t[1]));return n<0&&(n=360+n),n}var _=!0,T={oldURL:null,newURL:null,hash:null},M=[];function L(t){var e={};return t&&t.slice(1).split("&").forEach((function(t){var n=t.split("=");e[n[0]]=n[1]})),e}function F(t){return t?T.hash[t]:T.hash}function G(t){if(_){var e;if(t){var n=Object.assign(T.hash,t);Object.keys(n).forEach((function(t){null!==n[t]&&void 0!==n[t]||delete n[t]})),T.hash=n,e=function(t){return"#"+Object.keys(t).map((function(e){return e+"="+t[e]})).join("&")}(T.hash)}else T.hash=t,e=" ";window.history.pushState(T.hash,"geop",e)}else _=!0}function D(t){M.push(t)}function N(t){return[Math.round(1e5*t.center[1])/1e5,Math.round(1e5*t.center[0])/1e5,Math.round(100*t.zoom)/100,parseInt(t.rotation),t.baseLayer].join("/")}var U={locale:"et",layerManager:!0,searchEnabled:!0,locateEnabled:!0,mouseCoordinates:!0,settings:!0,tooltip:!0,featureInfo:!0,scaleLine:!0,streetView:!0,measureTool:!0,fullScreen:!0,mousePosition:!0,geoLocation:!0,shareState:!0,shareOnlyTripFeatures:!0,settingsTabOpen:"settings-tab",debug:!1,debugFile:"geop_debug.log",nominatimCountries:"ee",routing:{provider:"openrouteservice",profile:"driving"}},I={el:"#map",center:[25.5,58.5],zoom:7,rotation:0,extent:[21,57,29,60],projection:"EPSG:3857",baseLayer:"osm",minZoom:0,maxZoom:20,clustered:!1},W={ideditor:"https://www.openstreetmap.org/edit?editor=id#background=custom:http://tiles.maaamet.ee/tm/tms/1.0.0/foto@GMC/{z}/{x}/{-y}.png&map=",nominatim:"https://nominatim.openstreetmap.org",jsonstore:"https://projekt-gp.ee/api/v1/bookmark",qrcode:"http://api.qrserver.com/v1/create-qr-code/?size=150x150&data=",osrm:{directions:"https://router.project-osrm.org/route/v1/"},openrouteservice:{key:"5b3ce3597851110001cf6248b99b83882966492086eee3c4a0522e9c",directions:"https://api.openrouteservice.org/v2/directions/",optimize:"https://api.openrouteservice.org/optimization/"},google:{streetview:"https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=",directions:"https://www.google.com/maps/dir/?api=1&destination="},wmsexamples:{"Kataster (WMS)":"http://kaart.maaamet.ee/wms/alus?layers=TOPOYKSUS_6569,TOPOYKSUS_7793&SRS=EPSG:3301&title=Kataster","Looduskaitse (WMS)":"https://gsavalik.envir.ee/geoserver/eelis/ows?layers=kr_kaitseala,kr_hoiuala,kr_hooldatav_skv,kr_looduslik_skv,kr_reservaat,kr_vep,plk,kr_kohalik_objekt_pv,kr_yksikobjekti_kaitsetsoon,kr_kohalik_objekt,kr_yksikobjektid&SRS=EPSG:3301&opacity=0.9&title=Looduskaitse","Pärandkultuur (WMS)":"https://gsavalik.envir.ee/geoserver/eelis/ows?layers=pk_objekt_metsas&SRS=EPSG:3301&title=Pärandkultuur","LV foto (WMS)":"https://wmsbm3.kartes.lv/BMdMiAsVp/wgs/orto/?title=LV orto&layers=0&srs=EPSG:3857","LV kaart (WMS)":"https://wmsbm3.kartes.lv/BMdMiAsVp/wgs/15/?title=LV&layers=0&srs=EPSG:3857","Soome kaart (WMTS)":"https://mapservices-a.navici.com/basemaps/gwc/service/wmts?apikey=gdqWSTM10Le9XVAX8B6vFKxnpZAmTx5x&title=Soome kaart&layer=basemaps:rk&srs=EPSG:3067&matrixSet=ETRS-TM35FIN&matrixTemplate=ETRS-TM35FIN:{z}&scaleDenominator=2.925714285714286E7&topLeftCorner=-2097152,9437184&matrixWidth=3&matrixHeight=2&format=image/png8","Soome foto (WMTS)":"https://www.retkikartta.fi/wmts/30c616a00f157e7357721900e8b0415c/?srs=EPSG:3067&title=Soome foto&format=image/jpeg&layer=ortokuva&matrixSet=ETRS-TM35FIN&scaleDenominator=29257142.85714286&matrixWidth=1&matrixHeight=1&topLeftCorner=-548576,8388608"}},q={authUrl:"http://geopeitus.ee",downloadUrl:{page:"http://www.geopeitus.ee/index.php?p=300",geojson:"http://www.geopeitus.ee/index.php?p=301&status[]=1&format=2",gpx:{gpxActive:"http://www.geopeitus.ee/index.php?p=301&status[]=1&format=1",gpxAll:"http://www.geopeitus.ee/index.php?p=301&status[]=1&status[]=2&status[]=3&format=1"}},cacheUrl:"http://geopeitus.ee/aare/",radiusStyle:{maxResolution:30,radius:160},newCacheDays:30,waypointMaxResolution:10,overviewMinResolution:100,exportFileName:"geop.gpx",mapping:{fstatusJSON:{0:"Not Found",1:"Found",2:"Owner"},fstatusGPX:{Geocache:"Not Found","Geocache Found":"Found","Geocache Owner":"Owner"},type:{"Tavaline aare":"Geocache|Traditional Cache",Multiaare:"Geocache|Multi-cache",Veebikaamera:"Geocache|Webcam Cache","Virtuaalne aare":"Geocache|Virtual Cache","Sündmusaare":"Geocache|Event Cache","Asukohata (tagurpidi) aare":"Geocache|Locationless Cache","Mõistatusaare":"Geocache|Unknown Cache",Kirjakastiaare:"Geocache|Letterbox Hybrid","KusMaLäen":"Geocache|Wherigo Cache","Maa-aare":"Geocache|Earthcache"},container:{mikro:"Micro","väike":"Small",normaalne:"Regular",suur:"Large",muu:"Unknown"}},filter:{fstatus:"fstatusGPX",type:"type",status:["Available","Unavailable","Archived"],newCache:["New Cache"]},styles:{base:{text:"",class:"fas fa-map-marker-alt",font:'900 16px "Font Awesome 5 Free"',textBaseline:"middle",fill:{color:"#aaa"},stroke:{color:"#fff",width:4}},overview:{text:"",class:"fa fa-circle",font:'900 8px "Font Awesome 5 Free"',stroke:{color:"#fff",width:2}},text:{"Geocache|Traditional Cache":{text:"",class:"fa fa-cube",font:'900 13px "Font Awesome 5 Free"'},"Geocache|Multi-cache":{text:"",class:"fa fa-cubes",font:'900 16px "Font Awesome 5 Free"'},"Geocache|Webcam Cache":{text:"",class:"fa fa-camera",font:'900 12px "Font Awesome 5 Free"'},"Geocache|Virtual Cache":{text:"",class:"fa fa-wifi",font:'900 12px "Font Awesome 5 Free"'},"Geocache|Event Cache":{text:"",class:"fa fa-calendar-check-o",font:'900 12px "Font Awesome 5 Free"'},"Geocache|Locationless Cache":{text:"",class:"fa fa-refresh",font:'900 12px "Font Awesome 5 Free"'},"Geocache|Unknown Cache":{text:"",class:"fa fa-question-circle",font:'900 13px "Font Awesome 5 Free"'},"Geocache|Letterbox Hybrid":{text:"",class:"fa fa-envelope",font:'900 12px "Font Awesome 5 Free"'},"Geocache|Wherigo Cache":{text:"",class:"fa fa-arrow-circle-right",font:'900 12px "Font Awesome 5 Free"'},"Geocache|Earthcache":{text:"",class:"fa fa-globe-africa",font:'900 13px "Font Awesome 5 Free"'},"Waypoint|Parking Area":{text:"",class:"fas fa-parking",font:'900 12px "Font Awesome 5 Free"'},"Waypoint|Reference Point":{text:"",class:"far fa-arrow-alt-circle-down",font:'900 12px "Font Awesome 5 Free"'},"Waypoint|Stages of a Multicache":{text:"",class:"fas fa-plus-circle",font:'900 12px "Font Awesome 5 Free"'},"Waypoint|Physical Stage":{text:"",class:"fas fa-plus-circle",font:'900 12px "Font Awesome 5 Free"'},"Waypoint|Virtual Stage":{text:"",class:"fas fa-plus-circle",font:'900 12px "Font Awesome 5 Free"'},"Waypoint|Final Location":{text:"",class:"far fa-times-circle",font:'900 12px "Font Awesome 5 Free"'},"Waypoint|Trailhead":{text:"",class:"far fa-hiking",font:'900 12px "Font Awesome 5 Free"'}},color:{"Not Found":{fill:{color:"#444"}},Found:{fill:{color:"#4c9900"}},Owner:{fill:{color:"#f00"}}},newCache:{"New Cache":{stroke:{color:"#ffff00",width:4}}},radiusStyle:{fill:{color:"rgba(255, 0, 0, 0.1)"}}}},z={base:[{id:"osm",type:"XYZ",title:"OSM",url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png",projection:"EPSG:3857",crossOrigin:null},{id:"photo",type:"Bing",title:"Aerial",key:"AozX0lfGO2nv-11kPOU6_BKWeJwgfAcyFQAXAwXQmnQtSJahtmYj8ZJ3JAzk36Z4",projection:"EPSG:3857",imagerySet:"AerialWithLabels",maxZoom:19},{id:"makaart",type:"Group",title:"Map",projection:"EPSG:3301",layers:[{type:"XYZ",projection:"EPSG:3857",url:"https://tiles.maaamet.ee/tm/tms/1.0.0/kaart@GMC/{z}/{x}/{-y}.png",minResolution:.5,crossOrigin:null},{type:"TileWMS",url:"https://kaart.maaamet.ee/wms/kaart",params:{LAYERS:"MA-KAART",TILED:!0,FORMAT:"image/png",VERSION:"1.1.1"},maxResolution:.75,tileSize:1024,gutter:20,crossOrigin:null}]},{id:"mapkaart",type:"Group",title:"Topo",projection:"EPSG:3301",layers:[{type:"XYZ",projection:"EPSG:3857",url:"https://tiles.maaamet.ee/tm/tms/1.0.0/kaart@GMC/{z}/{x}/{-y}.png",minResolution:7.1,crossOrigin:null},{type:"XYZ",url:"https://tiles.maaamet.ee/tm/tms/1.0.0/reljeef@LEST/{z}/{x}/{-y}.png",minResolution:7.1,crossOrigin:null,opacity:.5},{type:"XYZ",url:"https://tiles.maaamet.ee/tm/tms/1.0.0/epk_vv@LEST/{z}/{x}/{-y}.png",minResolution:.5,maxResolution:7.1,crossOrigin:null},{type:"TileWMS",url:"https://kaart.maaamet.ee/wms/alus",params:{LAYERS:"pohi_vv",TILED:!0,FORMAT:"image/png",VERSION:"1.1.1"},maxResolution:.75,tileSize:1024,gutter:20,crossOrigin:null}]},{id:"maorto",type:"Group",title:"Aerial Estonia",projection:"EPSG:3301",layers:[{type:"XYZ",projection:"EPSG:3857",url:"https://tiles.maaamet.ee/tm/tms/1.0.0/foto@GMC/{z}/{x}/{-y}.png",minResolution:.5,crossOrigin:null},{type:"TileWMS",url:"https://kaart.maaamet.ee/wms/fotokaart",params:{LAYERS:"EESTIFOTO",TILED:!0,FORMAT:"image/png",VERSION:"1.1.1"},maxResolution:.75,tileSize:1024,gutter:20,crossOrigin:null}]},{id:"okaart",type:"XYZ",title:"O-kaart",url:"https://okaart.osport.ee/{z}/{x}/{y}.png",projection:"EPSG:3857",crossOrigin:null},{id:"tf_outdoors",type:"XYZ",title:"Outdoors",url:"https://tile.thunderforest.com/outdoors/{z}/{x}/{y}.png?apikey=bc215709c53e44c9b78c1bcbe825af07",projection:"EPSG:3857",crossOrigin:null}],layers:[],overlays:[]},V=(n(37),n(233),n(234),n(95),n(179));function B(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return H(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r,a=!0,i=!1;return{s:function(){o=t[Symbol.iterator]()},n:function(){var t=o.next();return a=t.done,t},e:function(t){i=!0,r=t},f:function(){try{a||null==o.return||o.return()}finally{if(i)throw r}}}}function H(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function J(t,e,n,o,r,a,i){try{var c=t[a](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(o,r)}var Y={},Z={},X=!!window.indexedDB;function K(){return new Promise((function(t,e){if(X)try{Object(V.c)().then(function(){var e,n=(e=regeneratorRuntime.mark((function e(n){var o,r,a,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o={},r=B(n),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=12;break}return i=a.value,e.next=8,Object(V.b)(i);case 8:null!=(c=e.sent)&&(o[i]=c);case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:t(P(o));case 21:case"end":return e.stop()}}),e,null,[[2,14,17,20]])})),function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(t){J(a,o,r,i,c,"next",t)}function c(t){J(a,o,r,i,c,"throw",t)}i(void 0)}))});return function(t){return n.apply(this,arguments)}}())}catch(t){e(t)}else e(new Error("Storage is not available"))}))}function Q(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Y[t]=e,n&&X?Object(V.d)(t,e).then((function(){t in Z&&Z[t].forEach((function(e){return e(Y[t])}))})):t in Z&&Z[t].forEach((function(e){return e(Y[t])}))}function $(t){return Y[t]}function tt(t,e){t in Z||(Z[t]=[]),-1===Z[t].indexOf(e)&&Z[t].push(e)}function et(){Object(V.a)()}n(29),n(170),n(28),n(6),n(7),n(55),n(62);function nt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var ot=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.target=e,this.el=null,this.state={},this.create(),this.components={}}var e,n,o;return e=t,(n=[{key:"create",value:function(){this.target&&this.el&&(this.target.append(this.el),this.render())}},{key:"render",value:function(){}},{key:"renderComponents",value:function(){}},{key:"getComponent",value:function(t){return this.components[t]}},{key:"getEl",value:function(){return this.el}},{key:"set",value:function(t,e){this.state[t]=e}},{key:"get",value:function(t){return this.state[t]}},{key:"destroy",value:function(){var t=this;Object.keys(this.components).forEach((function(e){return t.components[e].destroy()})),this.components={},this.el.remove()}}])&&nt(e.prototype,n),o&&nt(e,o),t}(),rt={locale:null,texts:{}};function at(t,e){t&&t in e&&(rt.texts=e,rt.locale=t),Q("app/locale",rt.locale,!0)}function it(t){return t in rt.texts[rt.locale]?rt.texts[rt.locale][t]:t}var ct=n(164);function st(t,e,n){switch(t){case"success":!function(t,e){ct.a.success(t,"",void 0,e)}(e);break;case"info":!function(t,e){ct.a.info(t,"",void 0,e)}(e);break;case"warning":!function(t,e){ct.a.warn(t,"",void 0,e)}(e);break;case"error":!function(t,e){ct.a.error(t,"",void 0,e)}(e)}"function"==typeof n&&setTimeout(n,4e3)}ct.a.init({timeout:4e3});var lt=n(4),ut=n.n(lt),ft=n(174),pt=n.n(ft),dt=n(301),ht=n.n(dt);n(355);function yt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mt(t){return function(t){if(Array.isArray(t))return gt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return gt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function bt(t){return(bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function wt(t,e,n){return(wt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=St(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function kt(t,e){return!e||"object"!==bt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function At(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function St(t){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ot(t,e){return(Ot=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ot(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=St(e);if(At()){var o=St(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return kt(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('\n      <div class="btn-group float-right" id="bookmark"></div>\n    '),e.modal=ut()("#modal_bookmark"),e.state={bookmarks:$("app/bookmarks")||[],bookmark:F("b")},e.create(),e.el.on("click","button.share",(function(t){t.preventDefault(),e.share()})),e.el.on("click","li",(function(t){t.preventDefault(),e.openModal(ut()(t.currentTarget).data("id"))})),e.el.on("click","li .tools a.remove",(function(t){t.preventDefault(),t.stopPropagation(),e.delete(ut()(t.currentTarget).closest("li").data("id"))})),e.modal.on("click","button.copy",(function(t){e.copy(ut()(t.target).closest(".modal").find("input").val())})),D((function(t){e.state.bookmark!==t.b&&Qc()})),e}return n=i,(o=[{key:"render",value:function(){this.modal&&0!==this.modal.length||(this.modal=ut()('\n        <div class="modal fade"\n          id="modal_bookmark">\n          <div class="modal-dialog">\n            <div class="modal-content">\n              <div class="modal-header">\n                <h4 class="modal-title">'.concat(it("Share bookmark"),'</h4>\n                <button type="button"\n                  class="close"\n                  data-dismiss="modal"\n                  aria-label="Close">\n                  <span aria-hidden="true">&times;</span>\n                </button>\n              </div>\n              <div class="modal-body text-muted">\n                <div class="input-group mb-5">\n                  <input type="text" class="form-control" name="bookmark" readonly>\n                  <div class="input-group-append">\n                    <button class="btn btn-secondary copy" type="button">\n                      <i class="far fa-clone"></i>\n                    </button>\n                    <a class="btn btn-secondary go" href="#" target="_blank">\n                      <i class="fas fa-link"></i>\n                    </a>\n                  </div>\n                </div>\n                <div class="mb-5 text-center display-4">\n                  ').concat(it("or"),'\n                </div>\n                <div class="mb-5 text-center">\n                  <canvas class="rounded mx-auto d-block img-thumbnail"></canvas>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      ')),ut()("body").append(this.modal)),this.el.html('\n      <div class="btn-group dropup">\n        <button type="button" class="btn btn-secondary share" title="'.concat(it("Share"),'">\n          <i class="fas fa-share-alt"></i>\n        </button>\n        <button ').concat(this.state.bookmarks.length?"":"disabled",'\n          type="button"\n          class="btn btn-secondary dropdown-toggle dropdown-toggle-split"\n          data-toggle="dropdown">\n        </button>\n        <div class="dropdown-menu dropdown-menu-right">\n          ').concat(this.state.bookmarks.map((function(t){return'\n            <li\n              class="dropdown-item"\n              data-id="'.concat(t,'">\n              <i class="fas fa-star"></i>\n              ').concat(t,'\n              <div class="tools">\n                <a href="#" class="remove">\n                  <i class="fa fa-times"></i>\n                </a>\n              </div>\n            </li>')})).join(""),"\n        </div>\n      </div>\n    "))}},{key:"share",value:function(){var t=this,e=$("app/debug");new Promise((function(t,e){K().then(t).catch(e)})).then((function(n){var o;(o=n,new Promise((function(t,e){xt&&"function"==typeof xt.abort&&xt.abort();var n=S();xt=ut.a.ajax({type:"POST",crossDomain:!0,url:W.jsonstore+"/"+n,data:JSON.stringify({state:JSON.stringify(pt.a.pack(Rt("up",o)))}),dataType:"json",contentType:"application/json; charset=utf-8"}).done((function(o){o&&o.ok?t(n):e(new Error("Unable to save bookmark"))})).fail((function(n){"abort"===n.statusText?t(null):e(new Error("Unable to save bookmark"))}))}))).then((function(n){t.state.bookmarks.push(n),Q("app/bookmarks",t.state.bookmarks,!0),t.render(),t.openModal(n),e&&console.debug("Bookmark saved: "+n)})).catch((function(t){st("error",it(t.message)),e&&console.error("Bookmark error [setBookmarkState]: "+JSON.stringify(t))}))})).catch((function(t){st("error",it(t.message)),e&&console.error("Bookmark error [getSessionState]: "+JSON.stringify(t))}))}},{key:"copy",value:function(t){h(t).then((function(){st("success","".concat(it("URL")," ").concat(t," ").concat(it("copied to clipboard")))})).catch((function(){st("error",it("Unable to copy to clipboard"))}))}},{key:"delete",value:function(t){var e,n=this,o=$("app/debug");(e=t,new Promise((function(t,n){xt&&"function"==typeof xt.abort&&xt.abort(),xt=ut.a.ajax({type:"DELETE",crossDomain:!0,url:W.jsonstore+"/"+e,dataType:"json",contentType:"application/json; charset=utf-8"}).done((function(e){e&&e.ok?t():n(new Error("Unable to delete bookmark"))})).fail((function(e){"abort"===e.statusText?t(null):n(new Error("Unable to delete bookmark"))}))}))).then((function(){n.state.bookmarks=n.state.bookmarks.filter((function(e){return e!==t})),Q("app/bookmarks",n.state.bookmarks,!0),n.render(),st("success","".concat(it("Bookmark deleted!"))),o&&console.debug("Bookmark deleted: "+t)})).catch((function(t){st("error",it(t.message)),o&&console.error("Bookmark error [deleteBookmarkState]: "+JSON.stringify(t))}))}},{key:"bookmarkUrl",value:function(t){return window.location.origin+window.location.pathname+"#b="+t}},{key:"openModal",value:function(t){this.modal.find("input").val(this.bookmarkUrl(t)),this.modal.find("a.go").attr("href",this.bookmarkUrl(t)),new ht.a({element:this.modal.find("canvas")[0],size:200}).value=this.bookmarkUrl(t),this.modal.modal()}},{key:"destroy",value:function(){this.modal.modal("dispose"),this.modal.remove(),this.modal=null,wt(St(i.prototype),"destroy",this).call(this)}}])&&vt(n.prototype,o),r&&vt(n,r),i}(ot),xt=null;function Rt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"down",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o={};switch(t){case"up":"app_bookmarks"in(o=P(Object.assign.apply(Object,[{}].concat(mt(Object.keys(e).map((function(t){return yt({},t.replace(/\//g,"_"),e[t])})))))))&&delete o.app_bookmarks,"app_bookmark_loaded"in o&&delete o.app_bookmark_loaded,$("app/shareOnlyTripFeatures")&&"geocache_trip_ids"in o&&(o.layer_layers&&o.layer_layers.forEach((function(t){t.features=t.features?t.features.filter((function(t){return o.geocache_trip_ids.indexOf(t.id)>-1})):[]})),o.layer_overlays&&o.layer_overlays.forEach((function(t){t.features=t.features?t.features.filter((function(t){return o.geocache_trip_ids.indexOf(t.id)>-1})):[]})));break;case"down":o=P(Object.assign.apply(Object,[{}].concat(mt(Object.keys(e).map((function(t){return yt({},t.replace(/_/g,"/"),e[t])})))))),n&&(o["app/bookmark/loaded"]=n);break;default:o=e}return o}function Et(t){return new Promise((function(e,n){xt&&"function"==typeof xt.abort&&xt.abort(),xt=ut.a.ajax({type:"GET",crossDomain:!0,url:W.jsonstore+"/"+t,dataType:"json",contentType:"application/json; charset=utf-8"}).done((function(o){if(o&&o.ok&&o.result&&o.result.state){var r=Rt("down",pt.a.unpack(o.result.state),t);e(r)}else n(new Error("Unable to load bookmark"))})).fail((function(t){"abort"===t.statusText?e(null):n(new Error("Unable to load bookmark"))}))}))}var Pt=jt;function Ct(t,e,n,o,r,a,i){try{var c=t[a](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(o,r)}function _t(){return new Promise(function(){var t,e=(t=regeneratorRuntime.mark((function t(e,n){var o,r,a,i,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={},r=F("b"),t.prev=2,t.next=5,K();case 5:if(a=t.sent,!r||!r.length){t.next=12;break}return t.next=9,Et(r);case 9:t.t0=t.sent,t.next=13;break;case 12:t.t0={};case 13:i=t.t0,t.next=20;break;case 16:t.prev=16,t.t1=t.catch(2),a={},i={};case 20:Object.keys(U).forEach((function(t){o["app/"+t]=U[t]})),Object.keys(I).forEach((function(t){o["map/"+t]=I[t]})),Object.keys(z).forEach((function(t){o["layer/"+t]=z[t]})),c=Object.assign({},o,a,i),"onhashchange"in window||(c["app/shareState"]=!1),Object.keys(c).forEach((function(t){Q(t,c[t])})),e(c);case 27:case"end":return t.stop()}}),t,null,[[2,16]])})),function(){var e=this,n=arguments;return new Promise((function(o,r){var a=t.apply(e,n);function i(t){Ct(a,o,r,i,c,"next",t)}function c(t){Ct(a,o,r,i,c,"throw",t)}i(void 0)}))});return function(t,n){return e.apply(this,arguments)}}())}n(357),n(358),n(359),n(360),n(361),n(362),n(363),n(364),n(366);var Tt=n(302),Mt=(n(96),n(205)),Lt=n(313),Ft=n(311),Gt=n(158),Dt=n(304),Nt=n(305),Ut=n(314),It=n(315),Wt=n(177),qt=n(316),zt=n(312),Vt=n(79),Bt=n(3),Ht=n(1),Jt=n(141),Yt=n(202),Zt=(n(117),n(83)),Xt=n(87),Kt=n(161),Qt=n(178),$t=n(175),te=n(89),ee=n(197);function ne(t){var e={};return t?Object.keys(t).forEach((function(n){switch(n){case"stroke":e[n]=new Xt.a(t[n]);break;case"fill":e[n]=new Zt.a(t[n]);break;case"image":case"circle":e.image=new Kt.a({fill:t[n].fill&&new Zt.a(t[n].fill),stroke:t[n].stroke&&new Xt.a(t[n].stroke),radius:t[n].radius||5});break;case"shape":t[n].fill&&(t[n].fill=new Zt.a(t[n].fill)),t[n].stroke&&(t[n].stroke=new Xt.a(t[n].stroke)),e.image=new ee.a(t[n]);break;case"icon":e.image=new Qt.a(t[n]);break;case"text":t[n].fill&&(t[n].fill=new Zt.a(t[n].fill)),t[n].stroke&&(t[n].stroke=new Xt.a(t[n].stroke)),e[n]=new $t.a(t[n]);break;default:e[n]=t[n]}}),this):e=function(){var t={fill:new Zt.a({color:"rgba(255,255,255,0.4)"}),stroke:new Xt.a({color:"#3399CC",width:2})};return t.image=new Kt.a({fill:t.fill,stroke:t.stroke,radius:5}),t}(),new te.c(e)}function oe(t){return"function"==typeof t?function(e,n){return t(e,n,ne)}:Array.isArray(t)?t.map((function(t){return ne(t)})):ne(t)}var re=n(303),ae=n.n(re);function ie(t){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function se(t){return function(){var e,n=fe(t);if(ue()){var o=fe(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return le(this,e)}}function le(t,e){return!e||"object"!==ie(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ue(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function fe(t){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pe(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&de(t,e)}function de(t,e){return(de=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var he={XYZ:Dt.a,TileWMS:Nt.a,WMTS:qt.a,ImageWMS:Ut.a,Bing:It.a,Vector:Wt.a},ye={geojson:new Vt.a,wmts:new zt.a},me=function(t){pe(n,t);var e=se(n);function n(){return ce(this,n),e.apply(this,arguments)}return n}(Mt.a),ge=function(t){pe(n,t);var e=se(n);function n(t){ce(this,n);var o={source:new he[t.type](t)};return e.call(this,o)}return n}(Lt.a),be=function(t){pe(n,t);var e=se(n);function n(t){ce(this,n);var o={};"TileWMS"===t.type&&t.tileSize&&256!==t.tileSize&&(o.tileGrid=function(t){for(var e=Object(Bt.j)(t.projection).getExtent(),n=Object(Ht.E)(e)/t.tileSize,o=ae()(I.minZoom,I.maxZoom+1),r=0,a=o.length;r<a;++r)o[r]=n/Math.pow(2,r);return new Jt.a({extent:e,resolutions:o,tileSize:[t.tileSize,t.tileSize]})}(t)),"WMTS"===t.type&&(o.tileGrid=function(t){for(var e=t.tileSize||256,n=function(t,e,n,o,r,a){var i=n*o,c=r*a,s=t*i*28e-5+e[0],l=e[1]-t*c*28e-5,u=Math.round((s-e[0])/i),f=Math.round((e[1]-l)/c);if(u!==f)throw new Error("Could not calculate resolution!");return{extent:[e[0],l,s,e[1]],maxResolution:u}}(t.scaleDenominator,t.topLeftCorner,e,t.matrixWidth,e,t.matrixHeight),o=n.extent,r=n.maxResolution,a=Array(16),i=[],c=0,s=a.length;c<s;++c)a[c]=r/Math.pow(2,c),i[c]=t.matrixTemplate?t.matrixTemplate.replace(/{z}/,c):c;return new Yt.b({extent:n.extent,origin:Object(Ht.C)(o),resolutions:a,matrixIds:i})}(t));var r={source:he[t.type]?new he[t.type](Object.assign({},t,o)):null};return e.call(this,r)}return n}(Ft.a),ve=function(t){pe(n,t);var e=se(n);function n(t){ce(this,n);var o=t.features?ye.geojson.readFeatures(t,{dataProjection:"EPSG:4326",featureProjection:$("map/projection")}):[],r={source:new Wt.a({features:o}),style:oe(t.style),updateWhileAnimating:t.updateWhileAnimating,updateWhileInteracting:t.updateWhileInteracting};return e.call(this,r)}return n}(Gt.a);function we(t){var e;switch(t.type){case"Group":var n=t.layers.map((function(e){var n=P(e);return n.projection||(n.projection=t.projection),n.zIndex||(n.zIndex=t.zIndex),we(n)}));void 0===t.visible&&(t.visible=!0),e=new me({layers:n});break;case"XYZ":case"TileWMS":case"Bing":case"WMTS":e=new be(P(t));break;case"ImageWMS":e=new ge(P(t));break;case"FeatureCollection":e=new ve(t)}return function(t,e){"boolean"==typeof e.visible&&t.setVisible(e.visible);void 0===e.id&&(e.id=S());t.set("id",e.id),e.title&&t.set("title",e.title);e.layerType&&t.set("type",e.type);e.icon&&t.set("icon",e.icon);e.minResolution&&t.setMinResolution(e.minResolution);e.maxResolution&&t.setMaxResolution(e.maxResolution);void 0!==e.opacity&&t.setOpacity(e.opacity);void 0!==e.zIndex?t.setZIndex(e.zIndex):t.setZIndex(100);t.set("conf",e)}(e,t),e}var ke=n(309),Ae=n(211),Se=n(306),Oe=n(165);n(385),n(386);function je(t){return(je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xe(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Re(t,e,n){return(Re="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ce(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Ee(t,e){return!e||"object"!==je(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Ce(t){return(Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _e(t,e){return(_e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Te(t,e,n){var o={feature:null,layer:null,distance:1/0};return t.forEachFeatureAtPixel(e,(function(t,e){var r=Object(c.b)(Object(Bt.p)(n),Object(Bt.p)(t.getGeometry().getCoordinates()));!isNaN(r)&&e&&r<o.distance&&(o.feature=t,o.layer=e,o.distance=r)}),{hitTolerance:10}),o.feature||t.forEachFeatureAtPixel(e,(function(t,e){var r=Object(c.b)(Object(Bt.p)(n),Object(Bt.p)(t.getGeometry().getCoordinates()));isNaN(r)&&(o.feature=t,o.layer=e,o.distance=0)}),{hitTolerance:5}),o.feature?[o.layer,o.feature]:null}Oe.a.defs("EPSG:3301","+proj=lcc +lat_1=59.33333333333334 +lat_2=58 +lat_0=57.51755393055556 +lon_0=24 +x_0=500000 +y_0=6375000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),Oe.a.defs("EPSG:32634","+proj=utm +zone=34 +datum=WGS84 +units=m +no_defs"),Oe.a.defs("EPSG:32635","+proj=utm +zone=35 +datum=WGS84 +units=m +no_defs"),Oe.a.defs("EPSG:3067","+proj=utm +zone=35 +ellps=GRS80 +units=m +no_defs"),Object(Se.a)(Oe.a),Object(Bt.j)("EPSG:3301").setExtent([40500,5993e3,1064500,7017e3]),Object(Bt.j)("EPSG:3067").setExtent([-2097152,1601644.86,848181.26,9437184]);var Me=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_e(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Ce(e);if(Pe()){var o=Ce(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Ee(this,t)});function i(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('<div id="'.concat($("map/el").slice(1),'"></div>')),e.create(),e.map=null,e.layers={base:we({type:"Group",layers:[]}),layers:we({type:"Group",layers:[]}),overlays:we({type:"Group",layers:[]})},e.format={geojson:new Vt.a},e.activeBaseLayer=null,e.geoLocation=null,e.controls={mouseCoordinates:null},e.shouldUpdate=!0;var n=e.permalinkToViewConf(F("view"));return e.createBaseLayers($("layer/base"),n?n.baselayer:null),e.createLayers($("layer/layers")),e.createOverlays($("layer/overlays")),Q("map/layer/base",e.layers.base.getLayers()),Q("map/layer/layers",e.layers.layers.getLayers()),Q("map/layer/overlays",e.layers.overlays.getLayers()),Q("map/baseLayer",e.activeBaseLayer&&e.activeBaseLayer.get("id"),!0),Q("map/que",[]),e.layers.base.getLayers().on("add",(function(){e.storeLayers("base")})),e.layers.base.getLayers().on("remove",(function(){e.storeLayers("base")})),e.layers.layers.getLayers().on("add",(function(){e.storeLayers("layers")})),e.layers.layers.getLayers().on("remove",(function(){e.storeLayers("layers")})),e.layers.overlays.getLayers().on("add",(function(){e.storeLayers("overlays")})),e.layers.overlays.getLayers().on("remove",(function(){e.storeLayers("overlays")})),tt("layerchange",(function(t){"string"==typeof t&&(t=["overlays",t]),e.updateStore(t[0],t[1])})),D((function(t){if(t.view){var n=e.permalinkToViewConf(t.view);n&&e.map.getView().animate({center:Object(Bt.g)(n.center,$("map/projection")),zoom:n.zoom,rotation:b(n.rotation),duration:500})}})),e}return n=i,(o=[{key:"init",value:function(){var t=this,e=this.permalinkToViewConf(F("view"));this.map=this.createMap(e),Q("map",this.map),this.map.on("moveend",(function(t){var e=t.map.getView();Q("map/resolution",e.getResolution()),Q("map/center",Object(Bt.p)(e.getCenter()),!0),Q("map/zoom",e.getZoom(),!0),Q("map/rotation",g(e.getRotation()),!0),G({view:N({center:Object(Bt.p)(e.getCenter()),zoom:e.getZoom(),rotation:g(e.getRotation()),baseLayer:$("map/baseLayer")})})})),$("map/que").forEach((function(e){"function"==typeof e&&e(t.map)}))}},{key:"permalinkToViewConf",value:function(t){var e=t?t.split("/"):[];return{center:isNaN(e[1])||isNaN(e[0])?$("map/center"):[Number(e[1]),Number(e[0])],zoom:isNaN(e[2])?$("map/zoom"):Number(e[2]),rotation:isNaN(e[3])?$("map/rotation"):Number(e[3]),baselayer:e[4]||$("map/baseLayer")}}},{key:"createMap",value:function(t){var e=this;return new ke.a({layers:Object.keys(this.layers).map((function(t){return e.layers[t]})),controls:[],target:document.querySelector($("map/el")),moveTolerance:2,pixelRatio:2,view:new Ae.a({projection:$("map/projection"),center:Object(Bt.g)(t.center,$("map/projection")),zoom:t.zoom,rotation:b(t.rotation),maxZoom:$("map/maxZoom"),minZoom:$("map/minZoom")})})}},{key:"createBaseLayers",value:function(t,e){var n=this;t.forEach((function(t){t.visible=t.id===e,t.zIndex=0;var o=we(t);n.addBaseLayer(o),t.visible&&(n.activeBaseLayer=o)}))}},{key:"createLayers",value:function(t){var e=this;t.forEach((function(t){e.addLayer(we(t))}))}},{key:"createOverlays",value:function(t){var e=this;t.forEach((function(t){e.addOverlay(we(t))}))}},{key:"addBaseLayer",value:function(t){this.layers.base.getLayers().push(t)}},{key:"addLayer",value:function(t){this.layers.layers.getLayers().push(t)}},{key:"addOverlay",value:function(t){this.layers.overlays.getLayers().push(t)}},{key:"getLayer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t in this.layers){if(e){var n=this.layers[t].getLayers().getArray().filter((function(t){return t.get("id")===e}));return n[0]||!1}return this.layers[t]}return!1}},{key:"storeLayers",value:function(t){Q("layer/"+t,this.layers[t].getLayers().getArray().map((function(t){return t.get("conf")})),!0)}},{key:"updateStore",value:function(t,e){var n=this.getLayer(t,e);if(n){var o=n.get("conf");if("FeatureCollection"===o.type){var r=this.format.geojson.writeFeaturesObject(n.getSource().getFeatures(),{featureProjection:$("map/projection"),dataProjection:"EPSG:4326"});o.features=r.features}o.visible=n.getVisible(),n.set("conf",o),this.storeLayers(t)}}},{key:"destroy",value:function(){this.map.setTarget(null),this.map=null,Re(Ce(i.prototype),"destroy",this).call(this)}}])&&xe(n.prototype,o),r&&xe(n,r),i}(ot);n(172),n(387);function Le(t){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fe(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ge(t,e){return!e||"object"!==Le(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function De(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Ne(t){return(Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ue(t,e){return(Ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ie=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ue(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Ne(e);if(De()){var o=Ne(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Ge(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),t.target||(t.target=ut()("body")),(e=a.call(this,t.target)).id="sidebar-"+S(),e.el=ut()('<nav id="'.concat(e.id,'" class="sidebar bg-light p-3"></nav>')),e.shadow=ut()('<div id="'.concat(e.id,'-shadow" class="sidebar-shadow"></div>')),e.state={trigger:t.trigger,position:t.position,shadow:t.shadow,active:t.activeComponent},e.trigger=t.trigger,e.create(),e.components=e.renderComponents(e.el.find(" > ul"),e.el.find("> div"),t.components,t.props),e}return n=i,(o=[{key:"create",value:function(){this.target&&this.el&&(this.target.append(this.el),this.target.append(this.el),this.state.shadow&&this.target.append(this.shadow),this.render())}},{key:"render",value:function(){var t=this;this.el.html('\n      <button type="button" class="close" aria-label="'.concat(it("Close"),'">\n        <i class="fa fa-times"></i>\n      </button>\n      <ul class="nav nav-pills mb-3" role="tablist"></ul>\n      <div class="tab-content"></div>\n    ')),this.trigger.on("click",(function(e){t.openSidebar()})),this.el.on("click","> button",(function(e){t.closeSidebar()})),this.shadow.on("click",(function(e){t.closeSidebar()}))}},{key:"openSidebar",value:function(){this.el.addClass("active"),this.shadow.addClass("active")}},{key:"closeSidebar",value:function(){this.el.removeClass("active"),this.shadow.removeClass("active")}},{key:"renderComponents",value:function(t,e,n,o){var r=this,a={};return Object.keys(n).forEach((function(i){var c=new n[i](e,o),s=ut()('\n        <li class="nav-item">\n          <a class="nav-link '.concat(r.state.active===c.id?"active":"",'"\n            data-toggle="pill"\n            href="#').concat(c.id,'"\n            role="tab"\n            aria-controls="').concat(c.id,'">\n            ').concat(c.icon?'<i class="'.concat(c.icon,'"></i>'):"",'\n            <span class="').concat(c.btnTextVisible?"":"d-none d-sm-inline-block",'">').concat(it(i),"</span>\n          </a>\n        </li>\n      "));c.set("tab",s),t.append(s),a[i]=c})),a}}])&&Fe(n.prototype,o),r&&Fe(n,r),i}(ot);n(116);function We(t){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qe(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ze(t,e){return!e||"object"!==We(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ve(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Be(t){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function He(t,e){return(He=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Je=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&He(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Be(e);if(Ve()){var o=Be(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return ze(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).id="tab-loader",e.icon="fa fa-cloud-download-alt",e.el=ut()('\n      <div\n        class="tab-pane fade show active"\n        id="'.concat(e.id,'"\n        role="tabpanel">\n      </div>\n    ')),e.create(),e}return n=i,(o=[{key:"render",value:function(){var t=this;this.el.html('\n      <ul class="list-group mb-3">\n        <li class="list-group-item">\n          <span class="badge badge-pill badge-secondary">1</span>\n          '.concat(it("Go to"),'\n          <a href="').concat(q.authUrl,'" target="geopeitus">geopeitus.ee</a>\n          ').concat(it("and log in"),',\n        </li>\n        <li class="list-group-item">\n          <span class="badge badge-pill badge-secondary">2</span>\n          ').concat(it("download GPX from"),'\n          <a href="').concat(q.downloadUrl.page,'" target="geopeitus">').concat(it("here"),"</a>\n          ").concat(it("and drop it on map or import file from layers menu"),'\n          <div class="alert alert-light" role="alert">\n            ').concat(it("Quick links"),"<br/>\n            ").concat(Object.keys(q.downloadUrl.gpx).map((function(t){return'<a href="'.concat(q.downloadUrl.gpx[t],'">').concat(it(t),"</a>")})).join("<br/>"),'\n          </div>\n        </li>\n        <li class="list-group-item">\n          <span class="badge badge-pill badge-secondary">3</span>\n          ').concat(it("or open"),'\n          <a href="').concat(q.downloadUrl.geojson,'" target="geopeitus">link</a>\n          ').concat(it("and copy page content to textbox below"),'\n        </li>\n      </ul>\n      <div class="mb-3">\n        <textarea class="form-control" rows="6"></textarea>\n      </div>\n      <button disabled\n        type="button"\n        class="btn btn-secondary confirm">\n        ').concat(it("Add geocaches to map"),"\n      </button>\n    ")),this.el.find("textarea").on("input",(function(e){var n=t.el.find("textarea").val().trim();t.el.find("button.confirm").prop("disabled",0===n.length)})),this.el.find("textarea").on("keyup",(function(e){if(13===e.keyCode){var n=t.el.find("textarea");t.addCaches(n.val().trim()),n.val("").trigger("input")}})),this.el.on("click","button.confirm",(function(e){var n=t.el.find("textarea");t.addCaches(n.val().trim()),n.val("").trigger("input")}))}},{key:"addCaches",value:function(t){var e=null;t=this.fixme(t);var n=$("app/debug");try{if("FeatureCollection"!==(e=JSON.parse(t)).type||!e.features)throw new Error("Not valid GeoJSON")}catch(t){st("error",it(t.message)),n&&console.debug("GeocacheLoader.addCaches: error "+JSON.stringify(t))}if(e){var o=this.createLayer(e);$("map/layer/layers").push(o),st("success","".concat(it("Added")," ").concat(e.features.length," ").concat(it("features"))),n&&console.debug("GeocacheLoader.addCaches: added "+e.features.length)}}},{key:"fixme",value:function(t){return t.replace('"NAVY"',"NAVY")}},{key:"createLayer",value:function(t){return t.features&&t.features.forEach((function(t){t.id=S()})),we({type:"FeatureCollection",id:S(),title:"Geocaches",features:t.features,style:{stroke:{color:"#000000",width:2},fill:{color:O("#000000",.5)},circle:{stroke:{color:"#000000"},fill:{color:O("#000000",.3)},radius:5}}})}}])&&qe(n.prototype,o),r&&qe(n,r),i}(ot);n(288),n(388);function Ye(t){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ze(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Xe(t,e){return!e||"object"!==Ye(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ke(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Qe(t){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $e(t,e){return($e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$e(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Qe(e);if(Ke()){var o=Qe(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Xe(this,t)});function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=a.call(this,t)).id="tab-filter",n.icon="fa fa-filter",n.btnTextVisible=!0,n.el=ut()('\n      <div\n        class="tab-pane fade"\n        id="'.concat(n.id,'"\n        role="tabpanel">\n      </div>\n    ')),n.state={tab:null,conf:n.createConf(),layers:e.collection,filter:{}},n.create(),n.state.layers.on("add",(function(t){return n.render()})),n.state.layers.on("remove",(function(t){return n.render()})),n}return n=i,(o=[{key:"render",value:function(){var t=this;this.state.filter=this.buildPropertyList(this.state.layers);var e=$("geocache/filter");this.el.html('\n      <ul class="list-group mb-3">\n      '.concat(Object.keys(this.state.filter).length?this.renderFilter(this.state.filter,e?e.query:{}):'<li class="list-group-item">\n          <i class="fas fa-plus"></i>\n          '.concat(it("Add caches to map"),"\n        </li>"),"\n      </ul>\n    ")),this.el.find("input[data-filter]").on("change",(function(e){e.stopPropagation(),t.filter()})),this.el.find("input[name=radiusStyle]").on("change",(function(e){e.stopPropagation();var n=ut()(e.target).is(":checked");t.state.layers.forEach((function(t){t.getSource().forEachFeature((function(t){t.set("radiusVisible",n)}))})),t.filter()})),Object.keys(this.state.filter).length&&e&&e.count&&this.filter()}},{key:"renderFilter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return'\n      <li class="list-group-item">\n        <label>\n          <input type="checkbox" name="radiusStyle" value="0"> '.concat(it("Show 160m radius"),"\n        </label>\n      </li>\n      ").concat(Object.keys(t).map((function(n){return'<li class="list-group-item">'+Object.keys(t[n]).map((function(o){var r=e[n]&&e[n].indexOf(o)>-1?'checked="true"':"";return'<label>\n            <input type="checkbox" name="'.concat(n,'" data-filter="').concat(n,'" value="').concat(o,'" ').concat(r,">\n            ").concat(it(t[n][o]),"\n          </label>")})).join("")+"</li>"})).join(""))}},{key:"createConf",value:function(){var t={};return Object.keys(q.filter).forEach((function(e){"string"==typeof q.filter[e]?t[e]=Object.values(q.mapping[q.filter[e]]):t[e]=q.filter[e]})),t}},{key:"buildPropertyList",value:function(t){var e=this,n={};return t.getArray().forEach((function(t){t.getSource().forEachFeature((function(t){var o=t.getProperties();Object.keys(o).forEach((function(t){t in e.state.conf&&(n[t]||(n[t]={}),e.state.conf[t].indexOf(o[t])>-1&&!n[t][o[t]]&&(n[t][o[t]]=o[t]))}))}))})),Object.keys(n).forEach((function(t){0===Object.keys(n[t]).length&&delete n[t]})),n}},{key:"filter",value:function(){var t=this.getChecked();this.state.layers.forEach((function(e){e.getSource().forEachFeature((function(e){if(e.get("isCache")&&t.count){var n=e.getProperties(),o=Object.keys(t.query).filter((function(e){return e in n&&t.query[e].indexOf(n[e])>-1}));e.set("hidden",o.length!==Object.keys(t.query).length)}else e.set("hidden",!1)}))})),Q("geocache/filter",t,!0)}},{key:"getChecked",value:function(){for(var t=this.el.find("input[data-filter]").serializeArray(),e={query:{},count:0},n=0,o=t.length;n<o;n++)e.query[t[n].name]||(e.query[t[n].name]=[]),-1===e.query[t[n].name].indexOf(t[n].value)&&(e.query[t[n].name].push(t[n].value),e.count++);return e}}])&&Ze(n.prototype,o),r&&Ze(n,r),i}(ot);n(105);function en(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var nn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,(n=[{key:"clear",value:function(){this.xhr&&"function"==typeof this.xhr.abort&&this.xhr.abort()}},{key:"test",value:function(t){return!(t.length<2)}},{key:"formatInput",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.filter((function(t){return!!t})).map((function(t){var n=t.slice(0,2);return e?n.join():n}))}},{key:"toGeoJSON",value:function(t){return t.id=t.id||S(),{type:"Feature",id:t.id,geometry:{type:"Point",coordinates:Object(Bt.p)(t.coords,t.srid)},bbox:t.bbox||null,properties:t}}}])&&en(e.prototype,n),o&&en(e,o),t}(),on=n(212);function rn(t){return(rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function an(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function cn(t,e){return!e||"object"!==rn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function ln(t){return(ln=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function un(t,e){return(un=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&un(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=ln(e);if(sn()){var o=ln(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return cn(this,t)});function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this)).title="OSRM",t.xhr=null,t.profiles={driving:"driving"},t}return n=i,(o=[{key:"test",value:function(t){return(void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile)in this.profiles&&!(t.length<2)}},{key:"directions",value:function(t){var e=this;return new Promise((function(n,o){e.clear(),e.xhr=ut.a.ajax({type:"GET",crossDomain:!0,url:W.osrm.directions+e.profiles.driving+"/"+t.join(";"),data:{overview:"full"},dataType:"json"}).done((function(t){"Ok"===t.code?n(e.format(t.routes[0].geometry)):o(new Error(it("Unable to find route")+": "+t.code))})).fail((function(t){"abort"!==t.statusText&&o(new Error(it("Unable to find route")+": "+it(t.responseJSON?t.responseJSON.message:t.statusText)))}))}))}},{key:"format",value:function(t){return new on.a({factor:1e5}).readFeature(t,{dataProjection:"EPSG:4326",featureProjection:$("map/projection")})}}])&&an(n.prototype,o),r&&an(n,r),i}(nn);function pn(t){return(pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function hn(t,e){return!e||"object"!==pn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function mn(t){return(mn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gn(t,e){return(gn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gn(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=mn(e);if(yn()){var o=mn(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return hn(this,t)});function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this)).title="OpenRouteService",t.xhr=null,t.profiles={driving:"driving-car",hiking:"foot-hiking"},t}return n=i,(o=[{key:"test",value:function(t){return(void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile)in this.profiles&&!(t.length<2)}},{key:"formatInput",value:function(t){return t.filter((function(t){return!!t})).map((function(t){return t.slice(0,2)}))}},{key:"directions",value:function(t){var e=this,n=void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile;return new Promise((function(o,r){if(e.clear(),n in e.profiles){var a=t.map((function(t){return 5e3}));e.xhr=ut.a.ajax({type:"POST",crossDomain:!0,url:W.openrouteservice.directions+e.profiles[n],headers:{Authorization:W.openrouteservice.key},data:JSON.stringify({coordinates:t,radiuses:a}),contentType:"application/json",dataType:"json"}).done((function(t){if(t&&t.routes&&t.routes.length){var n=e.format(t.routes[0].geometry);n.set("distance",t.routes[0].summary.distance),n.set("duration",t.routes[0].summary.duration),o(n)}else r(new Error(it("Unable to find route")+": "+JSON.stringify(t)))})).fail((function(t){"abort"!==t.statusText&&r(new Error(it("Unable to find route")+": "+it(t.responseJSON?t.responseJSON.message:t.statusText)))}))}else r(new Error(it("Routing disabled")))}))}},{key:"optimize",value:function(t,e,n){var o=this,r=void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile;return new Promise((function(a,i){o.clear();var c=[{id:1,profile:o.profiles[r],start:t,end:e}],s=n.map((function(t,e){return{id:e,location:t}}));r in o.profiles?o.xhr=ut.a.ajax({type:"POST",crossDomain:!0,url:W.openrouteservice.optimize,headers:{Authorization:W.openrouteservice.key},data:JSON.stringify({jobs:s,vehicles:c}),contentType:"application/json",dataType:"json"}).done((function(t){t&&t.routes&&t.routes.length?a(t.routes[0]):i(new Error(it("Unable to find route")+": "+JSON.stringify(t)))})).fail((function(t){"abort"!==t.statusText&&i(new Error(it("Unable to find route")+": "+it(t.responseJSON?t.responseJSON.message:t.statusText)))})):i(new Error(it("Routing disabled")))}))}},{key:"format",value:function(t){return new on.a({factor:1e5}).readFeature(t,{dataProjection:"EPSG:4326",featureProjection:$("map/projection")})}}])&&dn(n.prototype,o),r&&dn(n,r),i}(nn);n(389);function vn(t){return(vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function kn(t,e){return!e||"object"!==vn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function An(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Sn(t){return(Sn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function On(t,e){return(On=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&On(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Sn(e);if(An()){var o=Sn(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return kn(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('\n      <div class="alert small alert-warning alert-dismissible tool-results routing" role="alert">\n        <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n          <i class="fa fa-times"></i>\n        </button>\n        <div class=""></div>\n      </div>\n    '),e.create(),e}return n=i,(o=[{key:"render",value:function(){}},{key:"close",value:function(){this.el.alert("close")}},{key:"open",value:function(t,e){this.el.find("div").html(t),ut()("body").append(this.el),this.el.on("closed.bs.alert",(function(){e()}))}},{key:"update",value:function(t){this.el.find("div").html(t)}}])&&wn(n.prototype,o),r&&wn(n,r),i}(ot),xn=n(188),Rn=n(127),En=n(31),Pn=n(12),Cn=n(54),_n=n(119);n(390);function Tn(t){return(Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ln(t,e){return!e||"object"!==Tn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Gn(t){return(Gn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dn(t,e){return(Dn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nn=[{projection:"EPSG:4326",srname:"WGS (d)",coordinateFormat:function(t){return Object(En.f)(t,"{y}, {x}",5)}},{projection:"EPSG:4326",srname:"WGS (dm)",coordinateFormat:function(t){return function(t,e,n){return t?In("NS",t[1],e,n)+" "+In("EW",t[0],e,n):""}(t,3)}},{projection:"EPSG:4326",srname:"WGS (dms)",coordinateFormat:function(t){return function(t,e,n){return t?Wn("NS",t[1],e,n)+" "+Wn("EW",t[0],e,n):""}(t,1)}},{projection:"EPSG:3301",srname:"L-EST",coordinateFormat:function(t){return Object(En.f)(t,"{y}, {x}",0)}},{projection:"EPSG:4326",srname:"MGRS",coordinateFormat:function(t){return _n.a.forward(t)}}];function Un(t){var e=Object(Bt.s)(t,$("map/projection"),Nn[$("map/coordinateFormat")].projection);return Nn[$("map/coordinateFormat")].coordinateFormat(e)}function In(t,e,n,o){var r=Object(Pn.d)(e+180,360)-180,a=Math.abs(3600*r),i=n||0,c=Math.pow(10,i),s=Math.floor(a/3600),l=(a-3600*s)/60;return(l=Math.ceil(l*c)/c)>=60&&(l=0,s+=1),"end"===o?s+"° "+Object(Cn.b)(l,2,i)+"′"+(0===r?"":" "+t.charAt(r<0?1:0)):"front"===o?(0===r?"":t.charAt(r<0?1:0)+" ")+s+"° "+Object(Cn.b)(l,2,i)+"′":s+"° "+Object(Cn.b)(l,2,i)+"′"}function Wn(t,e,n,o){var r=Object(Pn.d)(e+180,360)-180,a=Math.abs(3600*r),i=n||0,c=Math.pow(10,i),s=Math.floor(a/3600),l=Math.floor((a-3600*s)/60),u=a-3600*s-60*l;return(u=Math.ceil(u*c)/c)>=60&&(u=0,l+=1),l>=60&&(l=0,s+=1),"end"===o?s+"° "+Object(Cn.b)(l,2)+"′ "+Object(Cn.b)(u,2,i)+"″"+(0===r?"":" "+t.charAt(r<0?1:0)):"front"===o?(0===r?"":t.charAt(r<0?1:0)+" ")+s+"° "+Object(Cn.b)(l,2)+"′ "+Object(Cn.b)(u,2,i)+"″":s+"° "+Object(Cn.b)(l,2)+"′ "+Object(Cn.b)(u,2,i)+"″"}function qn(t){var e=function(){var t,e={type:"FeatureCollection",id:S(),title:"Features",style:{stroke:{color:"#000000",width:2},fill:{color:O("#fff",.5)},circle:{stroke:{color:"#000000"},fill:{color:O("#fff",.9)}}}},n=$("layer/mousePositionId");if(n){var o=$("map/layer/overlays").getArray().filter((function(t){return t.get("id")===n}));o&&o[0]?t=o[0]:(t=we(e),$("map/layer/overlays").push(t),Q("layer/mousePositionId",t.get("id"),!0))}else t=we(e),$("map/layer/overlays").push(t),Q("layer/mousePositionId",t.get("id"),!0);return t}(),n=(new Vt.a).readFeature({type:"Feature",id:S(),properties:{name:Un(t)},geometry:{type:"Point",coordinates:t}});return e.getSource().addFeature(n),Q("layerchange",["overlays",e.get("id")]),n}var zn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dn(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Gn(e);if(Fn()){var o=Gn(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Ln(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('\n      <span id="mouse-position" class="mouse-position float-left d-none d-sm-block"></span>\n    '),e.animationEl=ut()('\n      <svg width="20" height="20"></svg>'),e.state={format:0,control:null,lock:!1,lastCoord:null,overlay:new Rn.a({element:e.animationEl[0],positioning:"center-center"})},Q("map/coordinateFormat",e.state.format,!0),e.handlers={onclick:function(t){e.clicked(t)},animate:function(t){e.animate(t)}},e.create(),$("map/contextmenu").push({content:function(t){return'<i class="fa fa-map-marker-alt size-1_1"></i>\n          '.concat(Un(t),'\n          <a href="#" class="btn btn-link context-item-btn"><i class="far fa-clone"></i></a>')},onClick:function(t,e,n){!n&&qn(e)},onBtnClick:function(t,n){t.preventDefault(),e.copy(Un(n))},closeOnClick:!0}),e}return n=i,(o=[{key:"render",value:function(){var t=this;if(this.el.html('\n      <div class="btn-group dropup float-left">\n        <button type="button" class="btn btn-secondary lock">\n          <i class="fa fa-'.concat(this.state.lock?"lock":"lock-open",'"></i>\n        </button>\n        <button type="button"\n          class="btn btn-secondary dropdown-toggle dropdown-toggle-split"\n          data-toggle="dropdown">\n        </button>\n        <div class="dropdown-menu">\n          ').concat(Nn.map((function(e,n){return'\n              <a class="dropdown-item" href="#" data-format="'.concat(n,'">\n                <i class="far ').concat(n===t.state.format?"fa-dot-circle":"fa-circle",'"></i>\n                ').concat(e.srname,"\n              </a>")})).join(""),'\n        </div>\n      </div>\n      <button type="button" class="btn btn-link copy float-left">\n        <i class="far fa-clone"></i>\n        <span>').concat(Nn[this.state.format].srname,"</span>\n      </button>\n    ")),this.el.on("click",".lock",(function(e){t.state.lock=!t.state.lock,t.activate($("map")),ut()(e.currentTarget).find("i").toggleClass("fa-lock fa-lock-open")})),this.el.on("click",".copy",(function(e){var n=t.el.find(".coords").html();t.copy(n)})),this.el.on("click","a[data-format]",(function(e){t.state.format=ut()(e.currentTarget).data("format"),Q("map/coordinateFormat",t.state.format,!0),t.state.control.setProjection(Nn[t.state.format].projection),t.state.control.setCoordinateFormat(Nn[t.state.format].coordinateFormat),t.el.find("a[data-format] i").removeClass("fa-dot-circle").addClass("fa-circle"),ut()(e.currentTarget).find("i").removeClass("fa-circle").addClass("fa-dot-circle"),t.el.find("button.copy span").html(Nn[t.state.format].srname)})),!this.state.control){this.state.control=new xn.a({coordinateFormat:Nn[this.state.format].coordinateFormat,projection:Nn[this.state.format].projection,className:"float-left coords",target:this.el[0],undefinedHTML:""});var e=$("map");e?this.activate(e):$("map/que").push((function(e){t.activate(e)}))}}},{key:"activate",value:function(t){t.addOverlay(this.state.overlay),t.on("singleclick",this.handlers.animate),this.state.lock?(t.removeControl(this.state.control),this.el.append('<div class="float-left coords"></div>'),t.on("click",this.handlers.onclick)):(this.el.find(".coords").remove(),t.un("click",this.handlers.onclick),t.addControl(this.state.control))}},{key:"clicked",value:function(t){this.el.find(".coords").html(Un(t.coordinate))}},{key:"copy",value:function(t){h(t).then((function(){st("success","".concat(it("Coordinates")," ").concat(t," ").concat(it("copied to clipboard")))})).catch((function(){st("error",it("Unable to copy to clipboard"))}))}},{key:"animate",value:function(t){var e=this,n=t.coordinate;this.state.overlay.setPosition(n),this.animationEl.html('<circle id="map-click-animation" cx="10" cy="10" r="0" fill="#000" opacity="0.5"/>'),setTimeout((function(){e.state.overlay.setPosition(void 0),e.animationEl.html("")}),500)}}])&&Mn(n.prototype,o),r&&Mn(n,r),i}(ot);function Vn(t){return(Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Hn(t,e){return!e||"object"!==Vn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Yn(t){return(Yn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zn(t,e){return(Zn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xn={osrm:new fn,openrouteservice:new bn},Kn={from:null,to:null},Qn=null,$n=new jn;function to(){Kn.from=null,Kn.to=null,Qn&&(Qn.setMap(null),Qn.getSource().clear(),Qn=null),Q("routing/stops",[]),Q("navigate/to",null)}function eo(t,e){return Qn&&Qn.getSource().getFeatures().length&&Qn.getSource().clear(),new Promise((function(n,o){var r=$("app/routing").provider,a=r in Xn?Xn[r]:null;if(!a)throw new Error(it("Missing provider, aborting!"));var i=a.formatInput(t,!0);if(!a.test(i))throw new Error(it("Routing input test failed, aborting!"));a.directions(i).then((function(o){if($n.close(),o){Qn||(Qn=no()).setMap($("map"));var r=o.getGeometry().getCoordinates(),a=Object(c.b)(t[0],t[t.length-1]),i=C(Object(Bt.g)(t[0]),Object(Bt.g)(t[t.length-1]));if(!(r.length>1&&a>Object(c.b)(t[0],Object(Bt.p)(r[0]))&&a>Object(c.b)(t[t.length-1],Object(Bt.p)(r[r.length-1]))))throw new Error(it("Invalid route"));r.unshift(Object(Bt.g)(t[0],$("map/projection"))),r.push(Object(Bt.g)(t[t.length-1],$("map/projection"))),o.getGeometry().setCoordinates(r),Qn.getSource().addFeature(o),Q("routing/stops",t),$("routing/infoFromRoute")||o.set("distance",a),o.set("bearing",i),e&&$n.open("<b>".concat(it("Directions"),"</b> ").concat($("routing/infoFromRoute")?"":" - ".concat(it("As crow flies")),"<br>\n                ").concat(j(null,o.get("distance"),[0,1]),"\n                <i>&middot;</i> ").concat(Math.round(o.get("bearing")),"&deg;\n                ").concat($("routing/infoFromRoute")?"<i>&middot;</i> ".concat(E(o.get("duration"),"seconds")):"","\n              "),(function(){to()})),n(o)}})).catch(o)}))}function no(){return we({type:"FeatureCollection",id:S(),zIndex:99,title:"Route",style:[{stroke:{color:"rgba(255, 255, 255, 0.7)",width:7}},{stroke:{color:"rgba(0, 133, 203, 1)",width:3}}]})}function oo(){return Qn||(Qn=no()).setMap($("map")),Qn}var ro=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zn(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Yn(e);if(Jn()){var o=Yn(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Hn(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=null,e.state={contextmenu:{from:{content:'<i class="fas fa-directions text-success size-1_1"></i> '.concat(it("Directions from here")),onClick:function(t,n,o){var r=o?o[1]:qn(n);Kn.from=r.getGeometry().getCoordinates(),Q("routing/stops",[Object(Bt.p)(Kn.from),Kn.to&&Object(Bt.p)(Kn.to)]),e.findRoute()},closeOnClick:!0},to:{content:'<i class="fas fa-directions text-danger size-1_1"></i>\n            '.concat(it("Directions to here"),'\n            <a href="#" class="btn btn-link context-item-btn"><i class="fab fa-google"></i></a>'),onClick:function(t,n,o){var r=o?o[1]:qn(n);Kn.to=r.getGeometry().getCoordinates(),Q("routing/stops",[Kn.from&&Object(Bt.p)(Kn.from),Object(Bt.p)(Kn.to)]),e.findRoute()},closeOnClick:!0,onBtnClick:function(t,e,n){t.preventDefault();var o=Object(Bt.p)(e).slice(0,2).reverse().join(",");ut()("<a>").attr("href",W.google.directions+o).attr("target","_blank")[0].click()}},done:{content:'<i class="fas fa-directions text-info size-1_1"></i>\n            '.concat(it("Retry directions"),'\n            <a href="#" class="btn btn-link context-item-btn"><i class="fas fa-times"></i></a>'),onClick:function(t,n,o){e.findRoute()},closeOnClick:!0,onBtnClick:function(t,e,n){t.preventDefault(),$n.close()}}}},e.handleContextMenuItems(),tt("routing/stops",(function(){e.handleContextMenuItems()})),tt("routing/profile",(function(){e.handleContextMenuItems()})),e}return n=i,(o=[{key:"handleContextMenuItems",value:function(){var t=this,e=$("map/contextmenu"),n=void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile;Object.keys(this.state.contextmenu).forEach((function(n){var o=e.indexOf(t.state.contextmenu[n]);o>-1&&e.splice(o,1)})),n&&(Qn&&Qn.getSource().getFeatures().length?e.push(this.state.contextmenu.done):(Kn.from||e.push(this.state.contextmenu.from),Kn.to||e.push(this.state.contextmenu.to),Kn.from&&Kn.to&&e.push(this.state.contextmenu.done)))}},{key:"findRoute",value:function(){var t=$("routing/stops");t.filter((function(t){return!!t})).length>1&&eo(t,!0).then((function(t){})).catch((function(t){st("error",t),$("app/debug")&&console.error("routing error",t)}))}},{key:"clear",value:function(){to()}}])&&Bn(n.prototype,o),r&&Bn(n,r),i}(ot),ao=n(46),io=n(209),co=n(48),so=n(58),lo=n(42),uo=n(310);n(391);function fo(t){return(fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function po(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ho(t,e){return!e||"object"!==fo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function mo(t){return(mo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function go(t,e){return(go=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&go(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=mo(e);if(yo()){var o=mo(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return ho(this,t)});function i(t,e){var n;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=a.call(this,t)).id="tab-geotrip",n.icon="fa fa-thumbtack",n.btnTextVisible=!0,n.el=ut()('\n      <div\n        class="tab-pane fade"\n        id="'.concat(n.id,'"\n        role="tabpanel">\n      </div>\n    ')),n.state={tab:null,routeLayer:null,layers:$("map/layer/layers"),collection:new ao.a,init:!1},Q("geocache/trip",n.state.collection),$("map/layer/layers").on("remove",(function(t){$("ui/layermanager/sorting")||n.loadState()})),$("map/layer/overlays").on("remove",(function(t){$("ui/layermanager/sorting")||n.loadState()})),n.state.collection.on("add",(function(t){t.element.getGeometry()instanceof co.a?(t.element.set("_inGeotrip",!0),n.render()):n.state.collection.remove(t.element)})),n.state.collection.on("remove",(function(t){t.element.set("_inGeotrip",!1),n.render()})),n.create(),n.initEvents(),$("map"))?n.loadState():$("map/que").push((function(t){n.loadState()}));return n}return n=i,(o=[{key:"render",value:function(){var t=this,e=this.state.collection.getArray().filter((function(t){return!!t.get("fstatus_timestamp")&&"Found"===t.get("fstatus")}));if(this.el.html('\n      <ul class="list-group mb-3">\n      '.concat(this.state.collection.getLength()?this.renderTrip(this.state.collection):'<li class="list-group-item">\n          <i class="fas fa-plus"></i>\n          '.concat(it("Add features from map"),"\n        </li>"),"\n      </ul>\n      ").concat(this.state.collection.getLength()?'<div class="dropdown sort">\n          <button class="btn btn-link dropdown-toggle"\n            type="button"\n            id="geotripSort"\n            data-toggle="dropdown"\n            aria-haspopup="true"\n            aria-expanded="false">\n            <i class="fas fa-sort-amount-down"></i>\n          </button>\n          <div class="dropdown-menu" aria-labelledby="geotripSort">\n            <a class="dropdown-item sortby-found '.concat(e.length?"":"disabled",'" href="#">').concat(it("Found"),'</a>\n            <a class="dropdown-item sortby-routing" href="#">').concat(it("Optimize"),'</a>\n          </div>\n        </div>\n        <button type="button" class="btn btn-link routing">\n          <i class="fas fa-directions"></i> ').concat(it("Routing"),'\n        </button>\n        <div class="btn-group float-right" role="group">\n          <a role="button" class="btn btn-secondary export" title="').concat(it("Download"),'">\n            <i class="fas fa-download"></i> GPX\n          </a>\n          <button type="button" class="btn btn-secondary clear" title="').concat(it("Clear trip"),'">\n            <i class="fas fa-trash"></i>\n          </button>\n        </div>'):"","\n    ")),this.state.tab&&this.state.tab.find("span").html(this.state.collection.getLength()||it("Geotrip")),this.state.collection.getLength()){this.state.routeLayer||(this.state.routeLayer=this.createLayer(),this.state.routeLayer.setMap($("map"))),this.state.routeLayer.getSource().clear();var n=this.state.collection.getArray().map((function(t){return t.getGeometry().getCoordinates()})),o=[];if(n.length>1){for(var r=0,a=n.length;r<a;r++)r!==a-1?o[r]=[n[r],n[r+1]]:o[r-1][1]=n[r];o.forEach((function(e){t.state.routeLayer.getSource().addFeature(new lo.a(new so.a(e)))}))}io.a.create(this.el.find("ul")[0],{draggable:"li.sort-item",handle:".badge",onUpdate:function(e){t.reorderTrip(),t.render()}})}this.state.init&&(Q("geocache/trip/ids",this.state.collection.getArray().map((function(t){return t.getId()})),!0),Q("geocache/trip/found",e.map((function(t){return{id:t.getId(),fstatus:t.get("fstatus"),timestamp:t.get("fstatus_timestamp")}})),!0)),this.state.init=!0}},{key:"renderTrip",value:function(t){return t.getArray().map((function(t,e){return'\n        <li class="list-group-item sort-item" data-id="'.concat(t.getId(),'">\n          <button type="button" class="close" aria-label="').concat(it("Close"),'">\n            <i class="fa fa-times"></i>\n          </button>\n          <span class="badge badge-pill badge-primary">').concat(e+1,'</span>\n          <a href="#">').concat(it(t.get("name")),'</a>\n          <i class="fas fa-circle fstatus ').concat("Found"===t.get("fstatus")?"found":"",'"></i>\n          ').concat(t.get("fstatus_timestamp")?'<div class="text-muted small timestamp">\n              '.concat(it("Found"),":\n              ").concat(R(t.get("fstatus_timestamp"),!0)+" "+E(t.get("fstatus_timestamp")),"</div>"):"","\n        </li>")})).join("")}},{key:"initEvents",value:function(){var t=this;this.el.on("click","li button.close",(function(e){e.preventDefault(),t.remove(ut()(e.currentTarget).closest("li").data("id"))})),this.el.on("click","li a",(function(e){e.preventDefault(),t.zoomTo(ut()(e.currentTarget).closest("li").data("id"))})),this.el.on("click","button.clear",(function(e){e.preventDefault(),t.clearTrip()})),this.el.on("click","a.export",(function(e){e.preventDefault(),t.export()})),this.el.on("click","a.sortby-found",(function(e){e.preventDefault(),t.sortByFound()})),this.el.on("click","a.sortby-routing",(function(e){e.preventDefault(),t.sortByRouting()})),this.el.on("click","button.routing",(function(e){e.preventDefault(),t.routing()}))}},{key:"reorderCollection",value:function(t,e){for(var n=function(n,o){var r=t.getArray().filter((function(t){return t.getId()===e[n]}));r&&r[0]&&(t.remove(r[0]),t.insertAt(n,r[0]))},o=0,r=e.length;o<r;o++)n(o)}},{key:"reorderTrip",value:function(){var t=[];this.el.find("li.sort-item").each((function(e,n){t.push(ut()(n).data("id"))})),this.reorderCollection(this.state.collection,t)}},{key:"sortByFound",value:function(){var t=$("geocache/trip/found");t.sort((function(t,e){return t.timestamp<e.timestamp?-1:t.timestamp>e.timestamp?1:0})),this.reorderCollection(this.state.collection,t.map((function(t){return t.id})))}},{key:"sortByRouting",value:function(){var t=this;if(void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile){var e=$("map/geolocation/position"),n=this.state.collection.getArray().map((function(t){return Object(Bt.p)(t.getGeometry().getCoordinates())})),o=n[0],r=n[n.length-1];e&&(o=Object(Bt.p)(e)),function(t,e,n){return new Promise((function(o,r){var a=$("app/routing").provider,i=a in Xn?Xn[a]:null;if(!i)throw new Error(it("Missing provider, aborting!"));var c=i.formatInput(n,!1);if(!i.test(c))throw new Error(it("Routing input test failed, aborting!"));i.optimize(t,e,c).then(o).catch(r)}))}(o,r,n).then((function(e){var n=e.steps.filter((function(t){return"job"===t.type})).map((function(e){return t.state.collection.getArray()[e.job].getId()}));t.reorderCollection(t.state.collection,n),st("success",it("Geotrip reordered by optimum path"))})).catch((function(t){console.error(t),st("error",it("Unable to determine ordering"))}))}else st("error",it("Routing disabled"))}},{key:"routing",value:function(){if(void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile){var t=$("map/geolocation/position"),e=this.state.collection.getArray().map((function(t){return Object(Bt.p)(t.getGeometry().getCoordinates())}));t&&e.unshift(Object(Bt.p)(t)),eo(e,!0).then((function(t){})).catch((function(t){return st("error",it("Unable to find route")+t)}))}else st("error",it("Routing disabled"))}},{key:"loadState",value:function(){var t=$("geocache/trip/ids"),e=$("geocache/trip/found");this.clearTrip(),t&&(this.getTripFeaturesFromGroup($("map/layer/layers"),t,this.state.collection),this.getTripFeaturesFromGroup($("map/layer/overlays"),t,this.state.collection),e&&this.state.collection.forEach((function(t){var n=e.filter((function(e){return e.id===t.getId()}))[0];n&&(t.set("fstatus",n.fstatus),t.set("fstatus_timestamp",n.timestamp))})),this.reorderCollection(this.state.collection,t))}},{key:"getTripFeaturesFromGroup",value:function(t,e,n){t.getArray().filter((function(t){return t.get("conf")&&"FeatureCollection"===t.get("conf").type})).forEach((function(t){t.getSource().forEachFeature((function(t){e.indexOf(t.getId())>-1&&n.push(t)}))}))}},{key:"clearTrip",value:function(){this.state.routeLayer&&this.state.routeLayer.getSource().clear(),this.state.collection.clear()}},{key:"remove",value:function(t){var e=this.state.collection.getArray().filter((function(e){return e.getId()===t}));e&&e[0]&&this.state.collection.remove(e[0])}},{key:"zoomTo",value:function(t){var e=this.state.collection.getArray().filter((function(e){return e.getId()===t}));e&&e[0]&&$("map").getView().animate({center:e[0].getGeometry().getCoordinates(),zoom:15,duration:500})}},{key:"export",value:function(){var t=[],e=this.state.collection.getArray().map((function(e){var n=e.clone();return n.getGeometry().transform($("map/projection"),"EPSG:4326"),t.push(n.getGeometry().getCoordinates()),n}));e.length>1&&e.push(new lo.a(new so.a(t))),y(q.exportFileName,e)}},{key:"createLayer",value:function(){var t=$("map").getView(),e=$("map/projection");return we({type:"FeatureCollection",title:"Route",updateWhileAnimating:!0,updateWhileInteracting:!0,style:function(n,o,r){var a=n.getGeometry(),i=6*t.getResolution()/1e3,s=Object(c.c)(a)/1e3,l=a.clone().transform(e,"EPSG:4326");if(s-2*i>i){var u=Object(uo.a)({type:"LineString",coordinates:l.getCoordinates()},i,s-1.5*i);l.setCoordinates(u.geometry.coordinates),l.transform("EPSG:4326",e);var f=l.getCoordinates(),p=f[f.length-1][0]-f[f.length-2][0],d=f[f.length-1][1]-f[f.length-2][1],h=Math.atan2(d,p);return[r({stroke:{color:"white",width:5},geometry:l}),r({stroke:{color:"rgba(0, 0, 0, 0.6)",width:3},geometry:l}),r({shape:{fill:{color:"rgba(0, 0, 0, 0.6)"},stroke:{color:"white",width:1},points:3,radius:8,rotateWithView:!0,rotation:-h,angle:33},geometry:new co.a(l.getLastCoordinate())})]}return null}})}}])&&po(n.prototype,o),r&&po(n,r),i}(ot),vo=n(210),wo={test:function(t){var e=t.filter((function(t){return void 0!==t.get("fstatus")&&void 0!==t.get("type")&&t.get("date_hidden")}));return e.length>0},formatFeatures:function(t){var e=new Date;t.features.forEach((function(n){n.set("type",t.mapping.type[n.get("type")]||n.get("type")),n.set("isCache","Geocache"===n.get("type").substring(0,8)),n.set("fstatus",t.mapping.fstatusJSON[n.get("fstatus")]||n.get("fstatus")),n.set("status","Available"),n.set("time",n.get("date_hidden")),n.unset("date_hidden"),n.set("url",t.url+n.get("id")),n.set("owner",n.get("user_id")),n.unset("user_id"),n.set("container",t.mapping.container[n.get("size")]||n.get("size")),n.unset("size");var o=new Date(n.get("date_hidden")),r=new Date(o.getFullYear(),o.getMonth(),o.getDate()+t.newCacheDays),a="Not Found"===n.get("fstatus")&&r>e?"New Cache":null;n.get("newCache")||n.set("newCache",a),n.getId()||n.setId(t.uid())}))}},ko=(n(392),{test:function(t){var e=t.filter((function(t){return t.get("pgc")&&t.get("content")&&t.get("icon")}));return e.length>0},formatFeatures:function(t){t.features.forEach((function(e){var n=ut()(e.get("content")),o=e.get("icon"),r=ut()(n[2]).text().split(" / ").map((function(t){return t.trim()}));e.set("isCache",!0),e.set("type","Geocache|"+r[0]),e.set("owner","");var a=o.endsWith("&isFound")?"1":"0";o.endsWith("&isOwned")&&t.user&&(a="2",e.set("owner",t.user)),e.set("fstatus",t.mapping.fstatusJSON[a]||a);var i=o.endsWith("&fade")?"Unavailable":"Available";e.set("status",i),e.set("name",ut()(n[0]).text()),e.set("url",ut()(n[0]).attr("href")),e.set("container",r[1]),e.set("difficulty",r[2]),e.set("terrain",r[3]),e.set("time",null),e.getId()||e.setId(t.uid())}))}}),Ao={test:function(t){var e=t.filter((function(t){return t.get("wpt")&&t.get("wpt")["groundspeak:cache"]}));return e.length>0},formatFeatures:function(t){var e=new Date;t.features.forEach((function(n){var o=n.get("wpt");if(o["groundspeak:cache"]){var r={};Object.keys(o["groundspeak:cache"]).forEach((function(t){"_text"!==t&&(r[t.replace("groundspeak:","")]=o["groundspeak:cache"][t]._text?o["groundspeak:cache"][t]._text:o["groundspeak:cache"][t])})),n.set("id",r["@id"]),n.set("isCache","Geocache"===n.get("type").substring(0,8));var a=n.get("sym");t.user&&t.user===r.owner&&(a="Geocache Owner"),n.set("fstatus",t.mapping.fstatusGPX[a]||a);var i="True"===r["@available"]?"Available":"Unavailable";"True"===r["@archived"]&&(i="Archived"),n.set("status",i),n.set("time",o.time._text),n.set("name",r.name),n.set("url",o.url._text),n.set("owner",r.owner),n.set("container",r.container),n.set("difficulty",r.difficulty),n.set("terrain",r.terrain);var c=new Date(n.get("time")),s=new Date(c.getFullYear(),c.getMonth(),c.getDate()+t.newCacheDays),l="Not Found"===n.get("fstatus")&&s>e?"New Cache":null;n.set("newCache",l)}else n.set("name",n.get("type")),n.set("url",o.url._text);n.getId()||n.setId(t.uid())}))}};n(395);function So(t){return(So="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oo(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function jo(t,e){return!e||"object"!==So(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Ro(t){return(Ro=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Eo(t,e){return(Eo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Po=[wo,ko,Ao],Co=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Eo(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Ro(e);if(xo()){var o=Ro(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return jo(this,t)});function i(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('\n      <div id="geocache" class="btn-group">\n        <button\n          class="btn btn-secondary"\n          title="'.concat(it("Caches"),'">\n          <i class="fa fa-cube"></i>\n          <span>').concat(it("Caches"),"</span>\n        </button>\n      </div>\n    ")),e.state={layers:new ao.a,styleCache:{},styleConfig:q.styles,currentUser:$("app/account")};var n=function(t){var n=0;e.state.layers.forEach((function(t){n+=t.getSource().getFeatures().filter((function(t){return t.get("isCache")&&!t.get("hidden")})).length})),e.el.find("button > span").html(n||it("Caches")),e.sidebar.getComponent("Filter").get("tab").find("span").html(n||it("Filter"))};return e.state.layers.on("add",n),e.state.layers.on("remove",n),tt("geocache/filter",n),e.state.styleConfig.radiusStyle.geometry=function(t){var e=t.getGeometry().getCoordinates(),n=v(Object(Bt.p)(e));return new vo.a(e,q.radiusStyle.radius*n)},e.create(),e.sidebar=new Ie({target:ut()("#geop"),trigger:e.el.find("button"),position:"left",components:{GeocacheLoader:Je,Filter:tn,Geotrip:bo},activeComponent:"tab-loader",shadow:!1,props:{collection:e.state.layers}}),e.layersPick(),e}return n=i,(o=[{key:"layersPick",value:function(){var t=this,e=$("map/layer/layers");e.forEach((function(e){t.checkLayer(e)&&t.registerLayer(e)})),e.on("add",(function(e){t.checkLayer(e.element)&&t.registerLayer(e.element)})),e.on("remove",(function(e){t.state.layers.remove(e.element)}))}},{key:"checkLayer",value:function(t){var e=t.getSource().getFeatures?t.getSource().getFeatures():null;if(e)for(var n=0,o=Po.length;n<o;n++)if(Po[n].test(e))return t.set("_cacheFormatParser",Po[n]),!0;return!1}},{key:"registerLayer",value:function(t){var e=this,n={"Not Found":"far fa-square",Found:"far fa-check-square",Owner:"fas fa-user"};t.get("_cacheFormatParser").formatFeatures({features:t.getSource().getFeatures(),newCacheDays:q.newCacheDays,mapping:q.mapping,user:this.state.currentUser,uid:S,url:q.cacheUrl,date:R}),t.setStyle((function(t,n){return e.styleGeocache(t,n)})),t.set("_featureInfo",{title:function(t){var n=$("geocache/trip"),o=n&&n.getArray().indexOf(t)>-1,r=e.state.styleConfig.text[t.get("type")];return t.get("isCache")?'\n            <i class="'.concat(r?r.class:e.state.styleConfig.base.class," ").concat("Available"!==t.get("status")?"unavailable":"",'"></i>\n            <a href="').concat(t.get("url"),'" target="_blank" class="').concat("Archived"===t.get("status")?"archived":"",'">').concat(it(t.get("name")),'</a>\n            <div class="tools">\n              <a href="#" class="cache-toggle" data-id="').concat(t.getId(),'" title="').concat(it("Add to geotrip"),'">\n                <i class="fas ').concat(o?"fa-minus-square":"fa-thumbtack",'"></i>\n              </a>\n            </div>'):'\n            <i class="'.concat(r?r.class:e.state.styleConfig.base.class,'"></i>\n            <a href="').concat(t.get("url"),'" target="_blank">').concat(it(t.get("name")),'</a>\n            <div class="tools">\n              <a href="#" class="cache-toggle" data-id="').concat(t.getId(),'" title="').concat(it("Add to geotrip"),'">\n                <i class="fas ').concat(o?"fa-minus-square":"fa-thumbtack",'"></i>\n              </a>\n            </div>')},content:function(t){var o=e.state.styleConfig.text[t.get("type")];return t.get("isCache")?'\n            <p class="text-muted metadata">\n              <i class="fas fa-clock"></i> '.concat(t.get("time")?R(t.get("time")):"",'<br/>\n              <i class="fa fa-user"></i> ').concat(t.get("owner"),'<br/>\n              <i class="').concat(o?o.class:e.state.styleConfig.base.class,'"></i>\n              ').concat(it(t.get("type")),'<br/>\n              <i class="fa fa-chart-area"></i> ').concat(t.get("terrain"),'\n              <i class="fa fa-star ml-2"></i> ').concat(t.get("difficulty"),'\n              <i class="fa fa-expand-arrows-alt ml-2"></i> ').concat(it(t.get("container")),"<br/>\n              ").concat(t.get("cmt")?'<i class="fa fa-hand-point-right"></i> '.concat(t.get("cmt")):"",'\n            </p>\n            <p class="toggle-found">\n              <i class="').concat(n[t.get("fstatus")],'"></i> <span>').concat(it(t.get("fstatus")),"</span>\n            </p>"):"\n            <p>\n              ".concat(t.get("desc"),"\n            </p>")},onShow:function(t,e){var o=$("geocache/trip");ut()(e).on("click",".toggle-found",(function(r){var a=o&&o.getArray().indexOf(t[1])>-1,i="Found"===t[1].get("fstatus");if(ut()(r.currentTarget).find("i").removeClass(n[t[1].get("fstatus")]),t[1].set("fstatus",i?"Not Found":"Found"),t[1].set("fstatus_timestamp",i?null:Date.now()),ut()(r.currentTarget).find("span").html(it(t[1].get("fstatus"))),ut()(r.currentTarget).find("i").addClass(n[t[1].get("fstatus")]),a||i||o.push(t[1]),a){var c=o.getArray().indexOf(t[1]);o.remove(t[1]),o.insertAt(c,t[1])}ut()(e).popover("dispose")}))}}),this.state.layers.push(t),Q("geocache/loadend",this.state.layers.getLength()),$("app/debug")&&console.debug("Geocache.registerLayer: "+t.get("id")+", "+t.get("title"))}},{key:"styleGeocache",value:function(t,e){var n=t.get("type"),o=t.get("fstatus"),r=t.get("newCache"),a=t.get("status"),i=e>q.overviewMinResolution,c=n+o+r+a+i;if(!t.get("_inGeotrip")&&!t.get("isCache")&&e>q.waypointMaxResolution)return null;if(!t.get("_inGeotrip")&&t.get("hidden"))return null;if(!this.state.styleCache[c]){var s=P(i?Object.assign({},this.state.styleConfig.base,this.state.styleConfig.overview,this.state.styleConfig.color[o],this.state.styleConfig.newCache[r]||{}):Object.assign({},this.state.styleConfig.base,this.state.styleConfig.text[n],this.state.styleConfig.color[o],this.state.styleConfig.newCache[r]||{}));"Available"!==a&&(s.fill&&(s.fill.color=O(s.fill.color,.5)),s.stroke&&(s.stroke.color=O(s.stroke.color,.7))),this.state.styleCache[c]=oe({text:s,zIndex:t.get("isCache")?2:1})}return t.get("isCache")&&t.get("radiusVisible")&&e<=q.radiusStyle.maxResolution?(this.state.styleCache.radiusStyle||(this.state.styleCache.radiusStyle=oe(this.state.styleConfig.radiusStyle)),[this.state.styleCache[c],this.state.styleCache.radiusStyle]):[this.state.styleCache[c]]}}])&&Oo(n.prototype,o),r&&Oo(n,r),i}(ot),_o=(n(285),n(118)),To=n(45),Mo=n(21),Lo=n(10),Fo=n(0),Go=n(2);function Do(t){var e={};if(1===t.nodeType)for(var n=0,o=t.attributes.length;n<o;n++){var r=t.attributes.item(n);e["@"+r.nodeName]=r.nodeValue}else if(3===t.nodeType)return t.nodeValue.trim();if(t.hasChildNodes())for(var a,i=0,c=t.childNodes.length;i<c;i++){var s=t.childNodes.item(i),l=s.nodeName.replace("#","_");if(void 0===e[l])("string"!=typeof(a=Do(s))||a.length)&&(e[l]=a);else{if(void 0===e[l].push){var u=e[l];e[l]=[],("string"!=typeof u||u.length)&&e[l].push(u)}("string"!=typeof(a=Do(s))||a.length)&&e[l].push(a)}}return e}function No(t){return(No="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Io(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Wo(t,e){return!e||"object"!==No(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function zo(t){return(zo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vo(t,e){return(Vo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bo=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1","http://www.groundspeak.com/cache/1/0"],Ho=Object(Fo.q)(Bo,{text:Object(Fo.m)(Go.e,"linkText"),type:Object(Fo.m)(Go.e,"linkType")}),Jo=Object(Fo.q)(Bo,{rte:Object(Fo.i)((function(t,e){var n=e[0],o=Object(Fo.t)({flatCoordinates:[],layoutOptions:{}},Zo,t,e);if(!o)return;var r=o.flatCoordinates;delete o.flatCoordinates;var a=o.layoutOptions;delete o.layoutOptions;var i=rr(a,r),c=new so.a(r,i);Object(To.b)(c,!1,n);var s=new lo.a(c);return s.setProperties(o),s})),trk:Object(Fo.i)((function(t,e){var n=e[0],o=Object(Fo.t)({flatCoordinates:[],ends:[],layoutOptions:{}},Xo,t,e);if(!o)return;var r=o.flatCoordinates;delete o.flatCoordinates;var a=o.ends;delete o.ends;var i=o.layoutOptions;delete o.layoutOptions;var c=rr(i,r,a),s=new _o.a(r,c,a);Object(To.b)(s,!1,n);var l=new lo.a(s);return l.setProperties(o),l})),wpt:Object(Fo.i)((function(t,e){var n=e[0],o=Object(Fo.t)({},Yo,t,e);if(!o)return;var r={},a=or([],r,t,o),i=rr(r,a),c=new co.a(a,i);Object(To.b)(c,!1,n);var s=new lo.a(c);return s.setProperties(o),s.set("wpt",Do(t)),s}))}),Yo=Object(Fo.q)(Bo,{ele:Object(Fo.m)(Go.c),time:Object(Fo.m)(Go.b),magvar:Object(Fo.m)(Go.c),geoidheight:Object(Fo.m)(Go.c),name:Object(Fo.m)(Go.e),cmt:Object(Fo.m)(Go.e),desc:Object(Fo.m)(Go.e),src:Object(Fo.m)(Go.e),link:er,sym:Object(Fo.m)(Go.e),type:Object(Fo.m)(Go.e),fix:Object(Fo.m)(Go.e),sat:Object(Fo.m)(Go.d),hdop:Object(Fo.m)(Go.c),vdop:Object(Fo.m)(Go.c),pdop:Object(Fo.m)(Go.c),ageofdgpsdata:Object(Fo.m)(Go.c),dgpsid:Object(Fo.m)(Go.d),extensions:nr}),Zo=Object(Fo.q)(Bo,{name:Object(Fo.m)(Go.e),cmt:Object(Fo.m)(Go.e),desc:Object(Fo.m)(Go.e),src:Object(Fo.m)(Go.e),link:er,number:Object(Fo.m)(Go.d),extensions:nr,type:Object(Fo.m)(Go.e),rtept:function(t,e){var n=Object(Fo.t)({},Ko,t,e);if(n){var o=e[e.length-1],r=o.flatCoordinates,a=o.layoutOptions;or(r,a,t,n)}}}),Xo=Object(Fo.q)(Bo,{name:Object(Fo.m)(Go.e),cmt:Object(Fo.m)(Go.e),desc:Object(Fo.m)(Go.e),src:Object(Fo.m)(Go.e),link:er,number:Object(Fo.m)(Go.d),type:Object(Fo.m)(Go.e),extensions:nr,trkseg:function(t,e){var n=e[e.length-1];Object(Fo.s)(Qo,t,e);var o=n.flatCoordinates;n.ends.push(o.length)}}),Ko=Object(Fo.q)(Bo,{ele:Object(Fo.m)(Go.c),time:Object(Fo.m)(Go.b)}),Qo=Object(Fo.q)(Bo,{trkpt:function(t,e){var n=Object(Fo.t)({},$o,t,e);if(n){var o=e[e.length-1],r=o.flatCoordinates,a=o.layoutOptions;or(r,a,t,n)}}}),$o=Object(Fo.q)(Bo,{ele:Object(Fo.m)(Go.c),time:Object(Fo.m)(Go.b)}),tr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vo(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=zo(e);if(qo()){var o=zo(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Wo(this,t)});function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Uo(this,i),a.call(this,t)}return n=i,(o=[{key:"readFeaturesFromNode",value:function(t,e){if(!Object(Lo.f)(Bo,t.namespaceURI))return[];if("gpx"===t.localName){var n=Object(Fo.t)([],Jo,t,[this.getReadOptions(t,e)]);return n?(this.handleReadExtensions_(n),n):[]}return[]}}])&&Io(n.prototype,o),r&&Io(n,r),i}(s.a);function er(t,e){var n=e[e.length-1],o=t.getAttribute("href");null!==o&&(n.link=o),Object(Fo.s)(Ho,t,e)}function nr(t,e){e[e.length-1].extensionsNode_=t}function or(t,e,n,o){return t.push(parseFloat(n.getAttribute("lon")),parseFloat(n.getAttribute("lat"))),"ele"in o?(t.push(o.ele),delete o.ele,e.hasZ=!0):t.push(0),"time"in o?(t.push(o.time),delete o.time,e.hasM=!0):t.push(0),t}function rr(t,e,n){var o=Mo.a.XY,r=2;if(t.hasZ&&t.hasM?(o=Mo.a.XYZM,r=4):t.hasZ?(o=Mo.a.XYZ,r=3):t.hasM&&(o=Mo.a.XYM,r=3),4!==r){for(var a=0,i=e.length/4;a<i;a++)e[a*r]=e[4*a],e[a*r+1]=e[4*a+1],t.hasZ&&(e[a*r+2]=e[4*a+2]),t.hasM&&(e[a*r+2]=e[4*a+3]);if(e.length=e.length/4*r,n)for(var c=0,s=n.length;c<s;c++)n[c]=n[c]/4*r}return o}var ar=n(267),ir=n(173);function cr(t){return(cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sr(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function lr(t,e){return!e||"object"!==cr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ur(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function fr(t){return(fr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pr(t,e){return(pr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function dr(t){return{stroke:{color:t,width:2},fill:{color:O(t,.5)},circle:{stroke:{color:t},fill:{color:O(t,.3)}}}}var hr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pr(t,e)}(c,t);var e,n,o,r,a=(e=c,function(){var t,n=fr(e);if(ur()){var o=fr(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return lr(this,t)});function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),e=a.call(this,t),window.File&&window.FileReader&&window.FileList&&window.Blob?(e.el=ut()("<li />"),e.isRow=!0,e.fileTypes={gpx:new tr,geojson:new Vt.a,kml:new ar.a},e.fileTypes.json=e.fileTypes.geojson,e.state={layers:$("map/layer/layers")},e.addDragNDrop(),e):lr(e)}return n=c,(o=[{key:"render",value:function(){var t=this,e=$("app/debug");this.el.html('\n      <a href="#"\n        id="add-file-layer"\n        class="dropdown-item">\n        <i class="fa fa-plus"></i>\n        '.concat(it("Add File layer"),'\n      </a>\n      <input type="file" style="display:none;" />\n    ')),this.el.on("click","a#add-file-layer",(function(t){t.preventDefault(),t.stopPropagation(),ut()(t.target).closest("li").find("input").trigger("click")})),this.el.on("change","input",(function(n){var o=n.target.files;if(o&&o[0]){var r=o[0].name,a=r.split(".").pop().toLowerCase();if(a in t.fileTypes){e&&console.debug("FileLayer.render input change: ".concat(r));var i=new window.FileReader;i.onload=function(n){var o=t.fileTypes[a].readFeatures(n.target.result),i=t.fileTypes.geojson.writeFeaturesObject(o);i.title=r;var c=t.createLayer(i);c&&(t.state.layers.push(c),st("success","".concat(it("Added")," ").concat(i.features.length," ").concat(it("features"))),e&&console.debug("FileLayer.render layer created: ".concat(r,", features: ").concat(i.features.length)))},i.readAsText(o[0])}else st("error",it("Unsupported file type")),e&&console.error("FileLayer.render Unsupported file type: ".concat(r))}}))}},{key:"addDragNDrop",value:function(){var t=this,e=$("map"),n=!1;if(e&&e.getInteractions().forEach((function(t){t instanceof ir.a&&(n=!0)})),!n){var o=new ir.a({projection:"EPSG:4326",formatConstructors:[tr,Vt.a,ar.a]});o.on("addfeatures",(function(e){var n=t.fileTypes.geojson.writeFeaturesObject(e.features);n.title=e.file.name;var o=t.createLayer(n);o&&(t.state.layers.push(o),st("success","".concat(it("Added")," ").concat(n.features.length," ").concat(it("features"))),$("app/debug")&&console.debug("FileLayer.addDragNDrop layer created: ".concat(e.file.name,", features: ").concat(n.features.length)))})),e?e.addInteraction(o):$("map/que").push((function(t){t.addInteraction(o)}))}}},{key:"createLayer",value:function(t){if(t.features.length>0){var e=function(t){return i()(t)}({luminosity:"dark"});t.id=S(),t.features&&t.features.forEach((function(t){t.id=S()})),t.color=e,t.visible=!0,t.style=dr(e);try{return we(t)}catch(e){st("error",it("Error creating layer")+e),$("app/debug")&&console.debug("FileLayer.addDragNDrop layer created: ".concat(e.file.name,", features: ").concat(t.features.length))}}else st("error",it("Empty file")),$("app/debug")&&console.debug("FileLayer.addDragNDrop empty file: ".concat(t.title))}}])&&sr(n.prototype,o),r&&sr(n,r),c}(ot);n(396);function yr(t){return(yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mr(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function gr(t,e){return!e||"object"!==yr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function br(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function vr(t){return(vr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wr(t,e){return(wr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wr(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=vr(e);if(br()){var o=vr(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return gr(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('\n      <a href="#" id="osm-edit" title="'.concat(it("Edit OSM here"),'">\n        <i class="fa fa-edit"></i>\n      </a>\n    ')),e.isRow=!1,e}return n=i,(o=[{key:"render",value:function(){this.el.on("click",(function(t){t.preventDefault();var e=$("map/center"),n=$("map/zoom");window.open(W.ideditor+n+"/"+e[1]+"/"+e[0])}))}}])&&mr(n.prototype,o),r&&mr(n,r),i}(ot);function Ar(t){return(Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sr(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Or(t,e,n){return(Or="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Rr(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function jr(t,e){return!e||"object"!==Ar(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Rr(t){return(Rr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Er(t,e){return(Er=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Er(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Rr(e);if(xr()){var o=Rr(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return jr(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()("<li />"),e.modal=ut()("#modal_wmslayer"),e.isRow=!0,e.layer_conf={TileWMS:{type:"TileWMS",url:null,projection:"EPSG:3301",gutter:20,crossOrigin:null},WMTS:{type:"WMTS",url:null,projection:"EPSG:3301",layer:null,matrixSet:null,scaleDenominator:null,topLeftCorner:null,matrixWidth:1,matrixHeight:1,format:"image/png",crossOrigin:null}},e.layer_conf_params={LAYERS:null,TILED:!0,FORMAT:"image/png",VERSION:"1.1.1"},e}return n=i,(o=[{key:"render",value:function(){var t=this;if(!this.modal||0===this.modal.length){var e=Object.keys(W.wmsexamples).map((function(t){return'<a href="'.concat(W.wmsexamples[t],'">\n          ').concat(t,"\n        </a>")}));this.modal=ut()('\n        <div class="modal fade"\n          id="modal_wmslayer"\n          tabindex="-1"\n          role="dialog"\n          aria-hidden="true">\n          <div class="modal-dialog">\n            <div class="modal-content">\n              <div class="modal-header">\n                <h4 class="modal-title">'.concat(it("Add WMS layer"),'</h4>\n                <button type="button"\n                  class="close"\n                  data-dismiss="modal"\n                  aria-label="Close">\n                  <span aria-hidden="true">&times;</span>\n                </button>\n              </div>\n              <div class="modal-body">\n                <div class="text-muted">\n                  ').concat(it("Insert WMS/WMTS URL"),'\n                </div>\n                <textarea class="form-control" rows="3"></textarea>\n                <input name="id" type="hidden" />\n                <div class="form-inline py-2">\n                  <div class="form-check form-check-inline">\n                    <input class="form-check-input" type="radio" name="group" id="group1" value="base">\n                    <label class="form-check-label" for="group1">').concat(it("Add as base map"),'</label>\n                  </div>\n                  <div class="form-check form-check-inline">\n                    <input class="form-check-input" type="radio" name="group" id="group2" value="layers" checked>\n                    <label class="form-check-label" for="group2">').concat(it("Add as overlay"),'</label>\n                  </div>\n                </div>\n                <div class="small examples">\n                  ').concat(e.length?"<b>Näited:</b><br>":"","\n                  ").concat(e.join("<br/>"),'\n                </div>\n              </div>\n              <div class="modal-footer">\n                <button type="button" class="btn btn-secondary confirm">').concat(it("Add"),"</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      ")),this.modal.on("click","button.confirm",(function(e){if(e.preventDefault(),!(t.modal.find("textarea").val().length<10)){var n=t.modal.find("input[name=group]:checked").val(),o=$("map/layer/"+n),r=o.getLength();if(t.modal.find("input[name=id]").val().length){var a=o.getArray().filter((function(e){return e.get("id")===t.modal.find("input[name=id]").val()}));a.length&&(r=o.getArray().indexOf(a[0]),o.remove(a[0]))}var i=t.createLayer(t.modal.find("textarea").val().trim(),"base"===n);i&&(o.insertAt(r,i),t.modal.find("textarea, input[name=id]").val(""),t.modal.modal("hide"))}})),this.modal.on("click",".examples a",(function(e){e.preventDefault(),t.modal.find("textarea").val(decodeURIComponent(e.target.href))})),ut()("body").append(this.modal)}this.el.html('\n      <a href="#"\n        id="add-wms-layer"\n        class="dropdown-item"\n        data-toggle="modal"\n        data-target="#modal_wmslayer">\n        <i class="fa fa-plus"></i>\n        '.concat(it("Add WMS layer"),"\n      </a>\n    "))}},{key:"createLayer",value:function(t,e){var n=$("app/debug"),o=k(t);if(null!==t.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/g)&&o.query){var r=this.pickService(o.query);if(!r||!(r in this.layer_conf))return!1;var a=Object.assign({},this.layer_conf[r],o.query);switch(r){case"TileWMS":if(a.params=Object.assign({},this.layer_conf_params),!o.query.LAYERS&&!o.query.layers)return st("error",it("Missing LAYERS parameter")),void(n&&console.error("WMSLayer.createLayer: Missing LAYERS parameter - ".concat(t)));a.params.LAYERS=o.query.LAYERS||o.query.layers,a.title=o.query.title||a.params.LAYERS,delete o.query.LAYERS,delete o.query.layers;break;case"WMTS":a.topLeftCorner=o.query.topLeftCorner.split(",").map((function(t){return Number(t)})),a.title=o.query.title||a.layer,a.scaleDenominator=Number(o.query.scaleDenominator),a.matrixWidth=Number(o.query.matrixWidth),a.matrixHeight=Number(o.query.matrixHeight),delete o.query.topLeftCorner,delete o.query.layer,delete o.query.matrixSet,delete o.query.scaleDenominator,delete o.query.matrixWidth,delete o.query.matrixHeight,delete o.query.format}return o.query.SRS||o.query.srs?(a.projection=o.query.srs||o.query.SRS,delete o.query.SRS,delete o.query.srs,delete o.query.title,a.url=A(o),a.id=S(),a.visible=!0,a.opacity=Number(o.query.opacity)||1,a.editable=!0,e&&(a.zIndex=0),we(a)):(st("error",it("Missing SRS parameter")),void(n&&console.error("WMSLayer.createLayer: Missing SRS parameter - ".concat(t))))}return st("error",it("URL is not valid WMS resource!")),n&&console.error("WMSLayer.createLayer: URL is not valid WMS resource! - ".concat(t)),null}},{key:"destroy",value:function(){this.modal.modal("dispose"),this.modal.remove(),this.modal=null,Or(Rr(i.prototype),"destroy",this).call(this)}},{key:"pickService",value:function(t){return"matrixSet"in t?"WMTS":"layers"in t&&"TileWMS"}}])&&Sr(n.prototype,o),r&&Sr(n,r),i}(ot);function Cr(t){return(Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Tr(t,e){return!e||"object"!==Cr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Lr(t){return(Lr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fr(t,e){return(Fr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fr(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Lr(e);if(Mr()){var o=Lr(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Tr(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).format=new Vt.a,e.state={layers:$("map/layer/layers")},e.init(),e}return n=i,(o=[{key:"init",value:function(){var t,e=this,n=F("hash"),o=F("view");n&&(t=this.loadFeaturesFromUrl(n));var r=F("icon");if(r&&(t=this.addMarker(r)),!o&&t){var a=$("map");a?this.fitTo(a,t):$("map/que").push((function(n){e.fitTo(n,t)}))}}},{key:"fitTo",value:function(t,e){t.getView().fit(e,{padding:[100,100,100,100],maxZoom:14,duration:500})}},{key:"loadFeaturesFromUrl",value:function(t){G({hash:null});var e=pt.a.unpack(decodeURIComponent(t));if(e&&e.length){var n=e.map((function(t){return t.id}));n&&n.length&&Q("geocache/trip/ids",n,!0);var o=e.filter((function(t){return void 0!==t.properties.fstatus})),r=e.filter((function(t){return void 0===t.properties.fstatus})),a=[];if(o.length){var i=this.createLayer("Geocaches",o);Object(Ht.q)(a,i.getSource().getExtent()),this.state.layers.push(i)}if(r.length){var c=this.createLayer("Features",r);Object(Ht.q)(a,c.getSource().getExtent()),this.state.layers.push(c)}return $("app/debug")&&console.error("UrlLayer.loadFeaturesFromUrl: caches ".concat(o.length,", features ").concat(r.length)),a}return null}},{key:"addMarker",value:function(t){var e=t.split("/");if(e&&2===e.length){var n={type:"Feature",id:S(),geometry:{type:"Point",coordinates:[Number(e[1]),Number(e[0])]},properties:{name:"Point"}},o=this.createLayer("Point",[n],{text:{text:"",class:"fas fa-map-marker-alt",font:'900 24px "Font Awesome 5 Free"',textBaseline:"bottom",fill:{color:"#000"},stroke:{color:"#fff",width:4}}}),r=$("map");return r?o.setMap(r):$("map/que").push((function(t){o.setMap(t)})),$("app/debug")&&console.error("UrlLayer.addMarker: ".concat(t)),o.getSource().getExtent()}return null}},{key:"createLayer",value:function(t,e,n){return we({type:"FeatureCollection",id:S(),title:it(t),visible:!0,features:e,style:n})}}])&&_r(n.prototype,o),r&&_r(n,r),i}(ot);n(397);function Dr(t){return(Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nr(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return Ur(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ur(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r,a=!0,i=!1;return{s:function(){o=t[Symbol.iterator]()},n:function(){var t=o.next();return a=t.done,t},e:function(t){i=!0,r=t},f:function(){try{a||null==o.return||o.return()}finally{if(i)throw r}}}}function Ur(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function Ir(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Wr(t,e,n){return(Wr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Vr(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function qr(t,e){return!e||"object"!==Dr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Vr(t){return(Vr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Br(t,e){return(Br=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Br(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Vr(e);if(zr()){var o=Vr(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return qr(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('<div class="btn-group float-right" id="layermanager"></div>'),e.state={activeBaseLayer:null,base:$("map/layer/base"),layers:$("map/layer/layers"),overlays:$("map/layer/overlays"),open:!1},e.handlers={onbaselayerschange:function(t){e.changeBaseLayer(t.element.get("id"))||(e.state.open=!0,e.render())},onchange:function(){$("ui/layermanager/sorting")||e.render()}},e.state.base.forEach((function(t){t.get("id")===$("map/baseLayer")&&(e.state.activeBaseLayer=t)})),e.state.base.on("add",e.handlers.onbaselayerschange),e.state.base.on("remove",e.handlers.onbaselayerschange),e.state.layers.on("add",e.handlers.onchange),e.state.layers.on("remove",e.handlers.onchange),e.state.overlays.on("add",e.handlers.onchange),e.state.overlays.on("remove",e.handlers.onchange),e.create(),e.components={osm:kr,wms:Pr,file:hr},e.renderComponents(e.el.find(".dropdown-menu")),e.urlLayer=new Gr,D((function(t){if(t.view){var n=e.permalinkToViewConf(t.view);n&&e.changeBaseLayer(n)}})),e}return n=i,(o=[{key:"create",value:function(){Wr(Vr(i.prototype),"create",this).call(this),this.target&&this.el}},{key:"render",value:function(){var t=this;this.el.html('\n      <button type="button"\n        class="btn btn-secondary toggle-btn dropdown-toggle no-caret"\n        data-toggle="dropdown"\n        aria-label="'.concat(it("Layers"),'"\n        aria-expanded="false">\n        <span class="display-name d-none d-sm-inline-block">\n          ').concat(this.state.activeBaseLayer?it(this.state.activeBaseLayer.get("title")):it("Layers"),'\n        </span>\n        <i class="fa fa-layer-group"></i>\n      </button>\n      <ul class="dropdown-menu dropdown-menu-right">\n        ').concat(this.state.base.getLength()>0?this.state.base.getArray().map((function(e){var n="";return"FeatureCollection"===e.get("conf").type?n='<a href="#" class="fit-layer">\n            <i class="fa fa-search-plus"></i>\n          </a>':e.get("conf").editable&&(n='<a href="#" class="edit-layer" data-toggle="modal" data-target="#modal_wmslayer">\n            <i class="fa fa-edit"></i>\n          </a>\n          <a href="#" class="remove-layer">\n            <i class="fa fa-times"></i>\n          </a>'),'\n        <li\n          class="dropdown-item baselayer '.concat(t.layerVisible(e)?"":"disabled",'"\n          data-group="base" data-id="').concat(e.get("id"),'">\n          <label>\n            <i class="check far ').concat(e.getVisible()?"fa-dot-circle":"fa-circle",'"></i>\n            <span class="layer-title">').concat(it(e.get("title")),"</span>\n          </label>\n          ").concat(n.length?'<div class="layer-tools">\n            '.concat(n,"\n          </div>"):"","\n        </li>")})).join(""):'<li class="dropdown-item disabled">'.concat(it("No baselyers added"),"</li>"),"\n        ").concat(this.renderLayerGroup("overlays",this.state.overlays),"\n        ").concat(this.renderLayerGroup("layers",this.state.layers,!0),"\n      </ul>"));var e=this.el.find(".dropdown-menu");this.renderComponents(e),this.state.open&&(this.el.find("button.toggle-btn").dropdown("toggle"),this.state.open=!1),e.on("click",".baselayer label",(function(e){e.preventDefault(),e.stopPropagation();var n=ut()(e.currentTarget).closest("li").data("id");t.state.activeBaseLayer&&n===t.state.activeBaseLayer.get("id")?t.toggleLayer("base",n):t.changeBaseLayer(n)&&G({view:N({center:$("map/center"),zoom:$("map/zoom"),rotation:$("map/rotation"),baseLayer:n})})})),e.on("click",".layer label",(function(e){e.preventDefault(),e.stopPropagation(),t.toggleLayer(ut()(e.currentTarget).closest("li").data("group"),ut()(e.currentTarget).closest("li").data("id"))})),e.on("click",".tools a",(function(t){t.preventDefault(),t.stopPropagation()})),e.on("click","a.fit-layer",(function(e){e.preventDefault(),e.stopPropagation(),t.fitTo(ut()(e.currentTarget).closest("li").data("group"),ut()(e.currentTarget).closest("li").data("id"))})),e.on("click","a.remove-layer",(function(e){e.preventDefault(),e.stopPropagation(),t.removeLayer(ut()(e.currentTarget).closest("li").data("group"),ut()(e.currentTarget).closest("li").data("id"))})),e.on("change","input[type=color]",(function(e){t.setLayerColor(ut()(e.currentTarget).closest("li").data("group"),ut()(e.currentTarget).closest("li").data("id"),e.target.value),ut()(e.currentTarget).closest(".color").find(".dot").css("background",e.target.value)})),e.on("click",".colorpicker",(function(t){t.preventDefault(),t.stopPropagation(),ut()(t.currentTarget).closest(".color").find("input[type=color]").click()})),e.on("click","a.edit-layer",(function(e){e.preventDefault(),e.stopPropagation();var n=ut()(e.currentTarget).closest("li").data("id"),o=ut()(e.currentTarget).closest("li").data("group"),r=t.getWMSUrl(o,n);r&&(ut()(ut()(e.currentTarget).data("target")).modal(),ut()(ut()(e.currentTarget).data("target")).find("textarea").val(r),ut()(ut()(e.currentTarget).data("target")).find("input[name=id]").val(n),ut()(ut()(e.currentTarget).data("target")).find("input[type=radio]").filter("[value=".concat(o,"]")).prop("checked",!0))})),io.a.create(e[0],{draggable:"li.sort-item",handle:".sort-handle",onUpdate:function(e){t.reorderLayers(e)}})}},{key:"renderLayerGroup",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.getLength()>0?'<li class="dropdown-divider"></li>'+e.getArray().map((function(e){var r=e.get("conf").color&&!e.get("_cacheFormatParser")?'<span class="color">\n              <span class="colorpicker">\n                <i class="dot" style="background:'.concat(e.get("conf").color,'"></i>\n              </span>\n              <input type="color" class="" value="').concat(e.get("conf").color,'"/>\n            </span>'):"",a="";"FeatureCollection"===e.get("conf").type?a='<a href="#" class="fit-layer">\n              <i class="fa fa-search-plus"></i>\n            </a>':e.get("conf").editable&&(a='<a href="#" class="edit-layer" data-toggle="modal" data-target="#modal_wmslayer">\n              <i class="fa fa-edit"></i>\n            </a>');var i=o?'<a href="#" class="sort-handle">\n              <i class="dot"></i>\n            </a>':"";return'\n          <li\n            class="dropdown-item '.concat(o?"sort-item":""," layer ").concat(n.layerVisible(e)?"":"disabled",'"\n            data-group="').concat(t,'" data-id="').concat(e.get("id"),'">\n            ').concat(r,'\n            <label>\n              <i class="check far ').concat(e.getVisible()?"fa-check-square":"fa-square",'"></i>\n              <span class="layer-title">').concat(it(e.get("title")),'</span>\n            </label>\n            <div class="layer-tools">\n              ').concat(i,"\n              ").concat(a,'\n              <a href="#" class="remove-layer">\n                <i class="fa fa-times"></i>\n              </a>\n            </div>\n          </li>')})).join(""):""}},{key:"permalinkToViewConf",value:function(t){return(t?t.split("-"):[])[4]}},{key:"layerVisible",value:function(t){return!(t.minResolution&&this._map.getView().getResolution()<t.minResolution||t.maxResolution&&this._map.getView().getResolution()>t.maxResolution)}},{key:"changeBaseLayer",value:function(t){var e=this.state.base.getArray().filter((function(e){return e.get("id")===t}));return 1===e.length&&(this.state.base.forEach((function(t){t.setVisible(!1)})),e[0].setVisible(!0),this.state.activeBaseLayer=e[0],Q("map/baseLayer",t,!0),this.state.open=!0,this.render(),!0)}},{key:"toggleLayer",value:function(t,e){this.state[t].forEach((function(n){n.get("id")===e&&(n.setVisible(!n.getVisible()),Q("layerchange",[t,e]))})),this.state.open=!0,this.render()}},{key:"removeLayer",value:function(t,e){var n=this;this.state[t].forEach((function(o){o&&o.get("id")===e&&(n.state.open=!0,n.state[t].remove(o))}))}},{key:"reorderLayers",value:function(t){var e=this;if(t.oldDraggableIndex!==t.newDraggableIndex){var n=ut()(t.item).data("id"),o=ut()(t.item).data("group");this.state[o].forEach((function(r){r.get("id")===n&&(Q("ui/layermanager/sorting",!0),e.state[o].remove(r),e.state[o].insertAt(t.newDraggableIndex,r),Q("ui/layermanager/sorting",!1))}))}}},{key:"fitTo",value:function(t,e){var n,o=Nr(this.state[t].getArray());try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r&&r.get("id")===e){this.state.open=!0;var a=r.getSource().getExtent?r.getSource().getExtent():r.getExtent();a?$("map").getView().fit(a,{padding:[50,50,50,50],maxZoom:17,duration:500}):(st("error","".concat(it("Unable to find layer extent"))),$("app/debug")&&console.error("LayerManager.fitTo: no bbox ".concat(t,", ").concat(e)));break}}}catch(t){o.e(t)}finally{o.f()}}},{key:"renderComponents",value:function(t){var e=this,n=!1;Object.keys(this.components).forEach((function(o){var r=new e.components[o](t);r&&r.isRow&&!n&&(t.append('<div class="dropdown-divider"></div>'),n=!0),r.create()}))}},{key:"setLayerColor",value:function(t,e,n){var o=this;this.state[t].forEach((function(r){if(r&&r.get("id")===e){var a=r.get("conf");return a.color=n,a.style=dr(n),r.set("conf",a),r.setStyle(oe(a.style)),o.storeLayers(t),!0}}))}},{key:"getWMSUrl",value:function(t,e){var n,o=Nr(this.state[t].getArray());try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r&&r.get("id")===e){var a=r.get("conf"),i=k(a.url);switch(i.query.srs=a.projection,i.query.title=r.get("title"),a.format&&(i.query.format=a.format),a.type){case"TileWMS":i.query.layers=a.params.LAYERS;break;case"WMTS":i.query.layer=a.layer,i.query.matrixSet=a.matrixSet,i.query.scaleDenominator=a.scaleDenominator,i.query.matrixWidth=a.matrixWidth,i.query.matrixHeight=a.matrixHeight,i.query.topLeftCorner=a.topLeftCorner.join(",")}return A(i)}}}catch(t){o.e(t)}finally{o.f()}return null}},{key:"storeLayers",value:function(t){Q("layer/"+t,this.state[t].getArray().map((function(t){return t.get("conf")})),!0)}}])&&Ir(n.prototype,o),r&&Ir(n,r),i}(ot),Jr=(n(398),n(295),n(186),[{regexp:/^(34N)[ ,;:]\s*([0-9]{7}|[0-9]{1,7}[,.]\d{0,9})[ ,;:]\s*([0-9]{6}|[0-9]{6}[,.]\d{0,9})\s*$/,srid:"EPSG:32634",srname:"UTM 34N",get:function(t){return[Number(t[3].replace(",",".")),Number(t[2].replace(",","."))]}},{regexp:/^(34N)[ ,;:]\s*?([0-9]{6}|[0-9]{6}[,.]\d{0,9})[ ,;:]\s*([0-9]{7}|[0-9]{1,7}[,.]\d{0,9})\s*$/,srid:"EPSG:32634",srname:"UTM 34N",get:function(t){return[Number(t[2].replace(",",".")),Number(t[3].replace(",","."))]}},{regexp:/^(35N)[ ,;:]\s*([0-9]{7}|[0-9]{1,7}[,.]\d{0,9})[ ,;:]\s*([0-9]{6}|[0-9]{6}[,.]\d{0,9})\s*$/,srid:"EPSG:32635",srname:"UTM 35N",get:function(t){return[Number(t[3].replace(",",".")),Number(t[2].replace(",","."))]}},{regexp:/^(35N)[ ,;:]\s*?([0-9]{6}|[0-9]{6}[,.]\d{0,9})[ ,;:]\s*([0-9]{7}|[0-9]{1,7}[,.]\d{0,9})\s*$/,srid:"EPSG:32635",srname:"UTM 35N",get:function(t){return[Number(t[2].replace(",",".")),Number(t[3].replace(",","."))]}},{regexp:/^\d{1,2}[^ABIOYZabioyz]\s?[A-Za-z]{2}\s?([0-9]+)\s?([0-9]+)$/,srid:"mrgs",srname:"MRGS",get:function(t){return t[0].replace(/\s/g,"")}},{regexp:/^(6[3-6][0-9]{5}|6[3-6][0-9]{5}[,.]\d{0,9})[ ,;:]\s*([3-7][0-9]{5}|[3-7][0-9]{5}[,.]\d{0,9})\s*$/,srid:"EPSG:3301",srname:"L-EST",get:function(t){return[Number(t[2].replace(",",".")),Number(t[1].replace(",","."))]}},{regexp:/^([3-7][0-9]{5}|[3-7][0-9]{5}[,.]\d{0,9})[ ,;:]\s*(6[3-6][0-9]{5}|6[3-6][0-9]{5}[,.]\d{0,9})\s*$/,srid:"EPSG:3301",srname:"L-EST",get:function(t){return[Number(t[1].replace(",",".")),Number(t[2].replace(",","."))]}},{regexp:/^([-NS])?\s*([0-8]\d?|90)[ °]+([0-9]{2})[ ’'′]+([0-9]{1,2}[,.]?\d{1,9})["″]?[ ,;:]\s*([-EW])?\s*([0-1]\d{0,2}|\d{2})[ °]+([0-9]{2})[ ’'′]+([0-9]{1,2}[,.]?\d{1,9})["″]?\s*$/,srid:"EPSG:4326",srname:"WGS84 (dms)",get:function(t){var e=[Number(t[6])+Number(t[7])/60+Number(t[8].replace(",","."))/60/60,Number(t[2])+Number(t[3])/60+Number(t[4].replace(",","."))/60/60];return e[1]="-"===t[1]||"S"===t[1]?-e[1]:e[1],e[0]="-"===t[5]||"W"===t[5]?-e[0]:e[0],e}},{regexp:/^([-NS])?\s*([0-8]\d?|90)[ °]+([0-9]{1,2}[,.]?\d{1,18})[’'′]?[ ,;:]\s*([-EW])?\s*([0-1]\d{0,2}|\d{2})[ °]+([0-9]{1,2}[,.]?\d{1,18})[’'′]?\s*$/,srid:"EPSG:4326",srname:"WGS84 (dm)",get:function(t){var e=[Number(t[5])+Number(t[6].replace(",","."))/60,Number(t[2])+Number(t[3].replace(",","."))/60];return e[1]="-"===t[1]||"S"===t[1]?-e[1]:e[1],e[0]="-"===t[4]||"W"===t[4]?-e[0]:e[0],e}},{regexp:/^([-NS])?\s*([1-8]?\d(?:[,.]\d{1,18})?|90(?:\.0{1,18})?)[°]?[ ,;:]\s*([-EW])?\s*((?:1[0-7]|[1-9])?\d(?:[,.]\d{1,18})?|180(?:\.0{1,18})?)[°]?\s*$/,srid:"EPSG:4326",srname:"WGS84 (d)",get:function(t){var e=[Number(t[4].replace(",",".")),Number(t[2].replace(",","."))];return e[1]="-"===t[1]||"S"===t[1]?-e[1]:e[1],e[0]="-"===t[3]||"W"===t[3]?-e[0]:e[0],e}}]);function Yr(t){return(Yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zr(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Xr(t,e){return!e||"object"!==Yr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Qr(t){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $r(t,e){return($r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ta=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$r(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Qr(e);if(Kr()){var o=Qr(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Xr(this,t)});function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this)).title="Coordinate",t.query=null,t}return n=i,(o=[{key:"test",value:function(t){for(var e=0,n=Jr.length;e<n;e++){var o=t.match(Jr[e].regexp);if(o&&o.length>0){var r={coords:Jr[e].get(o),srid:Jr[e].srid,srname:Jr[e].srname};return"mrgs"===Jr[e].srid&&(r.srid="EPSG:4326",r.coords=_n.a.toPoint(r.coords)),r}}return!1}},{key:"find",value:function(t){var e=this;return this.query=t,new Promise((function(n,o){if(t.length<1)throw new Error(it("Query string empty, aborting!"));var r=e.test(t),a=[];r&&r.srid&&a.push(r),n(e.format(a))}))}},{key:"format",value:function(t){var e=this;return t.map((function(t){return e.toGeoJSON({provider:e.title,name:"".concat(t.srname," ").concat(e.query),srid:t.srid,coords:t.coords})}))}}])&&Zr(n.prototype,o),r&&Zr(n,r),i}(nn);function ea(t){return(ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function na(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function oa(t,e){return!e||"object"!==ea(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ra(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function aa(t){return(aa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ia(t,e){return(ia=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ca=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ia(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=aa(e);if(ra()){var o=aa(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return oa(this,t)});function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this)).title="Addresses",t.xhr=null,t}return n=i,(o=[{key:"test",value:function(t){return t.length>=3}},{key:"find",value:function(t){var e=this;return new Promise((function(n,o){if(!e.test(t))throw new Error(it("Query string too short, aborting!"));e.geocode(t,(function(t){if(!t)throw new Error(it("Unable to perform search!"));n(e.format(t))}))}))}},{key:"geocode",value:function(t,e){this.clear(),this.xhr=ut.a.ajax({type:"GET",crossDomain:!0,url:W.nominatim+"/search/",data:{q:t,countrycodes:$("app/nominatimCountries")||"",format:"json"},dataType:"json",context:this}).done(e).fail((function(t){e(null),t.statusText}))}},{key:"format",value:function(t){var e=this;return t.map((function(t){var n=t.boundingbox&&t.boundingbox.map((function(t){return Number(t)}));return e.toGeoJSON({provider:e.title,id:t.place_id,name:t.display_name,srid:"EPSG:4326",coords:[Number(t.lon),Number(t.lat)],bbox:[n[2],n[0],n[3],n[1]]})}))}}])&&na(n.prototype,o),r&&na(n,r),i}(nn);n(399);function sa(t){return(sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function la(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ua(t,e){return!e||"object"!==sa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fa(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function pa(t){return(pa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function da(t,e){return(da=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ha=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&da(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=pa(e);if(fa()){var o=pa(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return ua(this,t)});function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this)).title="Features",t.layers=$("map/layer/layers"),t.geojson=new Vt.a({featureProjection:$("map/projection"),dataProjection:"EPSG:4326"}),t}return n=i,(o=[{key:"test",value:function(t){return t.length>=3}},{key:"find",value:function(t){var e=this;return new Promise((function(n,o){if(!e.test(t))throw new Error(it("Query string too short, aborting!"));e.searchFeatures(t,(function(t){n(t)}))}))}},{key:"searchFeatures",value:function(t,e){var n=this,o=this.getAllFeatures().filter((function(e){var n=e.get("name");return n&&n.search(new RegExp(t,"i"))>-1})).map((function(t){return n.format(t)}));"function"==typeof e&&e(o)}},{key:"getAllFeatures",value:function(){var t=[];return this.layers.forEach((function(e){e instanceof Gt.a&&(t=t.concat(e.getSource().getFeatures()))})),t}},{key:"format",value:function(t){var e=this.geojson.writeFeatureObject(t);return e.properties.provider=this.title,e}}])&&la(n.prototype,o),r&&la(n,r),i}(nn);n(400);function ya(t){return(ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ma(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ga(t,e,n){return(ga="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=wa(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function ba(t,e){return!e||"object"!==ya(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function va(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function wa(t){return(wa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ka(t,e){return(ka=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Aa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ka(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=wa(e);if(va()){var o=wa(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return ba(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('\n      <div id="search" class="float-right">\n        <button class="btn btn-secondary d-inline-block d-sm-none toggle" aria-label="'.concat(it("Search"),'">\n          <i class="fa fa-search"></i>\n        </button>\n        <div class="d-none d-sm-block">\n          <div class="input-group">\n            <input type="text" class="form-control" placeholder="').concat(it("Search"),'">\n            <div class="input-group-append fill-width">\n              <button class="btn btn-secondary dropdown-toggle no-caret"\n                type="button"\n                data-toggle="dropdown"\n                aria-expanded="true"\n                disabled>\n                <i class="fa fa-search"></i>\n              </button>\n              <ul class="dropdown-menu dropdown-menu-right scrollable-menu" role="menu"></ul>\n            </span>\n          </div>\n        </div>\n      </div>\n    ')),e.state={results:[],open:!1,query:null},e.providers={coordinates:new ta,features:new ha,nominatim:new ca},e.format=new Vt.a({featureProjection:$("map/projection")}),e.create(),e}return n=i,(o=[{key:"create",value:function(){var t=this;ga(wa(i.prototype),"create",this).call(this),this.target&&this.el&&(this.resultsEl=this.el.find("ul"),this.el.on("click",".toggle",(function(e){t.el.find(">.toggle").toggleClass("d-none d-inline-block"),t.el.find(">div").toggleClass("d-none")})),this.el.find(".dropdown-toggle").on("shown.bs.dropdown",(function(){t.state.open=!0})).on("hidden.bs.dropdown",(function(){t.state.open=!1})).on("click",(function(e){var n=t.el.find("input").val().trim();t.query!==n&&(t.clear(),t.search(n))})),this.el.find("input").on("keyup",(function(e){var n=ut()(e.target).val().trim();t.el.find(".dropdown-toggle").prop("disabled",n.length<1),n.length?13===e.keyCode&&(t.clear(),t.state.open=!0,t.search(n)):t.clear()})),this.resultsEl.on("click",".clear",(function(e){t.clear(),t.el.find("input").val("").trigger("keyup")})),this.resultsEl.on("click","a",(function(e){e.preventDefault(),e.stopPropagation();var n=$("map"),o=ut()(e.currentTarget).attr("data-id"),r=t.state.results.filter((function(t){return String(o)===String(t.id)}))[0];if(r.bbox){var a=Object(Bt.t)(r.bbox,"EPSG:4326",$("map/projection"));n.getView().fit(a,{padding:[50,50,50,50],maxZoom:17,duration:500})}else n.getView().animate({center:Object(Bt.g)(r.geometry.coordinates),zoom:15,duration:500})})))}},{key:"render",value:function(){var t=null,e=[];this.state.results.forEach((function(n){t!==n.properties.provider&&(e.push('<li class="dropdown-header">'.concat(it(n.properties.provider),"</li>")),t=n.properties.provider),e.push('\n        <li>\n          <a href="#" class="dropdown-item"\n            data-id="'.concat(n.id,'" data-provider="').concat(t,'">\n            <i class="fa fa-map-marker-alt"></i>\n            ').concat(n.properties.name,"\n          </a>\n        </li>"))})),e.length||e.push('\n        <li class="dropdown-item">\n          <i class="fa fa-frown"></i>\n          '.concat(it("No result"),"\n        </li>")),e.push('\n      <div class="tools text-right">\n        <button class="btn btn-link clear">\n          <i class="fa fa-backspace"></i>\n        </button>\n        <button class="btn btn-link toggle d-inline-block d-sm-none" aria-label="'.concat(it("Close"),'">\n          <i class="fa fa-times"></i>\n        </button>\n      </div>')),this.el.find(".dropdown-toggle").dropdown("update"),this.resultsEl&&(this.resultsEl.html(e.join("")),this.state.open&&(this.el.find(".dropdown-toggle").dropdown("toggle"),this.state.open=!1)),this.handleFeatures()}},{key:"clear",value:function(){var t=this;Object.keys(this.providers).forEach((function(e){t.providers[e].clear()})),this.state.results=[],this.query=null,this.render()}},{key:"search",value:function(t){var e=this,n=$("app/debug");this.query=t;var o=0,r=!1;this.searchStart(),Object.keys(this.providers).some((function(a){o++,e.providers[a].find(t).then((function(i){r||(e.state.results=e.state.results.concat(i)),"coordinates"===a&&i.length&&(r=!0,o=1),n&&console.debug("Search.search: query: ".concat(t,", results: ").concat(i.length))})).catch((function(t){n&&console.error("Search.search: error: ".concat(JSON.stringify(t)))})).finally((function(){0==--o&&(e.render(),e.searchEnd())}))}))}},{key:"searchStart",value:function(){this.el.find(".dropdown-toggle i").removeClass("fa-search").addClass("fa-spinner fa-pulse")}},{key:"searchEnd",value:function(){this.el.find(".dropdown-toggle i").removeClass("fa-spinner fa-pulse").addClass("fa-search")}},{key:"handleFeatures",value:function(){if(this.state.results&&this.state.results.length){var t=this.createLayer(this.query,this.state.results);$("map/layer/overlays").push(t)}}},{key:"createLayer",value:function(t,e){return we({type:"FeatureCollection",id:S(),title:"".concat(it("Search"),": ").concat(t),features:e,zIndex:50,style:{stroke:{color:"#000000",width:2},fill:{color:O("#fff",.5)},circle:{stroke:{color:"#000000"},fill:{color:O("#fff",.5)},radius:5}}})}}])&&ma(n.prototype,o),r&&ma(n,r),i}(ot);n(401);function Sa(t){return(Sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oa(t,e){return!e||"object"!==Sa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ja(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function xa(t){return(xa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ra(t,e){return(Ra=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ea=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ra(t,e)}(o,t);var e,n=(e=o,function(){var t,n=xa(e);if(ja()){var o=xa(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Oa(this,t)});function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=n.call(this,t)).el=ut()('<header id="header" class="panel-bar"></header>'),e.create(),e.components={geocache:new Co(e.el),lyrmngr:$("app/layerManager")&&new Hr(e.el),search:$("app/searchEnabled")&&new Aa(e.el)},e}return o}(ot);n(402);function Pa(t){return(Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ca(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _a(t,e){return!e||"object"!==Pa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ta(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Ma(t){return(Ma=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function La(t,e){return(La=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&La(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Ma(e);if(Ta()){var o=Ma(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return _a(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).id="info-tab",e.icon="fa fa-info-circle",e.el=ut()('\n      <div\n        class="tab-pane fade '.concat(e.id===$("app/settingsTabOpen")?"show active":"",'"\n        id="').concat(e.id,'"\n        role="tabpanel">\n      </div>\n    ')),e.create(),e}return n=i,(o=[{key:"render",value:function(){this.el.html('\n      <h5>\n        Geop\n        <i class="text-muted small">'.concat(window.geop.version,'</i>\n      </h5>\n      <span class="attribution small">\n        <a href="http://openstreetmap.org" >OSM</a> |\n        <a href="http://www.maaamet.ee" >maa-amet</a> |\n        <a href="http://sookoll.ee" >oo</a>\n      </span>\n      <ul>\n        <li>').concat(it("Geop is progressive web application with partial offline support."),"</li>\n        <li>").concat(it("Install it to Your home screen."),"</li>\n        <li>").concat(it("Add any GPX, GeoJSON, KML files or WMS layers to map from layers menu or drag and drop file."),"</li>\n        <li>").concat(it("App will recognize if geocaches are added to map."),"</li>\n        <li>").concat(it("Filter and search caches on map."),"</li>\n        <li>").concat(it("Search and display coordinates in WGS, L-Est, UTM and MGRS system."),"</li>\n        <li>").concat(it("Find streetview link and measure tools from context menu."),"</li>\n        <li>").concat(it("Add caches and map objects to geotrip. Reorder geotrip."),"</li>\n        <li>").concat(it("Navigate to cache with two tracking mode"),"</li>\n        <li>").concat(it("Driving directions between points or from your current location"),"</li>\n        <li>").concat(it("Share snapshot of app state via link or QR-code. Download geotrip as GPX-file."),"</li>\n      </ul>\n      <h5>").concat(it("Search coordinates"),"</h5>\n      <ul>\n        <li>WGS'84: lat, lon; kk.nnnn; kk° mm.nnn; kk° mm' ss''</li>\n        <li>L-EST'97: x, y; y, x</li>\n        <li>UTM zone 34N: x, y; y, x</li>\n        <li>UTM zone 35N: x, y; y, x</li>\n        <li>MGRS</li>\n      </ul>\n    "))}}])&&Ca(n.prototype,o),r&&Ca(n,r),i}(ot),Ga=n(307),Da=n.n(Ga);n(403);function Na(t){return(Na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ua(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ia(t,e){return!e||"object"!==Na(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wa(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function qa(t){return(qa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function za(t,e){return(za=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Va=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&za(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=qa(e);if(Wa()){var o=qa(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Ia(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).id="settings-tab",e.icon="fa fa-cog",e.el=ut()('\n      <div\n        class="tab-pane fade '.concat(e.id===$("app/settingsTabOpen")?"show active":"",'"\n        id="').concat(e.id,'"\n        role="tabpanel">\n      </div>\n    ')),e.create(),e}return n=i,(o=[{key:"create",value:function(){this.target&&this.el&&(this.target.append(this.el),this.render())}},{key:"render",value:function(){var t,e=this,n=void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile;this.el.html('\n      <div class="install mb-3">\n        <button\n          id="install"\n          class="btn btn-danger btn-lg btn-block">\n          <i class="fa fa-plus"></i>\n          '.concat(it("Install app to home screen"),'\n        </button>\n        <small class="form-text text-muted">\n          ').concat(it("Install web app to your home screen."),"\n        </small>\n      </div>\n      <h5>").concat(it("Language"),'</h5>\n      <div class="btn-group" role="group">\n        ').concat(Object.keys(rt.texts).map((function(t){return'\n            <button type="button"\n              class="btn btn-outline-primary set-locale-btn '.concat(rt.locale===t?"active":"",'"\n              data-locale="').concat(t,'">\n              ').concat(t,"\n            </button>")})).join(""),'\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(it("Change language. App will reload after change!"),"\n      </small>\n      <h5>").concat(it("Keep awake"),'</h5>\n      <div class="btn-group-toggle" data-toggle="buttons">\n        <label class="btn btn-outline-primary">\n          <input type="checkbox" id="settings-awake" autocomplete="off">\n          <i class="fa fa-mobile-alt"></i>\n          <span>').concat(it("Off"),'</span>\n        </label>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(it("Keep screen on. Use with caution, might train device battery!"),"\n      </small>\n      <h5>").concat(it("Account"),'</h5>\n      <div class="form-group">\n        <input type="text"\n          class="form-control"\n          id="settings-account"\n          placeholder="').concat(it("Username"),'"\n          value="').concat($("app/account")||"",'"/>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(it("Enter geopeitus.ee or geocaching.com username. App will reload after change!"),"\n      </small>\n      <h5>").concat(it("Search"),'</h5>\n      <div class="form-group">\n        <input type="text"\n          class="form-control"\n          id="settings-search"\n          placeholder="').concat(it("Country codes"),'"\n          value="').concat($("app/nominatimCountries")||"",'"/>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(it("Limit address search with comma separated list of country codes (ee,fi - Estonia, Finland). Empty means no limit."),"\n      </small>\n      <h5>").concat(it("Routing"),'</h5>\n      <div class="form-group">\n        <select\n          class="form-control"\n          id="settings-routing">\n          <option value="" ').concat(""===n?"selected":"",">").concat(it("Disabled"),'</option>\n          <option value="driving" ').concat("driving"===n?"selected":"",">").concat(it("Driving"),'</option>\n          <option value="hiking" ').concat("hiking"===n?"selected":"",">").concat(it("Hiking"),'</option>\n        </select>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(it("Select routing profile or disable routing"),'\n      </small>\n      <div class="btn-group" role="group">\n        <button type="button"\n          class="btn btn-outline-primary set-route-btn ').concat($("routing/infoFromRoute")?"active":"",'"\n          data-share="on">\n          ').concat(it("On"),'\n        </button>\n        <button type="button"\n          class="btn btn-outline-primary set-route-btn ').concat($("routing/infoFromRoute")?"":"active",'"\n          data-share="off">\n          ').concat(it("Off"),'\n        </button>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(it("Show distance and duration along route, not from beginning to end"),"\n      </small>\n      <h5>").concat(it("Share only geotrip features"),'</h5>\n      <div class="btn-group" role="group">\n        <button type="button"\n          class="btn btn-outline-primary set-share-btn ').concat($("app/shareOnlyTripFeatures")?"active":"",'"\n          data-share="on">\n          ').concat(it("On"),'\n        </button>\n        <button type="button"\n          class="btn btn-outline-primary set-share-btn ').concat($("app/shareOnlyTripFeatures")?"":"active",'"\n          data-share="off">\n          ').concat(it("Off"),'\n        </button>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(it("Share only features added to geotrip."),"<br/>\n        ").concat(it("NB! Turning this off and sharing bookmark will store possibly big amount of data in service. It might fail. Use with caution!"),"\n      </small>\n      <h5>").concat(it("Reset app"),'</h5>\n      <div>\n        <button\n          id="settings-reset"\n          class="btn btn-warning">\n          <i class="fa fa-sync-alt"></i>\n          ').concat(it("Reset"),'\n        </button>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(it("Reset app to default. App will reload!"),"\n      </small>\n      <h5>").concat(it("Debug"),'</h5>\n      <div class="btn-group" role="group">\n        <button type="button"\n          class="btn btn-outline-primary set-debug-btn ').concat($("app/debug")?"active":"",'"\n          data-debug="on">\n          ').concat(it("On"),'\n        </button>\n        <button type="button"\n          class="btn btn-outline-primary set-debug-btn ').concat($("app/debug")?"":"active",'"\n          data-debug="off">\n          ').concat(it("Off"),'\n        </button>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(it("Debug mode. Will write debug logs into file. App will reload after change!"),"\n      </small>\n      ").concat($("app/debug")?'\n      <div class="mb-3">\n        <button\n          id="download-log"\n          class="btn btn-danger">\n          <i class="fa fa-download"></i>\n          '.concat(it("Download debug log"),'\n        </button>\n        <input type="file" style="display:none;" />\n      </div>\n      '):"","\n    ")),this.el.on("click","button.set-locale-btn",(function(t){at(ut()(t.currentTarget).data("locale"),rt.texts),e.el.find("button.set-locale-btn").removeClass("active"),ut()(t.currentTarget).addClass("active"),st("warning",it("Language changed, page will reload!"),(function(){Qc()})),$("app/debug")&&console.debug("Config.render: Locale changed to ".concat(ut()(t.currentTarget).data("locale")))})),this.el.on("change","#settings-awake",(function(t){t.target.checked?(document.addEventListener("click",m,!1),ut()(t.target).closest("label").find("span").html(it("On"))):(p.disable(),ut()(t.target).closest("label").find("span").html(it("Off"))),ut()(t.target).closest("label").toggleClass("btn-outline-secondary btn-success")})),this.el.on("blur","#settings-account",(function(t){t.target.value.trim()!==$("app/account")&&(Q("app/account",t.target.value.trim(),!0),st("warning",it("Account changed, page will reload!"),(function(){Qc()})),$("app/debug")&&console.debug("Config.render: Account changed to ".concat(t.target.value.trim())))})),this.el.on("blur","#settings-search",(function(t){t.target.value.trim()!==$("app/nominatimCountries")&&(Q("app/nominatimCountries",t.target.value.trim(),!0),$("app/debug")&&console.debug("Config.render: Search limit changed to ".concat(t.target.value)))})),this.el.on("change","#settings-routing",(function(t){var e=void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile;t.target.value.trim()!==e&&(Q("routing/profile",t.target.value.trim(),!0),$("app/debug")&&console.debug("Config.render: Routing changed to ".concat(t.target.value)))})),this.el.on("click","button.set-route-btn",(function(t){Q("routing/infoFromRoute","on"===ut()(t.currentTarget).data("share"),!0),e.el.find("button.set-route-btn").removeClass("active"),ut()(t.currentTarget).addClass("active")})),this.el.on("click","button.set-share-btn",(function(t){Q("app/shareOnlyTripFeatures","on"===ut()(t.currentTarget).data("share"),!0),e.el.find("button.set-share-btn").removeClass("active"),ut()(t.currentTarget).addClass("active")})),this.el.on("click","#settings-reset",(function(t){et(),st("warning",it("App resetted, page will reload!"),(function(){G(null),Qc()})),$("app/debug")&&console.debug("Config.render: App resetted")})),this.el.on("click","button.set-debug-btn",(function(t){Q("app/debug","on"===ut()(t.currentTarget).data("debug"),!0),e.el.find("button.set-debug-btn").removeClass("active"),ut()(t.currentTarget).addClass("active"),st("warning",it("Debug changed, app will reload!"),(function(){Qc()})),$("app/debug")&&console.debug("Config.render: Debug changed to ".concat(ut()(t.currentTarget).data("debug")))})),this.el.on("click","#download-log",(function(t){var e=d,n=new window.Blob([e.join("\n")],{type:"text/plain;charset=utf-8"});Da()(n,$("app/debugFile"))})),window.addEventListener("beforeinstallprompt",(function(n){n.preventDefault(),t=n,e.el.find(".install").show()})),this.el.on("click","#install",(function(n){e.el.find(".install").hide(),t.prompt(),t.userChoice.then((function(e){"accepted"===e.outcome?$("app/debug")&&console.debug("Config.render: User accepted the A2HS prompt"):$("app/debug")&&console.debug("Config.render: User dismissed the A2HS prompt"),t=null}))}))}}])&&Ua(n.prototype,o),r&&Ua(n,r),i}(ot);function Ba(t){return(Ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ha(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ja(t,e){return!e||"object"!==Ba(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ya(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Za(t){return(Za=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xa(t,e){return(Xa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ka=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xa(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Za(e);if(Ya()){var o=Za(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Ja(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('<div class="btn-group float-left" id="sidebar-open"></div>'),e.create(),e.sidebar=new Ie({target:ut()("#geop"),trigger:e.el.find("button"),position:"left",components:{Info:Fa,Config:Va},activeComponent:$("app/settingsTabOpen"),shadow:!0}),e}return n=i,(o=[{key:"create",value:function(){this.target&&this.el&&(this.target.append(this.el),ut()("body").append(this.sidebar).append(this.shadow),this.render())}},{key:"render",value:function(){this.el.html('\n      <button type="button"\n        class="btn btn-secondary">\n        <i class="fa fa-ellipsis-h"></i>\n      </button>\n    ')}}])&&Ha(n.prototype,o),r&&Ha(n,r),i}(ot),Qa=n(189);n(404);function $a(t){return($a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ti(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ei(t,e){return!e||"object"!==$a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ni(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function oi(t){return(oi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ri(t,e){return(ri=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ai=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ri(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=oi(e);if(ni()){var o=oi(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return ei(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('<span class="float-right" id="scale-line"></span>'),e.state={control:null},e.create(),e}return n=i,(o=[{key:"render",value:function(){var t=this;if(!this.state.control){this.state.control=new Qa.a({className:"ol-scale-line",target:this.el[0]});var e=$("map");e?e.addControl(this.state.control):$("map/que").push((function(e){e.addControl(t.state.control)}))}}}])&&ti(n.prototype,o),r&&ti(n,r),i}(ot);function ii(t){return(ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ci(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function si(t,e){return!e||"object"!==ii(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function li(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function ui(t){return(ui=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fi(t,e){return(fi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fi(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=ui(e);if(li()){var o=ui(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return si(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('<div class="btn-group float-right" id="fullscreen"></div>'),e.state={active:!1},e.create(),e}return n=i,(o=[{key:"render",value:function(){var t=this;this.el.html('\n      <button type="button"\n        title="'.concat(it("Toggle fullscreen"),'"\n        disabled\n        class="btn btn-secondary">\n        <i class="fa fa-expand-arrows-alt"></i>\n      </button>\n    ')),this.test()&&(this.el.find("button").prop("disabled",!1),this.el.on("click","button",(function(e){e.preventDefault(),t.toggle()})),ut()(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",(function(e){t.toggleState()})))}},{key:"test",value:function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled)}},{key:"toggle",value:function(){this.state.active?this.off():this.on()}},{key:"toggleState",value:function(){document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?(this.state.active=!0,this.el.find("button").addClass("active")):(this.state.active=!1,this.el.find("button").removeClass("active"))}},{key:"on",value:function(){document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(window.Element.ALLOW_KEYBOARD_INPUT)}},{key:"off",value:function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}}])&&ci(n.prototype,o),r&&ci(n,r),i}(ot);n(405);function di(t){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hi(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function yi(t,e){return!e||"object"!==di(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function gi(t){return(gi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bi(t,e){return(bi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bi(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=gi(e);if(mi()){var o=gi(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return yi(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('<div class="text-center d-none" id="navigation">\n      <i class="fas fa-location-arrow"></i>\n      <span></span>\n      <button class="btn btn-link">\n        <i class="fas fa-times"></i>\n      </button>\n    </div>'),e.state={active:!1,hide:t.find("#mouse-position, #scale-line, #bookmark"),to:null,route:new lo.a(new so.a([]))},e.state.route.setStyle(oe({stroke:{color:"rgba(0, 133, 203, 0.6)",width:1}})),e.create(),tt("navigate/to",(function(t){t?e.activate(t):e.deactivate()})),tt("map/geolocation/position",(function(){e.state.active&&e.update()})),e}return n=i,(o=[{key:"render",value:function(){var t=this;this.el.on("click","button",(function(e){t.deactivate()}))}},{key:"update",value:function(){var t=$("map/geolocation/position"),e=this.state.to.getGeometry().getCoordinates(),n=C(t,e),o=Object(c.b)(Object(Bt.p)(t),Object(Bt.p)(e));this.el.find("span").html("\n      ".concat(j(null,o,[0,1]),"\n      <i>&middot;</i> ").concat(Math.round(n),"&deg;\n    ")),this.state.route.getGeometry().setCoordinates([t,e])}},{key:"activate",value:function(t){this.state.hide.attr("style","display: none !important"),this.el.removeClass("d-none"),this.state.to=t,oo().getSource().addFeature(this.state.route),this.state.active=!0,this.update()}},{key:"deactivate",value:function(){this.state.hide.removeAttr("style"),this.el.addClass("d-none"),this.el.find("span").html(""),oo().getSource().clear(),this.state.route.getGeometry().setCoordinates([]),Q("routing/stops",[]),this.state.active=!1}}])&&hi(n.prototype,o),r&&hi(n,r),i}(ot);n(406);function wi(t){return(wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ki(t,e){return!e||"object"!==wi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ai(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Si(t){return(Si=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oi(t,e){return(Oi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ji=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oi(t,e)}(o,t);var e,n=(e=o,function(){var t,n=Si(e);if(Ai()){var o=Si(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return ki(this,t)});function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=n.call(this,t)).el=ut()('<footer id="statusbar" class="panel-bar"></footer>'),e.create(),e.components={settings:$("app/settings")&&new Ka(e.el),fullscreen:$("app/fullScreen")&&new pi(e.el),bookmark:$("app/shareState")&&new Pt(e.el),scaleline:$("app/scaleLine")&&new ai(e.el),mouseposition:$("app/mousePosition")&&new zn(e.el),navigation:$("app/routing")&&new vi(e.el)},e}return o}(ot);function xi(t){return(xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ri(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ei(t,e){return!e||"object"!==xi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Ci(t){return(Ci=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _i(t,e){return(_i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ti=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_i(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Ci(e);if(Pi()){var o=Ci(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Ei(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).elPlus=ut()('\n      <button class="btn btn-link" title="'.concat(it("Zoom in"),'"><i class="fa fa-plus"></i></button>\n    ')),e.elMinus=ut()('\n      <button class="btn btn-link" title="'.concat(it("Zoom out"),'"><i class="fa fa-minus"></i></button>\n    ')),e.create(),e}return n=i,(o=[{key:"create",value:function(){var t=this;this.target&&this.elPlus&&(this.target.append(this.elPlus),this.elPlus.on("click",(function(e){var n=$("map").getView(),o=n.getZoom()+1;t.zoomTo(n,o)}))),this.target&&this.elMinus&&(this.target.append(this.elMinus),this.elMinus.on("click",(function(e){var n=$("map").getView(),o=n.getZoom()-1;t.zoomTo(n,o)})))}},{key:"zoomTo",value:function(t,e){t.animate({zoom:e,duration:250,anchor:$("map/anchor")&&$("map/anchor").getCoordinates()})}}])&&Ri(n.prototype,o),r&&Ri(n,r),i}(ot);n(407);function Mi(t){return(Mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Li(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Fi(t,e){return!e||"object"!==Mi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Di(t){return(Di=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ni(t,e){return(Ni=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ui=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ni(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Di(e);if(Gi()){var o=Di(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Fi(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('\n      <button id="compass" class="btn btn-link" title="'.concat(it("North up!"),'">\n        <i class="icon"></i>\n      </button>\n    ')),e.state={removed:!0},$("map/que").push((function(t){var n=t.getView();e.rotateIcon(n),n.on("change:rotation",(function(t){e.rotateIcon(n)}))})),e}return n=i,(o=[{key:"render",value:function(){this.el.on("click",(function(t){$("map").getView().animate({rotation:0,duration:250,anchor:$("map/anchor")&&$("map/anchor").getCoordinates()})}))}},{key:"rotateIcon",value:function(t){var e=this,n=t.getRotation();0!==n&&this.state.removed?(this.create(),this.state.removed=!1):0===n&&this.el.fadeOut(400,(function(){e.el.remove(),e.el.show(),e.state.removed=!0})),this.el.find(".icon").css({"-webkit-transform":"rotate(".concat(n,"rad)"),"-moz-transform":"rotate(".concat(n,"rad)"),transform:"rotate(".concat(n,"rad)")})}}])&&Li(n.prototype,o),r&&Li(n,r),i}(ot),Ii=n(308);n(408);function Wi(t){return(Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qi(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function zi(t,e){return!e||"object"!==Wi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Bi(t){return(Bi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hi(t,e){return(Hi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ji=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hi(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Bi(e);if(Vi()){var o=Bi(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return zi(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('\n      <button id="geolocation" class="btn btn-link" disabled title="'.concat(it("My location"),'">\n        <i class="fa fa-location-arrow"></i>\n      </button>\n    ')),e.state={active:0,status:["","active","tracking"],track:new lo.a(new so.a([])),position:new lo.a({id:"position",radius:0,geometry:new co.a([])}),zoom:16,layer:e.createLayer(),locator:new Ii.a({projection:$("map/projection"),trackingOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:3e4}}),isFirst:!1,lastPosition:null,lastHeading:null,minAccuracy:100},e.handlers={updateView:function(t){e.updateView(t)},disableTracking:function(t){e.disableTracking()}},e.test()&&(window.geopLocator=e.state.locator,e.create(),e.init()),e}return n=i,(o=[{key:"render",value:function(){var t=this;this.el.prop("disabled",!1),this.el.on("click",(function(e){t.state.active=t.state.active+1>=t.state.status.length?0:t.state.active+1,0===t.state.active?(t.disable(),ut()(e.currentTarget).removeClass(t.state.status.join(" "))):(t.enable(),ut()(e.currentTarget).addClass(t.state.status[t.state.active]))}))}},{key:"test",value:function(){return!!navigator.geolocation}},{key:"init",value:function(){var t=this;this.state.layer.getSource().addFeatures([this.state.track,this.state.position]),this.state.locator.on("change:position",(function(e){t.positionChanged(e)})),this.state.locator.on("change:heading",(function(e){t.headingChanged(e)})),this.state.locator.on("change:accuracy",(function(e){t.accuracyChanged(e)})),this.state.locator.on("change:speed",(function(e){t.speedChanged(e)})),this.state.locator.on("error",(function(e){t.error(e)}))}},{key:"error",value:function(t){this.disable(),this.el.removeClass(this.state.status.join(" "));var e=it("Unable to find location.");switch(t.code){case t.PERMISSION_DENIED:e=it("User denied the request for Geolocation.");break;case t.POSITION_UNAVAILABLE:e=it("Location information is unavailable.");break;case t.TIMEOUT:e=it("The request to get user location timed out.");break;case t.UNKNOWN_ERROR:e=it("An unknown error occurred.")}st("error",e),$("app/debug")&&console.error("geolocation error",JSON.stringify(t))}},{key:"enable",value:function(){var t=$("map");"tracking"===this.state.status[this.state.active]?(Q("map/anchor",this.state.position.getGeometry()),this.updateView(),t.on("pointerdrag",this.handlers.disableTracking),t.render()):(this.state.isFirst=!0,this.searchStart(),this.state.layer.setMap(t),this.state.locator.setTracking(!0)),Q("map/geolocation",!0)}},{key:"disable",value:function(){this.disableTracking(),this.searchEnd(),this.state.locator.setTracking(!1),this.state.position.getGeometry().setCoordinates([]),this.state.track.getGeometry().setCoordinates([]),this.state.layer.setMap(null),this.state.lastPosition=null,this.state.lastHeading=null,this.state.active=this.state.status.indexOf(""),Q("map/geolocation",!1)}},{key:"disableTracking",value:function(){$("map").un("pointerdrag",this.handlers.disableTracking),Q("map/anchor",null),this.el.removeClass(this.state.status[this.state.active]),this.state.active=this.state.status.indexOf("active")}},{key:"searchStart",value:function(){this.el.find("i").removeClass("fa-location-arrow").addClass("fa-spinner fa-pulse")}},{key:"searchEnd",value:function(){this.el.find("i").removeClass("fa-spinner fa-pulse").addClass("fa-location-arrow")}},{key:"isValid",value:function(t){return t<=this.state.minAccuracy}},{key:"positionChanged",value:function(t){var e=this.state.locator.getPosition();if(e){if(this.state.lastPosition=e,this.state.position.getGeometry().setCoordinates(e),this.isValid(this.state.locator.getAccuracy())&&(this.state.track.getGeometry().appendCoordinate(e),!0===this.state.isFirst)){var n=$("map").getView();n.setCenter(e),n.setZoom(this.state.zoom),this.state.isFirst=!1,this.searchEnd()}Q("map/geolocation/position",e)}this.updateView()}},{key:"headingChanged",value:function(t){var e=this.state.locator.getHeading();void 0!==e&&(this.state.lastHeading=e,this.state.position.set("heading",e)),this.updateView()}},{key:"accuracyChanged",value:function(t){var e=this.state.locator.getAccuracy();void 0!==e&&this.state.position.set("radius",e),this.updateView()}},{key:"speedChanged",value:function(t){var e=this.state.locator.getSpeed()||0;this.state.position.set("speed",e),this.updateView()}},{key:"getCenterWithHeading",value:function(t,e,n){var o=$("map").getSize();return[t[0]-Math.sin(e)*o[1]*n*1/4,t[1]+Math.cos(e)*o[1]*n*1/4]}},{key:"updateView",value:function(){if($("app/debug")&&console.debug("updateView: ".concat(JSON.stringify(this.state.lastPosition),"; heading: ").concat(this.state.lastHeading,"; accuracy: ").concat(this.state.locator.getAccuracy())),"tracking"===this.state.status[this.state.active]&&this.isValid(this.state.locator.getAccuracy())){var t=$("map").getView();this.state.lastPosition&&this.state.lastHeading?(t.setCenter(this.getCenterWithHeading(this.state.lastPosition,-this.state.lastHeading,t.getResolution())),t.setRotation(-this.state.lastHeading)):this.state.lastPosition?t.setCenter(this.getCenterWithHeading(this.state.lastPosition,t.getRotation(),t.getResolution())):t.setRotation(-this.state.lastHeading)}}},{key:"createLayer",value:function(){var t=oe({icon:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAyCAMAAABvV9spAAAABGdBTUEAALGPC/xhBQAAACBjSFJN AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABUFBMVEUAAABpaWkAAAAAAAAA AAAAAAAAAABpaWkAAAAAAAAAAAAAAAAAAAA1NTUAAAAAAAAAAAAAAAAAAAAPDw+4uLje3t709PQP Dw8AAAAAAAAAAAAAAAAAAAAAAAB8fHzv7+98fHwAAAAAAAAAAADAwMD+/v4AAAAAAAAAAACJiYkA AAAmJiby8vLLy8vl5eUAAAD29vZWVlYAAAA5OTn+/v4AAADz8/MAAAAAAADh4eEAAAAAAAC7u7sA AADo6OgAAABbW1v6+voAAAAAAACdnZ339/c9PT3d3d0AAAAAAAAAAACRkZHHx8fh4eH09PQAAAAA AAAAAAAAAAD////6/f7g8Plqt+A0ndUHh8uZzuoNis0AhMqSyujb7vgKicxhs94pmNPy+fwChcr5 /P42ntV0vOLv9/sbkdC43fAEhsvN5/UsmdP5/P2i0uxsuOA5n9bwio4hAAAAU3RSTlMAIx0gEhQT JgIGMzpBTS0mAxYqQpTE6D8pGwQOGC5h3F0kDw2K+yUKI10fNeCTwxnrQRo6/iziFSe6ESF/K8gI RvIFC2XqO7MBBx5dk7ziEBcoCTVzjyoAAAABYktHRFN6Zx0GAAAACXBIWXMAAAFiAAABYgFfJ9BT AAAAB3RJTUUH4gwECRg4eAJxNwAAAYNJREFUOMvt0ls3AlEUwPFNEzO6mIkyU7nUSIN0pUE0zKCL W7VDhO6Rku//5iQ0H8BalrX8H85Z+/dwHvY6AP/9TGPjBsponJgcTjTQzOCeMpnNFovZZJ0eTAwN LGHONjNrdyA67LNzvECYBSe43PMLi4hYLJJjccnjBYIguvhlH15d35RKN9dX6FteMZJ3/EZp1Ye3 d+WP7m7Rt7pG+cElrAfwvvzdPQbWBRdQ0gY+PI748QE3JAo4PoiVsq4KBnkOQtYwVvVcxbA1BEIE a3U912sYESAa22yU9FxqbMai4N6KY1PPTYxvuUHe3sGWnlu4sy3DbmIP208jfWrjXmIXxNB+Ep87 X9p5xuR+SASFMhwc4kt3qN0XPDwwUAqomiwdHWPvtf/21n/t4fGRJGsq2bfISScp/Cx1InEi2Xea zYhylj89O7+4OD875bOymGHTQJzRLnNZT95my3uyuUuNGejAVUXzUjLHyZRXU9ShEqdZJ6MU/P6C wjhZOv3bv/Bv9Q7DpHOEPfXX5AAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOC0xMi0wNFQxNjoyNDo1 Ni0wNzowMAoLzxUAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTgtMTItMDRUMTY6MjQ6NTYtMDc6MDB7 VnepAAAAAElFTkSuQmCC"}}),e=oe({icon:{rotation:0,rotateWithView:!0,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAyCAMAAABvV9spAAAABGdBTUEAALGPC/xhBQAAACBjSFJN AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABxVBMVEUAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADn5+fn5+cAAAAAAACioqIAAAAAAAAAAAAAAADt7u7m 8vkAAAAAAAAAAACxsbEAAAAcHBzz9PXT6vUAAAAAAADFxcUAAAAAAAAAAABGRkb4+fq63vEAAAAA AADX19f+//90dHT8/f3J5PMAAAAAAADo6Ojs7e2qqqr8/f3JyclRUVEAAADw8PLq6+tpaWkAAAAA AAAAAADx8fLMzMy9vb0AAAAAAAAAAAA1NTW6urrLy8sAAAAAAAAAAAAAAAAPDw+4uLje3t709PQA AAAAAAB8fHzv7+8AAADAwMD+/v4AAACJiYkAAAAmJiby8vLLy8sAAADl5eX29vZWVlYAAAA5OTn+ /v7z8/Ph4eG7u7sAAADo6OhbW1v6+vqdnZ339/c9PT3d3d2RkZHHx8fh4eH09PQAAAAAAAD///9h s94ChcpGptkAhMovm9Sf0essmdN8wOTA4PL6/f7g8Plqt+A0ndUHh8uZzuoNis2Syujb7vgKicwp mNPy+fz5/P42ntV0vOLv9/sbkdC43fAEhsvN5/X5/P2i0uxsuOA5n9YUwW0GAAAAdXRSTlMAAQID BAYICgsRFAwdop8TIF0HDxws1v0FFyd8Hzfp/RgplQkSIUL1/g0qqv5N/P4VJLzgV/ulW0XBzlxA Pj3EdHg5P0FNd3AOGSYzQpTE6B4uYdwtivsjXRs14JMWw+tBGjr+4rp/K8hG8mXqO7Ndk7ziEChI 22u6AAAAAWJLR0R1qGqY+wAAAAlwSFlzAAABYgAAAWIBXyfQUwAAAAd0SU1FB+IMBAUxJCFfS/cA AAJeSURBVDjL7ZPXUxpRFIfv7rIFMBFFdBc1srKoi22xx5ZEMQErsbCiYu+9HRDF2Huvf292QYTk Le/5Hu6d+ebMuWfO/C5CETAMJzQaAscwlAhGkBRNUySB/WUZrU6nZf7wGE7qdUkfPibp9CQe95iG TjakAKQYkmkNFm+RakwzpWdkpJvSjKnvbXCW4cyZEAhAppljWDxWTGmzsj/lBIM5n7KztNRbOc7q LXwubIVCW5DLW/TRcoywCra8/IKQQkF+nk2wquUYzooWe2HRtqq3iwrtFpFVhox0Li7ZCe+Wlu6G d0qKo92VmSVHGfwCKC8H5SpzSOrsyoNcBUBlVXVNTXVVJUAFpz6q6s9QW1ff0NjYUF9XC1+imhS5 r9+amp3Olhans7np+w9OWQwiSJe7ta29o7MLoKuzo72t1eIiCaSxCp6f3T0AsLenHD3dvR7BqkGk 6Ob7vLB/cHh0dHiwD94+3i2SiNbJ/V44PglFODkGb7+so5HLNzAIp6F3TmFwwOdCgjwEZ+dxfX4G Q7KA/PwwBEIJBGCY9yN37whcJOoLGOl1I98oXAYTdfASRn1obHzi6ihRH11NjI8hi2kSrhP1NUya LEgyT8FNor6BKbOEtLZpuL2L27tbmLZpkeiemYX7h5h9uIfZGbeIKMEwNw+P4agNP8L8nEGgEMtI 8sIiPD2/vL6+PD/B4oIsMayyb9EvLy3DG8tLsl9U9q0EUJQ8/Mrq2vr62uoK75HESAzVbG9wHsem 3b7p8HAbsYxjBEsxRkHy+yXByFBsLLLqvyEpK01bKVL9P+g//8Bv4afHimhpWRsAAAAldEVYdGRh dGU6Y3JlYXRlADIwMTgtMTItMDRUMTI6NDk6MzYtMDc6MDARlu33AAAAJXRFWHRkYXRlOm1vZGlm eQAyMDE4LTEyLTA0VDEyOjQ5OjM2LTA3OjAwYMtVSwAAAABJRU5ErkJggg=="}}),n=oe({stroke:{color:"rgba(0, 133, 203, 1)",width:3,lineDash:[5,5]}}),o=oe({fill:{color:"rgba(0, 0, 0, 0.05)"},geometry:function(t){if("position"===t.get("id")){var e=t.getGeometry().getCoordinates(),n=Object(Bt.p)(e);return new vo.a(e,t.get("radius")*v(n))}}});return we({type:"FeatureCollection",title:"Geolocation",zIndex:101,style:function(r){var a=[n];return"position"===r.get("id")&&(r.get("radius")>10&&r.get("radius")<5e3&&a.push(o),r.get("speed")>1?a.push(e):a.push(t),r.get("heading")&&e.getImage().setRotation(r.get("heading"))),a}})}}])&&qi(n.prototype,o),r&&qi(n,r),i}(ot);n(409);function Yi(t){return(Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zi(t,e){return!e||"object"!==Yi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Ki(t){return(Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qi(t,e){return(Qi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $i=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qi(t,e)}(o,t);var e,n=(e=o,function(){var t,n=Ki(e);if(Xi()){var o=Ki(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Zi(this,t)});function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=n.call(this,t)).el=ut()('<nav id="toolbar" class="btn-group-vertical btn-group-lg"></nav>'),e.create(),e.components={zoom:new Ti(e.el),geolocation:$("app/geoLocation")&&new Ji(e.el),compass:new Ui(e.el)},e}return o}(ot),tc=n(140);n(410);function ec(t){return(ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nc(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function oc(t,e){return!e||"object"!==ec(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function rc(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function ac(t){return(ac=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ic(t,e){return(ic=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var cc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ic(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=ac(e);if(rc()){var o=ac(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return oc(this,t)});function i(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('<div id="contextmenu-map"></div>');var n=$("map/contextmenu");return n||Q("map/contextmenu",n=[]),e.state={overlay:null,items:n},e.create(),e}return n=i,(o=[{key:"render",value:function(){var t=this;this.state.overlay=new Rn.a({element:this.el[0],autoPan:!0,autoPanMargin:150,positioning:"center-center",offset:[0,0]});var e=$("map");e?this.init(e):$("map/que").push((function(e){t.init(e)}))}},{key:"init",value:function(t){var e=this;t.addOverlay(this.state.overlay),t.on("click",(function(t){t.originalEvent.ctrlKey||$("event/contextmenu")||e.el.popover("dispose")})),t.getViewport().addEventListener("contextmenu",(function(n){n.preventDefault(),Q("event/contextmenu",!0);var o=t.getEventCoordinate(n),r=Te(t,t.getEventPixel(n),o);r&&r[1].getGeometry()instanceof co.a&&(o=r[1].getGeometry().getCoordinates()),e.open(o,e.getContent(o,r))}))}},{key:"open",value:function(t,e){tc.default.Defaults.modifiers.preventOverflow.enabled=!1,tc.default.Defaults.modifiers.hide.enabled=!1,this.el.popover("dispose"),this.state.overlay.setPosition(t),this.el.popover(e.definition),this.el.on("shown.bs.popover",(function(t){e.onShow(ut()(t.target).data("bs.popover").tip)})),this.el.on("hidden.bs.popover",(function(){e.onHide(),tc.default.Defaults.modifiers.preventOverflow.enabled=!0,tc.default.Defaults.modifiers.hide.enabled=!0})),this.el.popover("show")}},{key:"getContent",value:function(t,e){var n=this,o=this.state.items.map((function(e,n){var o="function"==typeof e.content?e.content(t):e.content;return'<li class="list-group-item item-'.concat(n,'">').concat(o,"</li>")}));return{definition:{container:this.el,placement:"right",animation:!1,html:!0,content:o.join(""),offset:20*(this.state.items.length-1)+"px, 0",template:'\n          <div class="contextmenu popover">\n            <div class="arrow"></div>\n            <div class="popover-body"></div>\n          </div>'},onShow:function(o){ut()(o).on("contextmenu",(function(t){t.stopPropagation()})),n.state.items.forEach((function(r,a){"function"==typeof r.onClick&&ut()(o).on("click",".item-"+a,(function(o){o.preventDefault(),r.onClick(o,t,e),r.closeOnClick&&n.el.popover("dispose")})),"function"==typeof r.onBtnClick&&ut()(o).on("click",".item-".concat(a," .context-item-btn"),(function(o){o.preventDefault(),o.stopPropagation(),r.onBtnClick(o,t,e),r.closeOnClick&&n.el.popover("dispose")}))}))},onHide:function(){}}}}])&&nc(n.prototype,o),r&&nc(n,r),i}(ot);function sc(t){return(sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lc(t,e){return!e||"object"!==sc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uc(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function fc(t){return(fc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pc(t,e){return(pc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pc(t,e)}(o,t);var e,n=(e=o,function(){var t,n=fc(e);if(uc()){var o=fc(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return lc(this,t)});function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),e=n.call(this,t),$("map/contextmenu").push({content:'<i class="fa fa-street-view size-1_1"></i> '.concat(it("Street view")),onClick:function(t,e){var n=Object(Bt.p)(e).slice(0,2).reverse().join(",");ut()("<a>").attr("href",W.google.streetview+n).attr("target","_blank")[0].click()}}),e}return o}(ot),hc=n(156),yc=n(81),mc=n(297),gc=n(187),bc=n(298),vc=n(35);n(411);function wc(t){return(wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kc(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ac(t,e){return!e||"object"!==wc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sc(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Oc(t){return(Oc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jc(t,e){return(jc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jc(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Oc(e);if(Sc()){var o=Oc(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Ac(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).alert=new jn,e.state={map:null,measureType:null,snapTolerance:10,snapFeatures:null,layer:null,source:null,drawing:new lo.a({geometry:new so.a([])}),circle:new lo.a,sketch:new lo.a({geometry:new so.a([])}),measureLine:new so.a([])},e.interaction={snap:null,modify:new mc.a({features:new ao.a([e.state.drawing]),insertVertexCondition:function(t){return"circle"===e.state.measureType?Object(vc.h)(t):Object(vc.c)(t)},deleteCondition:function(t){return Object(vc.d)(t)},style:oe({circle:{radius:5,stroke:{color:"black",width:1},fill:{color:"white"}}})})},e.handlers={onmodify:function(t){e.onmodify(t)},clicked:function(t){e.clicked(t)},mousemoved:function(t){e.mousemoved(t)}},$("map/contextmenu").push({content:'<i class="fa fa-ruler-combined"></i> '.concat(it("Measure"),'\n        <a href="#" class="btn btn-link context-item-btn"><i class="far fa-dot-circle"></i></a>'),onClick:function(t,n){e.init(n)},onBtnClick:function(t,n){t.preventDefault(),e.init(n,"circle")},closeOnClick:!0}),e}return n=i,(o=[{key:"init",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"distance";this.state.map||(this.state.map=$("map")),this.state.layer||(this.state.layer=this.createLayer(),this.state.source=this.state.layer.getSource(),this.state.layer.setMap(this.state.map)),this.reset(),this.state.measureType=e,this.render(),this.state.snapFeatures=new ao.a(this.getAllFeatures()),this.state.drawing.getGeometry().setCoordinates([t]),this.state.snapFeatures.push(this.state.drawing),"circle"===e?(this.state.circle.setGeometry(new vo.a(t)),this.state.source.addFeatures([this.state.circle,this.state.drawing,this.state.sketch])):this.state.source.addFeatures([this.state.drawing,this.state.sketch]),$("components/featureInfo")&&$("components/featureInfo").disable(),this.enableClick(),this.state.map.getInteractions().getArray().forEach((function(t){t instanceof gc.a&&t.setActive(!1)}))}},{key:"createLayer",value:function(){return we({type:"FeatureCollection",id:S(),title:"Measure",style:[{stroke:{color:"black",width:1},fill:{color:"rgba(255, 255, 255, 0)"}},{circle:{radius:4,stroke:{color:"black",width:1},fill:{color:"white"}},geometry:function(t){if(t.getGeometry()instanceof so.a){var e=t.getGeometry().getCoordinates();return new hc.a(e)}}}]})}},{key:"render",value:function(){var t=this;this.alert.close();var e="";"circle"===this.state.measureType?e+='\n        <div class="form-inline">\n          <label for="angle">'.concat(it("Angle"),': </label>\n          <input type="text" name="angle" class="form-control input-sm" readonly> &deg;\n        </div>\n        <div class="form-inline">\n          <label for="radius">').concat(it("Radius"),': </label>\n          <input type="text" name="radius" class="form-control input-sm" readonly> m\n        </div>'):e+="\n        ".concat(it("Length"),": ").concat(it("to finish, click on end"),"<br>\n        ").concat(it("Area"),": ").concat(it("to finish, click on beginning")),this.alert.open(e,(function(){t.reset()}));var n=this.alert.getEl();"circle"===this.state.measureType&&(n.on("focus","input",(function(e){t.interaction.modify.setActive(!1)})),n.on("blur","input",(function(e){var o=n.find("input[name=angle]").val(),r=n.find("input[name=radius]").val(),a=t.state.drawing.getGeometry().getCoordinates(),i=t.getCoordinateByAngleDistance(a[0],Number(o),Number(r));t.state.drawing.getGeometry().setCoordinates([a[0],i]),t.interaction.modify.setActive(!0)})))}},{key:"updateResults",value:function(){if("circle"===this.state.measureType)this.updateCircleResults();else{var t=j(this.state.drawing.getGeometry()),e="".concat(it("Length"),": ").concat(t),n=this.state.drawing.getGeometry().getCoordinates();if(n[0][0]===n[n.length-1][0]&&n[0][1]===n[n.length-1][1]){var o=x(new yc.b([n]));e+="<br>".concat(it("Area"),": ").concat(o)}else e+="<br>".concat(it("Area"),": ").concat(it("to finish, click on beginning"));this.alert.update(e)}}},{key:"updateCircleResults",value:function(){var t=this.state.sketch.getGeometry(),e=t.getCoordinates();0===e.length&&(e=(t=this.state.drawing.getGeometry()).getCoordinates());var n=e[0],o=e[e.length-1],r=g(Math.atan2(o[0]-n[0],o[1]-n[1]));r<0&&(r=360+r);var a=Object(c.c)(t),i=this.alert.getEl();i.find("input[name=angle]").val(Math.round(100*(r+1e-5))/100),i.find("input[name=radius]").val(Math.round(100*(a+1e-5))/100)}},{key:"reset",value:function(){this.state.drawing.getGeometry().un("change",this.handlers.onmodify),this.state.map.removeInteraction(this.interaction.modify),this.state.map.removeInteraction(this.interaction.snap),this.state.snapFeatures=null,this.disableClick(),$("components/featureInfo")&&$("components/featureInfo").enable(),this.state.drawing.getGeometry().setCoordinates([]),this.state.sketch.getGeometry().setCoordinates([]),"circle"===this.state.measureType&&this.state.circle.setGeometry(null),this.state.source.clear(),this.state.map.getInteractions().getArray().forEach((function(t){t instanceof gc.a&&t.setActive(!0)}))}},{key:"enableClick",value:function(){this.state.map.on("click",this.handlers.clicked),this.state.map.on("pointermove",this.handlers.mousemoved)}},{key:"disableClick",value:function(){this.state.map.un("click",this.handlers.clicked),this.state.map.un("pointermove",this.handlers.mousemoved)}},{key:"clicked",value:function(t){this.state.sketch.getGeometry().setCoordinates([]);var e=this.state.drawing.getGeometry().getCoordinates(),n=this.getSnappedCoordinate(t.coordinate,this.state.snapFeatures.getArray(),this.state.snapTolerance);if("circle"===this.state.measureType){var o=e[0];this.state.drawing.getGeometry().setCoordinates([o,n]),this.alert.getEl().find("input").prop("readonly",!1),this.finish()}else e.length>1&&e[0][0]===n[0]&&e[0][1]===n[1]?(e.push(n),this.state.drawing.getGeometry().setCoordinates(e),this.finish()):e.length>1&&e[e.length-1][0]===n[0]&&e[e.length-1][1]===n[1]?this.finish():(e.push(n),this.state.drawing.getGeometry().setCoordinates(e))}},{key:"onmodify",value:function(t){if("circle"===this.state.measureType){var e=this.state.drawing.getGeometry().getCoordinates(),n=this.state.circle.getGeometry(),o=this.getCoordinatesDistance(e[0],e[1]);n.setCenter(e[0]),n.setRadius(o)}this.updateResults()}},{key:"mousemoved",value:function(t){var e=this.state.drawing.getGeometry().getCoordinates(),n="circle"===this.state.measureType?e[0]:e[e.length-1],o=this.getSnappedCoordinate(t.coordinate,this.state.snapFeatures.getArray(),this.state.snapTolerance);if(this.state.sketch.getGeometry().setCoordinates([n,o]),"circle"===this.state.measureType){var r=this.getCoordinatesDistance(n,o);this.state.circle.getGeometry().setRadius(r),this.updateCircleResults()}else{var a=e.slice(0);a.push(o),this.state.measureLine.setCoordinates(a),this.alert.update("\n        ".concat(it("Length"),": ").concat(j(this.state.measureLine),"<br>\n        ").concat(it("Area"),": ").concat(it("to finish, click on beginning"),"\n      "))}}},{key:"finish",value:function(){this.disableClick(),this.state.sketch.getGeometry().setCoordinates([]),this.updateResults(),this.state.map.addInteraction(this.interaction.modify),this.interaction.snap=new bc.a({features:this.state.snapFeatures}),this.state.map.addInteraction(this.interaction.snap),this.state.drawing.getGeometry().on("change",this.handlers.onmodify)}},{key:"getSnappedCoordinate",value:function(t,e,n){for(var o=this,r=t,a=function(t,e){var n=o.state.map.getPixelFromCoordinate(t),r=o.state.map.getPixelFromCoordinate(e);return o.getCoordinatesDistance(n,r)},i=0,c=e.length;i<c;i++){var s=e[i].getGeometry().getCoordinates();if(s&&"number"==typeof s[0]){if(a(s,t)<=n){r=s;break}}else{var l=s.filter((function(e){if(a(e,t)<=n)return!0}));l.length>0&&(r=l[0])}}return r}},{key:"getCoordinateByAngleDistance",value:function(t,e,n){var o=6378137,r=Object(Bt.p)(t),a=b(e),i=b(r[1]),c=b(r[0]);return i=Math.asin(Math.sin(i)*Math.cos(n/o)+Math.cos(i)*Math.sin(n/o)*Math.cos(a)),c+=Math.atan2(Math.sin(a)*Math.sin(n/o)*Math.cos(i),Math.cos(n/o)-Math.sin(i)*Math.sin(i)),Object(Bt.g)([g(c),g(i)])}},{key:"getCoordinatesDistance",value:function(t,e){var n=Math.abs(t[0]-e[0]),o=Math.abs(t[1]-e[1]);return Math.sqrt(n*n+o*o)}},{key:"getAllFeatures",value:function(){var t=[];return $("map/layer/layers").forEach((function(e){"FeatureCollection"===e.get("conf").type&&(t=t.concat(e.getSource().getFeatures()))})),$("map/layer/overlays").forEach((function(e){"FeatureCollection"===e.get("conf").type&&"Measure"!==e.get("title")&&(t=t.concat(e.getSource().getFeatures()))})),t}}])&&kc(n.prototype,o),r&&kc(n,r),i}(ot);n(412);function Rc(t){return(Rc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ec(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Pc(t,e){return!e||"object"!==Rc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Cc(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _c(t){return(_c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tc(t,e){return(Tc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tc(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=_c(e);if(Cc()){var o=_c(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Pc(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('<div id="tooltip"></div>'),e.state={tooltipVisible:!1,overlay:null,currentFeature:null},e.create(),e}return n=i,(o=[{key:"render",value:function(){var t=this;this.state.overlay=new Rn.a({element:this.el[0],autoPan:!1,positioning:"center-center",offset:[0,-14],stopEvent:!1});var e=$("map");e?this.init(e):$("map/que").push((function(e){t.init(e)}))}},{key:"init",value:function(t){var e=this;t.addOverlay(this.state.overlay),t.on("pointermove",(function(n){if(!n.dragging){var o=t.getEventPixel(n.originalEvent),r=t.hasFeatureAtPixel(o);t.getTarget().style.cursor=r?"pointer":"",e.state.tooltipVisible=e.open(!!r&&n.originalEvent,t)}}))}},{key:"open",value:function(t,e){if(!t)return this.el.html(""),this.state.overlay.setPosition(void 0),this.state.currentFeature=null,!1;var n=e.getEventCoordinate(t),o=e.forEachFeatureAtPixel(e.getEventPixel(t),(function(t,e){return t}));return o!==this.state.currentFeature&&(o.get("name")||o.get("title"))&&("Point"===o.getGeometry().getType()&&(n=o.getGeometry().getCoordinates()),this.el.html(it(o.get("name")||o.get("title"))),this.state.overlay.setPosition(n),this.state.currentFeature=o),!0}}])&&Ec(n.prototype,o),r&&Ec(n,r),i}(ot);n(413);function Lc(t){return(Lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fc(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Gc(t,e){return!e||"object"!==Lc(e)&&"function"!=typeof e?Dc(t):e}function Dc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Nc(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Uc(t){return(Uc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ic(t,e){return(Ic=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ic(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Uc(e);if(Nc()){var o=Uc(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Gc(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this,t)).el=ut()('<div id="popup-map"></div>'),e.state={overlay:null,infoStore:[],geomTypes:{points:["Point"],linestrings:["LineString","MultiLineString"],polygons:["Polygon","MultiPolygon"]},offset:0,open:!1},e.handlers={clicked:function(t){t.originalEvent.ctrlKey||$("event/contextmenu")?Q("event/contextmenu",!1):e.open(t)}},e.format={geojson:new Vt.a},e.create(),Q("components/featureInfo",Dc(e)),e}return n=i,(o=[{key:"render",value:function(){var t=this;this.state.overlay=new Rn.a({element:this.el[0],positioning:"center-center",offset:[0,-this.state.offset]});var e=$("map");e?(this.state.map=e,this.init(e)):$("map/que").push((function(e){t.state.map=e,t.init(e)}))}},{key:"init",value:function(t){t.addOverlay(this.state.overlay),this.enable()}},{key:"enable",value:function(){this.state.map.on("singleclick",this.handlers.clicked)}},{key:"disable",value:function(){this.state.map.un("singleclick",this.handlers.clicked)}},{key:"show",value:function(t,e,n,o){var r=this;this.state.overlay.setPosition(e),this.el.popover(o.definition).popover("show"),this.el.on("shown.bs.popover",(function(e){r.state.open=!0;var a=o.definition.container.find(".popup").height();r.state.overlay.setOffset([0,a+r.state.offset+20>t.pixel[1]?r.state.offset:-r.state.offset]),o.onShow(n,ut()(e.target).data("bs.popover").tip)})),this.el.on("hidden.bs.popover",(function(t){o.onHide(t)})),this.el.popover("show")}},{key:"open",value:function(t){var e,n=this,o=t.coordinate,r=Te(this.state.map,t.pixel,o);this.state.open&&(this.el.popover("dispose"),this.state.open=!1,!r)||(r?("Point"===r[1].getGeometry().getType()&&(o=r[1].getGeometry().getCoordinates()),(e=r[0]&&this.state.infoStore[r[0].get("id")]?this.state.infoStore[r[0].get("id")](r[1]):this.getContent(r[1],r[0]))&&this.show(t,o,r,e)):function(){for(var a=n.state.map.getView().getResolution(),i=$("map/layer/layers").getArray().filter((function(t){return"TileWMS"===t.get("conf").type&&t.getVisible()})),c=null,s=function(s){var l=i[s].getSource().getParams().LAYERS;c=i[s].getSource().getFeatureInfoUrl(o,a,n.state.map.getView().getProjection(),{INFO_FORMAT:"application/json",QUERY_LAYERS:l.split(",").reverse().join(","),FEATURE_COUNT:l.split(",").length}),n.getWMSFeatureInfo(c,(function(a){if(a){var c=n.format.geojson.readFeatures(a);c.length&&(e=n.getContent(c[0],i[s]),n.show(t,o,r,e))}}))},l=i.length-1;l>=0;l--)s(l)}())}},{key:"getContent",value:function(t,e){var n=this;if(t&&e){var o,r,a=t.getProperties(),i=$("geocache/trip");if(e.get("_featureInfo")){var s=e.get("_featureInfo");o="function"==typeof s.title?s.title(t):s.title,r="function"==typeof s.content?s.content(t):s.content}else o='\n          <i class="fa fa-map-marker-alt"></i>\n          '.concat(it("Feature"),'\n          <div class="tools">\n            <a href="#" class="remove-marker" title="Eemalda">\n              <i class="far fa-trash-alt"></i>\n            </a>\n            ').concat(t.getGeometry()instanceof co.a?'\n            <a href="#" class="cache-toggle" data-id="'.concat(t.get("id"),'" title="').concat(it("Add to geotrip"),'">\n              <i class="fas ').concat(i&&i.getArray().indexOf(t)>-1?"fa-minus-square":"fa-thumbtack",'"></i>\n            </a>\n            '):"","\n          </div>"),r=Object.keys(a).filter((function(t){return"string"==typeof a[t]||"number"==typeof a[t]||"boolean"==typeof a[t]})).map((function(t){return"".concat(t,": ").concat((e=a[t],String(e).replace(/((http|https|ftp|ftps):\/\/[a-zA-Z0-9\-.]+\.[a-zA-Z]{2,3}(\/\S*)?)/g,'<a href="$1" target="_blank">$1</a>')));var e})),this.state.geomTypes.linestrings.indexOf(t.getGeometry().getType())>-1&&r.push("".concat(it("Length"),": ").concat(j(t.getGeometry()))),this.state.geomTypes.polygons.indexOf(t.getGeometry().getType())>-1&&r.push("".concat(it("Area"),": ").concat(x(t.getGeometry()))),r=r.join("<br>");if(this.state.geomTypes.points.indexOf(t.getGeometry().getType())>-1&&$("map/geolocation")){var l=$("map/geolocation/position"),u=Object(c.b)(Object(Bt.p)(l),Object(Bt.p)(t.getGeometry().getCoordinates()));r+='<div class="distance"><i class="fas fa-location-arrow"></i>\n          '.concat(j(null,u),"</div>")}return{definition:{container:this.el,placement:"top",animation:!1,html:!0,title:o,content:r,template:'\n            <div class="popup popover">\n              <div class="arrow"></div>\n              <h3 class="popover-header"></h3>\n              <div class="popover-body"></div>\n            </div>'},onShow:function(t,e){var o=$("geocache/trip");ut()(e).on("contextmenu",(function(t){t.stopPropagation()})),ut()(e).on("click",".remove-marker",(function(e){e.preventDefault(),t&&t[0]&&(t[0].getSource().removeFeature(t[1]),o&&o.remove(t[1]),n.el.popover("dispose"))})),ut()(e).on("click",".cache-toggle",(function(e){e.preventDefault(),ut()(e.currentTarget).find("i").toggleClass("fa-thumbtack fa-minus-square"),o&&(o.getArray().indexOf(t[1])>-1?o.remove(t[1]):o.push(t[1]))})),ut()(e).on("click",".distance",(function(e){e.preventDefault(),eo([Object(Bt.p)($("map/geolocation/position")),Object(Bt.p)(t[1].getGeometry().getCoordinates())]).then((function(e){e&&Q("navigate/to",t[1])})).catch((function(e){Q("navigate/to",t[1])}))})),t&&t[0]&&t[0].get("_featureInfo")&&"function"==typeof t[0].get("_featureInfo").onShow&&t[0].get("_featureInfo").onShow(t,e)},onHide:function(){}}}}},{key:"getWMSFeatureInfo",value:function(t,e){ut.a.ajax({type:"GET",crossDomain:!0,url:t,dataType:"json",context:this}).done(e).fail((function(t){e(null)}))}}])&&Fc(n.prototype,o),r&&Fc(n,r),i}(ot);n(414);function qc(t){return(qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vc(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Bc(t,e){return!e||"object"!==qc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hc(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Jc(t){return(Jc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yc(t,e){return(Yc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yc(t,e)}(i,t);var e,n,o,r,a=(e=i,function(){var t,n=Jc(e);if(Hc()){var o=Jc(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Bc(this,t)});function i(){return zc(this,i),a.apply(this,arguments)}return n=i,(o=[{key:"render",value:function(){var t=$("app/debug");t&&(["debug","error","info"].forEach((function(t){console[t+"_"]=console[t],console[t]=function(){for(var e=(new Date).toISOString(),n=e,o=0,r=arguments.length;o<r;o++){var a=arguments[o];n+=" "+f(a),"object"===f(a)&&"object"===("undefined"==typeof JSON?"undefined":f(JSON))&&"function"==typeof JSON.stringify?function(){var t=[];n+=" "+JSON.stringify(a,(function(e,n){if("object"===f(n)&&null!==n){if(-1!==t.indexOf(n))try{return JSON.parse(JSON.stringify(n))}catch(t){return}t.push(n)}return n}))}():n+=" "+a}d.push(n),console[t+"_"].apply(void 0,arguments)}})),console.debug("Debug mode enabled")),at($("app/locale"),Tt),t&&console.debug("Locale: "+$("app/locale")),this.components={map:new Me(this.target),contextmenu:new cc(this.target),header:new Ea(this.target),statusbar:new ji(this.target),toolbar:new $i(this.target),streetview:$("app/streetView")&&new dc(this.target),measure:$("app/measureTool")&&new xc(this.target),tooltip:$("app/tooltip")&&new Mc(this.target),popup:$("app/featureInfo")&&new Wc(this.target),routing:$("app/routing")&&new ro(this.target)},this.components.map.init()}}])&&Vc(n.prototype,o),r&&Vc(n,r),i}(ot),Xc=null,Kc=ut()("#geop");function Qc(){Xc&&(Xc.destroy(),Xc=null,Kc.html("")),window.location.reload()}!function(){if("serviceWorker"in navigator==0)return console.log("Service worker is not supported"),!1;navigator.serviceWorker.register("sw.js").then((function(t){t.onupdatefound=function(){if(navigator.serviceWorker.controller){var e=t.installing;e.onstatechange=function(){switch(e.state){case"installed":break;case"redundant":throw new Error("The installing service worker became redundant.")}}}}})).catch((function(t){console.error("Error during service worker registration:",t)}))}(),"onhashchange"in window&&(T.newURL=k(document.URL),T.hash=L(k(document.URL).hash),window.addEventListener("hashchange",(function(t){T.oldURL=T.newURL,T.newURL=k(t.newURL),T.hash=L(T.newURL.hash),M.forEach((function(t){t(T.hash)})),_=!1}),!1)),_t().then((function(t){new Zc(Kc).render()}))}});