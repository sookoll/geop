!function(e){function t(t){for(var o,r,a=t[0],i=t[1],c=t[2],s=0,l=[];s<a.length;s++)r=a[s],Object.prototype.hasOwnProperty.call(_,r)&&_[r]&&l.push(_[r][0]),_[r]=0;for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o]);for(D&&D(t);l.length;)l.shift()();return T.push.apply(T,c||[]),n()}function n(){for(var e,t=0;t<T.length;t++){for(var n=T[t],o=!0,r=1;r<n.length;r++){var a=n[r];0!==_[a]&&(o=!1)}o&&(T.splice(t--,1),e=M(M.s=n[0]))}return e}var o=window.webpackHotUpdate;window.webpackHotUpdate=function(e,t){!function(e,t){if(!A[e]||!k[e])return;for(var n in k[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(y[n]=t[n]);0==--b&&0===v&&x()}(e,t),o&&o(e,t)};var r,a=!0,i="89db0ed4f0bf9a17a2ba",c={},s=[],l=[];function u(t){var n={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:r!==t,active:!0,accept:function(e,t){if(void 0===e)n._selfAccepted=!0;else if("function"==typeof e)n._selfAccepted=e;else if("object"==typeof e)for(var o=0;o<e.length;o++)n._acceptedDependencies[e[o]]=t||function(){};else n._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)n._selfDeclined=!0;else if("object"==typeof e)for(var t=0;t<e.length;t++)n._declinedDependencies[e[t]]=!0;else n._declinedDependencies[e]=!0},dispose:function(e){n._disposeHandlers.push(e)},addDisposeHandler:function(e){n._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=n._disposeHandlers.indexOf(e);t>=0&&n._disposeHandlers.splice(t,1)},invalidate:function(){switch(this._selfInvalidated=!0,p){case"idle":(y={})[t]=e[t],d("ready");break;case"ready":P(t);break;case"prepare":case"check":case"dispose":case"apply":(m=m||[]).push(t)}},check:O,apply:C,status:function(e){if(!e)return p;f.push(e)},addStatusHandler:function(e){f.push(e)},removeStatusHandler:function(e){var t=f.indexOf(e);t>=0&&f.splice(t,1)},data:c[t]};return r=void 0,n}var f=[],p="idle";function d(e){p=e;for(var t=0;t<f.length;t++)f[t].call(null,e)}var h,y,g,m,b=0,v=0,w={},k={},A={};function S(e){return+e+""===e?+e:e}function O(e){if("idle"!==p)throw new Error("check() is only allowed in idle status");return a=e,d("check"),(t=1e4,t=t||1e4,new Promise((function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var o=new XMLHttpRequest,r=M.p+""+i+".hot-update.json";o.open("GET",r,!0),o.timeout=t,o.send(null)}catch(e){return n(e)}o.onreadystatechange=function(){if(4===o.readyState)if(0===o.status)n(new Error("Manifest request to "+r+" timed out."));else if(404===o.status)e();else if(200!==o.status&&304!==o.status)n(new Error("Manifest request to "+r+" failed."));else{try{var t=JSON.parse(o.responseText)}catch(e){return void n(e)}e(t)}}}))).then((function(e){if(!e)return d(R()?"ready":"idle"),null;k={},w={},A=e.c,g=e.h,d("prepare");var t=new Promise((function(e,t){h={resolve:e,reject:t}}));for(var n in y={},_)j(n);return"prepare"===p&&0===v&&0===b&&x(),t}));var t}function j(e){A[e]?(k[e]=!0,b++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=M.p+""+e+"."+i+".hot-update.js",document.head.appendChild(t)}(e)):w[e]=!0}function x(){d("ready");var e=h;if(h=null,e)if(a)Promise.resolve().then((function(){return C(a)})).then((function(t){e.resolve(t)}),(function(t){e.reject(t)}));else{var t=[];for(var n in y)Object.prototype.hasOwnProperty.call(y,n)&&t.push(S(n));e.resolve(t)}}function C(t){if("ready"!==p)throw new Error("apply() is only allowed in ready status");return function t(n){var o,a,l,u,f;function p(e){for(var t=[e],n={},o=t.map((function(e){return{chain:[e],id:e}}));o.length>0;){var r=o.pop(),a=r.id,i=r.chain;if((u=E[a])&&(!u.hot._selfAccepted||u.hot._selfInvalidated)){if(u.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:a};if(u.hot._main)return{type:"unaccepted",chain:i,moduleId:a};for(var c=0;c<u.parents.length;c++){var s=u.parents[c],l=E[s];if(l){if(l.hot._declinedDependencies[a])return{type:"declined",chain:i.concat([s]),moduleId:a,parentId:s};-1===t.indexOf(s)&&(l.hot._acceptedDependencies[a]?(n[s]||(n[s]=[]),h(n[s],[a])):(delete n[s],t.push(s),o.push({chain:i.concat([s]),id:s})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];-1===e.indexOf(o)&&e.push(o)}}R();var b={},v=[],w={},k=function(){console.warn("[HMR] unexpected require("+j.moduleId+") to disposed module")};for(var O in y)if(Object.prototype.hasOwnProperty.call(y,O)){var j;f=S(O),j=y[O]?p(f):{type:"disposed",moduleId:O};var x=!1,C=!1,P=!1,T="";switch(j.chain&&(T="\nUpdate propagation: "+j.chain.join(" -> ")),j.type){case"self-declined":n.onDeclined&&n.onDeclined(j),n.ignoreDeclined||(x=new Error("Aborted because of self decline: "+j.moduleId+T));break;case"declined":n.onDeclined&&n.onDeclined(j),n.ignoreDeclined||(x=new Error("Aborted because of declined dependency: "+j.moduleId+" in "+j.parentId+T));break;case"unaccepted":n.onUnaccepted&&n.onUnaccepted(j),n.ignoreUnaccepted||(x=new Error("Aborted because "+f+" is not accepted"+T));break;case"accepted":n.onAccepted&&n.onAccepted(j),C=!0;break;case"disposed":n.onDisposed&&n.onDisposed(j),P=!0;break;default:throw new Error("Unexception type "+j.type)}if(x)return d("abort"),Promise.reject(x);if(C)for(f in w[f]=y[f],h(v,j.outdatedModules),j.outdatedDependencies)Object.prototype.hasOwnProperty.call(j.outdatedDependencies,f)&&(b[f]||(b[f]=[]),h(b[f],j.outdatedDependencies[f]));P&&(h(v,[j.moduleId]),w[f]=k)}var L,G=[];for(a=0;a<v.length;a++)f=v[a],E[f]&&E[f].hot._selfAccepted&&w[f]!==k&&!E[f].hot._selfInvalidated&&G.push({module:f,parents:E[f].parents.slice(),errorHandler:E[f].hot._selfAccepted});d("dispose"),Object.keys(A).forEach((function(e){!1===A[e]&&function(e){delete _[e]}(e)}));var F,D,N=v.slice();for(;N.length>0;)if(f=N.pop(),u=E[f]){var I={},U=u.hot._disposeHandlers;for(l=0;l<U.length;l++)(o=U[l])(I);for(c[f]=I,u.hot.active=!1,delete E[f],delete b[f],l=0;l<u.children.length;l++){var q=E[u.children[l]];q&&((L=q.parents.indexOf(f))>=0&&q.parents.splice(L,1))}}for(f in b)if(Object.prototype.hasOwnProperty.call(b,f)&&(u=E[f]))for(D=b[f],l=0;l<D.length;l++)F=D[l],(L=u.children.indexOf(F))>=0&&u.children.splice(L,1);d("apply"),void 0!==g&&(i=g,g=void 0);for(f in y=void 0,w)Object.prototype.hasOwnProperty.call(w,f)&&(e[f]=w[f]);var W=null;for(f in b)if(Object.prototype.hasOwnProperty.call(b,f)&&(u=E[f])){D=b[f];var V=[];for(a=0;a<D.length;a++)if(F=D[a],o=u.hot._acceptedDependencies[F]){if(-1!==V.indexOf(o))continue;V.push(o)}for(a=0;a<V.length;a++){o=V[a];try{o(D)}catch(e){n.onErrored&&n.onErrored({type:"accept-errored",moduleId:f,dependencyId:D[a],error:e}),n.ignoreErrored||W||(W=e)}}}for(a=0;a<G.length;a++){var z=G[a];f=z.module,s=z.parents,r=f;try{M(f)}catch(e){if("function"==typeof z.errorHandler)try{z.errorHandler(e)}catch(t){n.onErrored&&n.onErrored({type:"self-accept-error-handler-errored",moduleId:f,error:t,originalError:e}),n.ignoreErrored||W||(W=t),W||(W=e)}else n.onErrored&&n.onErrored({type:"self-accept-errored",moduleId:f,error:e}),n.ignoreErrored||W||(W=e)}}if(W)return d("fail"),Promise.reject(W);if(m)return t(n).then((function(e){return v.forEach((function(t){e.indexOf(t)<0&&e.push(t)})),e}));return d("idle"),new Promise((function(e){e(v)}))}(t=t||{})}function R(){if(m)return y||(y={}),m.forEach(P),m=void 0,!0}function P(t){Object.prototype.hasOwnProperty.call(y,t)||(y[t]=e[t])}var E={},_={0:0},T=[];function M(t){if(E[t])return E[t].exports;var n=E[t]={i:t,l:!1,exports:{},hot:u(t),parents:(l=s,s=[],l),children:[]};return e[t].call(n.exports,n,n.exports,function(e){var t=E[e];if(!t)return M;var n=function(n){return t.hot.active?(E[n]?-1===E[n].parents.indexOf(e)&&E[n].parents.push(e):(s=[e],r=n),-1===t.children.indexOf(n)&&t.children.push(n)):(console.warn("[HMR] unexpected require("+n+") from disposed module "+e),s=[]),M(n)},o=function(e){return{configurable:!0,enumerable:!0,get:function(){return M[e]},set:function(t){M[e]=t}}};for(var a in M)Object.prototype.hasOwnProperty.call(M,a)&&"e"!==a&&"t"!==a&&Object.defineProperty(n,a,o(a));return n.e=function(e){return"ready"===p&&d("prepare"),v++,M.e(e).then(t,(function(e){throw t(),e}));function t(){v--,"prepare"===p&&(w[e]||j(e),0===v&&0===b&&x())}},n.t=function(e,t){return 1&t&&(e=n(e)),M.t(e,-2&t)},n}(t)),n.l=!0,n.exports}M.m=e,M.c=E,M.d=function(e,t,n){M.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},M.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},M.t=function(e,t){if(1&t&&(e=M(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(M.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)M.d(n,o,function(t){return e[t]}.bind(null,o));return n},M.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return M.d(t,"a",t),t},M.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},M.p="",M.h=function(){return i};var L=window.webpackJsonp=window.webpackJsonp||[],G=L.push.bind(L);L.push=t,L=L.slice();for(var F=0;F<L.length;F++)t(L[F]);var D=G;T.push([414,1]),n()}({233:function(e,t,n){},236:function(e,t,n){},241:function(e,t,n){},242:function(e,t,n){},243:function(e,t,n){},244:function(e,t,n){},245:function(e,t,n){},246:function(e,t,n){},249:function(e,t,n){},250:function(e,t,n){},251:function(e,t,n){},252:function(e,t,n){},253:function(e,t,n){},254:function(e,t,n){},255:function(e,t,n){},256:function(e,t,n){},257:function(e,t,n){},258:function(e,t,n){},259:function(e,t,n){},260:function(e,t,n){},261:function(e,t,n){},262:function(e,t,n){},263:function(e,t,n){},264:function(e,t,n){},265:function(e,t,n){},266:function(e,t,n){},302:function(e){e.exports=JSON.parse('{"en":{"Account":"Account","Account changed, page will reload!":"Account changed, app will reload!","Add":"Add","Add any GPX, GeoJSON, KML files or WMS layers to map from layers menu or drag and drop file.":"Add any GPX, GeoJSON, KML files or WMS layers to map from layers menu or drag and drop file.","Add as base map":"Add as base map","Add as overlay":"Add as overlay","Add caches and map objects to geotrip. Reorder geotrip.":"Add caches and map objects to geotrip. Reorder geotrip.","Add caches to map":"Add caches to map","Add features from map":"Add features from map","Add File layer":"Add File layer","Add geocaches to map":"Add geocaches to map","Add log":"Add log","Add to geotrip":"Add to geotrip","Add WMS layer":"Add WMS layer","Added":"Added","Aerial":"Aerial","Aerial Estonia":"Aerial Estonia","An unknown error occurred.":"An unknown error occurred.","and copy page content to textbox below":"and copy page content to textbox below","and drop it on map or import file from layers menu":"and drop it on map or import file from layers menu","and log in":"and log in","Angle":"Angle","App resetted, page will reload!":"App resetted, app will reload!","App will recognize if geocaches are added to map.":"App will recognize if geocaches are added to map.","Append":"Append","Append will add new geocaches without deleting old ones.":"Append will add new geocaches without deleting old ones.","Archived":"Archived","Area":"Area","As crow flies":"As crow flies","Available":"Available","bookmark":"Share","Bookmark deleted!":"Bookmark deleted!","caches":"caches","Caches":"Caches","Change language. App will reload after change!":"Change language. App will reload after change!","Clear trip":"Clear trip","Close":"Close","Config":"Config","Coordinate":"Coordinate","Coordinates":"Coordinates","copied to clipboard":"copied to clipboard","Country codes":"Country codes","Debug":"Debug","Debug changed, app will reload!":"Debug changed, app will reload!","Debug mode. Will write debug logs into file. App will reload after change!":"Debug mode. Will write debug logs into file. App will reload after change!","Directions":"Directions","Directions from here":"Directions from here","Directions to here":"Directions to here","Disabled":"Disabled","Download":"Download","Download debug log":"Download debug log","download GPX from":"download GPX from","Driving":"Driving","Driving directions between points or from your current location":"Driving directions between points or from your current location","Edit OSM here":"Edit OSM here","Empty file":"Empty file","Enter geopeitus.ee or geocaching.com username. App will reload after change!":"Enter geopeitus.ee or geocaching.com username. App will reload after change!","Error creating layer":"Error creating layer","Feature":"Feature","Features":"Features","features":"features","Filter":"Filter","Filter and search caches on map.":"Filter and search caches on map.","Find streetview link and measure tools from context menu.":"Find streetview link and measure tools from context menu.","Found":"Found","Geocache importing":"Geocache importing","GeocacheInfo":"Info","GeocacheLoader":"","Geocaches":"Geocaches","Geocache|Event Cache":"Event Cache","Geocache|Letterbox Hybrid":"Letterbox Hybrid","Geocache|Locationless Cache":"Locationless Cache","Geocache|Multi-cache":"Multi-cache","Geocache|Traditional Cache":"Traditional Cache","Geocache|Unknown Cache":"Unknown Cache","Geocache|Unknown Cache|Challenge":"Challenge Cache","Geocache|Virtual Cache":"Virtual Cache","Geocache|Webcam Cache":"Webcam Cache","Geocache|Wherigo Cache":"Wherigo Cache","Geop is progressive web application with partial offline support.":"Geop is progressive web application with partial offline support.","Geotrip":"Geotrip","Geotrip reordered by optimum path":"Geotrip reordered by optimum path","Go to":"Go to","gpxActive":"Active caches","gpxActiveLogs":"Active caches with logs","gpxAll":"All caches (with archived, w.o logs)","here":"here","Hiking":"Hiking","Imported":"Imported","Insert WMS/WMTS URL":"Insert WMS/WMTS URL","Install app to home screen":"Install app to home screen","Install it to Your home screen.":"Install it to Your home screen.","Install web app to your home screen.":"Install web app to your home screen.","Invalid route":"Invalid route","Keep awake":"Keep awake","Language":"Language","Language changed, page will reload!":"Language changed, app will reload!","Large":"Large","Layers":"Layers","Length":"Length","Less than 2 pair of coordinates, aborting!":"Less than 2 pair of coordinates, aborting!","Limit address search with comma separated list of country codes (ee,fi - Estonia, Finland). Empty means no limit.":"Limit address search with comma separated list of country codes (ee,fi - Estonia, Finland). Empty means no limit.","Location information is unavailable.":"Location information is unavailable.","Logs":"Logs","Map":"Map","measure":"Measure","Measure":"Measure","Measure angle and distance":"Measure angle and distance","Measure distance and area. Click to last point finish measurement. Click to first point calculates area.":"Measure distance and area. Click to last point finish measurement. Click to first point calculates area.","Micro":"Micro","Missing LAYERS parameter":"Missing LAYERS parameter","Missing provider, aborting!":"Missing provider, aborting!","Missing SRS parameter":"Missing SRS parameter","mouseposition":"Mouse Position","My location":"My location","Navigate to cache with two tracking mode":"Navigate to cache with two tracking mode","NB! Turning this off and sharing bookmark will store possibly big amount of data in service. It might fail. Use with caution!":"NB! Turning this off and sharing bookmark will store possibly big amount of data in service. It might fail. Use with caution!","New Cache":"New Cache","No baselyers added":"No baselyers added","No caches to add!":"No caches to add!","No overlays added":"No overlays added","No result":"No result","No route between start and destination":"No route between start and destination","No valid input coordinates, aborting!":"No valid input coordinates, aborting!","North up!":"North up!","Not Found":"Not Found","Not valid GeoJSON":"Not valid GeoJSON","Off":"Off","On":"On","Optimize":"Optimize","or":"or","or open":"or open","Overwrite":"Overwrite","Overwrite will delete old geocaches when import new caches from file.":"Overwrite will delete old geocaches when import new caches from file.","Owner":"Owner","Query string empty, aborting!":"Query string empty, aborting!","Query string too short, aborting!":"Query string too short, aborting!","Quick links":"Quick links","Radius":"Radius","Regular":"Regular","Reset":"Reset","Reset app":"Reset app","Reset app to default. App will reload!":"Reset app to default. App will reload!","Retry directions":"Retry directions","Routing":"Routing","Routing disabled":"Routing disabled","Routing input test failed, aborting!":"Routing input test failed, aborting!","routinginfo":"Routing","scaleline":"Scaleline","Search":"Search","Search and display coordinates in WGS, L-Est, UTM and MGRS system.":"Search and display coordinates in WGS, L-Est, UTM and MGRS system.","Search coordinates":"Search coordinates","Select geocache from map":"Select geocache from map","Select routing profile or disable routing":"Select routing profile or disable routing","Set a method, how cache import works.":"Set a method, how cache import works.","Settings":"Settings","Share":"Share","Share bookmark":"Share bookmark","Share only features added to geotrip.":"Share only features added to geotrip.","Share only geotrip features":"Share only geotrip features","Share snapshot of app state via link or QR-code. Download geotrip as GPX-file.":"Share snapshot of app state via link or QR-code. Download geotrip as GPX-file.","Show 160m radius":"Show 160m radius","Show distance and duration along route, not from beginning to end":"Show distance and duration along route, not from beginning to end","Small":"Small","Street view":"Street view","The request to get user location timed out.":"The request to get user location timed out.","to finish, click on beginning":"to finish, click on beginning","to finish, click on end":"to finish, click on end","Toggle fullscreen":"Toggle fullscreen","Too Many Requests":"Too Many Requests","Topo":"Topo","Unable to copy to clipboard":"Unable to copy to clipboard","Unable to delete bookmark":"Unable to delete bookmark","Unable to determine ordering":"Unable to determine ordering","Unable to find layer extent":"Unable to find layer extent","Unable to find location.":"Unable to find location.","Unable to find route":"Unable to find route","Unable to get routing result":"Unable to get routing result!","Unable to load bookmark":"Unable to load bookmark","Unable to perform search!":"Unable to perform search!","Unable to save bookmark":"Unable to save bookmark","Unavailable":"Unavailable","Unknown":"Unknown","Unsupported file type":"Unsupported file type","URL":"URL","URL is not valid WMS resource!":"URL is not valid WMS resource!","User denied the request for Geolocation.":"User denied the request for Geolocation.","Username":"Username","Waypoint|Final Location":"Final Location","Waypoint|Parking Area":"Parking Area","Waypoint|Physical Stage":"Physical Stage","Waypoint|Reference Point":"Reference Point","Waypoint|Stages of a Multicache":"Stages of a Multicache","Waypoint|Trailhead":"Trailhead","Waypoint|Virtual Stage":"Virtual Stage","Zoom in":"Zoom in","Zoom out":"Zoom out"},"et":{"Account":"Konto","Account changed, page will reload!":"Konto muudetud, teeme restardi!","Add":"Lisa","Add any GPX, GeoJSON, KML files or WMS layers to map from layers menu or drag and drop file.":"Lisa GPX, GeoJSON, KML fail või WMS kiht kaardile. Kasuta kihtide menüüd või lohista fail kaardile.","Add as base map":"Lisa aluskaart","Add as overlay":"Lisa kaardikiht","Add caches and map objects to geotrip. Reorder geotrip.":"Lisa aardeid ja kaardiobjekte geotuurile. Järjesta geotuuri.","Add caches to map":"Lisa aardeid kaardile","Add features from map":"Lisa kaardilt objekte","Add File layer":"Lisa fail","Add geocaches to map":"Lisa aarded kaardile","Add log":"Lisa logi","Add to geotrip":"Lisa geotuuri","Add WMS layer":"Lisa WMS","Added":"Lisatud","Aerial":"Satipilt","Aerial Estonia":"Foto","An unknown error occurred.":"Tekkis tundmatu viga.","and copy page content to textbox below":"ja kopeeri lehe sisu alla tekstikasti","and drop it on map or import file from layers menu":"ja lohista fail kaardile või impordi fail kihtide menüüst","and log in":"ja logi sisse","Angle":"Nurk","App resetted, page will reload!":"Rakendus lähtestatud, teeme restardi!","App will recognize if geocaches are added to map.":"Rakendus saab aru, kui aarded on kaardile lisatud.","Append":"Lisa","Append will add new geocaches without deleting old ones.":"Lisa - uued aarded lisatakse kaardile ilma vanu kustutamata.","Archived":"Arhiveeritud","Area":"Pindala","As crow flies":"Linnulennult","Available":"Aktiivsed","bookmark":"Jaga","Bookmark deleted!":"Järjehoidja kustutatud!","caches":"aaret","Caches":"Aarded","Change language. App will reload after change!":"Muuda rakenduse keel. Rakendus taaskäivitub peale muutmist!","Clear trip":"Tühjenda","Close":"Sulge","Config":"Seaded","Coordinate":"Koordinaat","Coordinates":"Koordinaadid","copied to clipboard":"kopeeritud","Country codes":"Riigi kood","Debug":"Silumine","Debug changed, app will reload!":"Silumisrežiimi muutus. Rakendus taaskäivitub!","Debug mode. Will write debug logs into file. App will reload after change!":"Silumisrežiim. Silumise logid kirjutatakse faili. Rakendus taaskäivitub peale muutmist!","Directions":"Teekond","Directions from here":"Teekonna algus","Directions to here":"Teekonna lõpp","Disabled":"Keelatud","Download":"Lae alla","Download debug log":"Lae alla logifail","download GPX from":"lae GPX","Driving":"Auto","Driving directions between points or from your current location":"Teekonna arvutus kahe punkti või kaardiobjekti vahel ja kasutaja asukohast sihtpunkti.","Edit OSM here":"Muuda OSMi","Empty file":"Tühi fail","Enter geopeitus.ee or geocaching.com username. App will reload after change!":"Sisesta geopeitus.ee või geocaching.com kasutajanimi. Rakendus taaskäivitub peale muutmist!","Error creating layer":"Kihi loomine ebaõnnestus","Feature":"Objekt","Features":"Objektid","features":"objekti","Filter":"Filter","Filter and search caches on map.":"Filtreeri ja otsi aardeid.","Find streetview link and measure tools from context menu.":"Parema kliki menüüst leiad tänavavaate ja mõõtmise tööriistad.","Found":"Leitud","Geocache importing":"Aarete importimine","GeocacheInfo":"Info","GeocacheLoader":"","Geocaches":"Aarded","Geocache|Event Cache":"Sündmusaare","Geocache|Letterbox Hybrid":"Kirjakastiaare","Geocache|Locationless Cache":"Asukohata aare","Geocache|Multi-cache":"Multiaare","Geocache|Traditional Cache":"Tavaline aare","Geocache|Unknown Cache":"Mõistatusaare","Geocache|Unknown Cache|Challenge":"Väljakutse aare","Geocache|Virtual Cache":"Virtuaalne aare","Geocache|Webcam Cache":"Veebikaamera aare","Geocache|Wherigo Cache":"Wherigo aare","Geop is progressive web application with partial offline support.":"Geop on progressiivne veebirakendus (PWA) osalise võrguta töötamise toega.","Geotrip":"Geotuur","Geotrip reordered by optimum path":"Geotuur järjestatud lühima teekonna järgi","Go to":"Mine","gpxActive":"Aktiivsed aarded","gpxActiveLogs":"Aktiivsed aarded koos logidega","gpxAll":"Kõik aarded (k.a arhiveeritud, ilma logideta)","here":"siit","Hiking":"Matk","Imported":"Imporditud","Insert WMS/WMTS URL":"Sisesta siia kasti WMS/WMTS aadress","Install app to home screen":"Paigalda rakendus","Install it to Your home screen.":"Paigalda rakendus avalehele.","Install web app to your home screen.":"Paigalda rakendus oma seadmesse.","Invalid route":"Vale teekond","Keep awake":"Hoia ekraan töös","Language":"Keel","Language changed, page will reload!":"Keel muudetud, teeme restardi!","Large":"Suur","Layers":"Kihid","Length":"Vahemaa","Less than 2 pair of coordinates, aborting!":"Peab olema vähemalt kaks punkti, lõpetan!","Limit address search with comma separated list of country codes (ee,fi - Estonia, Finland). Empty means no limit.":"Piira aadressiotsingut riigiti. Mitme riigi otsingu jaoks eralda komaga (ee,fi - Eesti, Soome). Tühi otsib üle maailma.","Location information is unavailable.":"Asukoha info ei ole kättesaadav.","Logs":"Logid","Map":"Kaart","measure":"Mõõda","Measure":"Mõõda","Measure angle and distance":"Mõõda asimuuti ja vahemaad","Measure distance and area. Click to last point finish measurement. Click to first point calculates area.":"Mõõda vahemaad ja pindala. Klikk viimasele punktile lõpetab mõõtmise. Klikk esimesele punktile arvutab pindala.","Micro":"Mikro","Missing LAYERS parameter":"WMS aadress peab sisaldama LAYERS parameetrit","Missing provider, aborting!":"Puudub teenus!","Missing SRS parameter":"WMS aadress peab sisaldama SRS parameetrit","mouseposition":"Koordinaadid","My location":"Asukoht","Navigate to cache with two tracking mode":"Asukoha näitamine kahes režiimis (asukoht liigub ekraanil; asukoht on ekraanil fikseeritud).","NB! Turning this off and sharing bookmark will store possibly big amount of data in service. It might fail. Use with caution!":"NB! Ei soovita seda välja lülitada, järjehoidja salvestamisel võidakse saata teenusesse suur hulk andmeid!","New Cache":"Uued aarded","No baselyers added":"Pole aluskaarte","No caches to add!":"Aarded puuduvad!","No overlays added":"Pole kaardikihte","No result":"Otsingutulemused puuduvad","No route between start and destination":"Teekond alguse ja sihtpunkti vahel puudub","No valid input coordinates, aborting!":"Sisendkoordinaadid ei vasta nõuetele, ei otsi!","North up!":"Põhi!","Not Found":"Leidmata","Not valid GeoJSON":"Ei ole korrektne GeoJSON","Off":"Off","On":"On","Optimize":"Optimeeri","or":"või","or open":"või ava","Overwrite":"Kirjuta üle","Overwrite will delete old geocaches when import new caches from file.":"Kirjuta üle - uute aarete importimisel vanad aarded kustutatakse.","Owner":"Omanik","Query string empty, aborting!":"Otsingutekst puudu, ei otsi!","Query string too short, aborting!":"Otsingutekst liiga lühike, ei otsi!","Quick links":"Kiirviited","Radius":"Raadius","Regular":"Normaalne","Reset":"Lähtesta","Reset app":"Rakenduse vaikeseaded","Reset app to default. App will reload!":"Taasta rakenduse vaikeseaded. Rakendus taaskäivitub peale muutmist!","Retry directions":"Uuesti","Routing":"Teekond","Routing disabled":"Teekonna leidmine keelatud","Routing input test failed, aborting!":"Teekonna sisendid ei ole õiged!","routinginfo":"Teekond","scaleline":"Joonmõõtkava","Search":"Otsi","Search and display coordinates in WGS, L-Est, UTM and MGRS system.":"Otsi ja kuva koordinaate WGS, L-Est, UTM ja MGRS koordinaatsüsteemides.","Search coordinates":"Otsi koordinaate","Select geocache from map":"Vali kaardilt aare","Select routing profile or disable routing":"Vali teekonna profiil või keela teekond","Set a method, how cache import works.":"Vali meetod, kuidas aardeid imporditakse.","Settings":"Seaded","Share":"Jaga","Share bookmark":"Jaga järjehoidjat","Share only features added to geotrip.":"Jaga ainult objekte, mis on lisatud geotuurile.","Share only geotrip features":"Jaga ainult geotuuri","Share snapshot of app state via link or QR-code. Download geotrip as GPX-file.":"Jaga kaardivaadet lingi või QR-koodiga. Ekspordi geotripp GPX-failina.","Show 160m radius":"Näita 160m raadiuseid","Show distance and duration along route, not from beginning to end":"Kuva teekonna pikkus ja aeg mööda teekonda, mitte linnulennult","Small":"Väike","Street view":"Tänavavaade","The request to get user location timed out.":"Asukoha päring ebaõnnestus.","to finish, click on beginning":"lõpetamiseks vajuta algusesse","to finish, click on end":"lõpetamiseks vajuta viimasele","Toggle fullscreen":"Täisekraan","Too Many Requests":"Päringute limiit on täis","Topo":"Põhikaart","Unable to copy to clipboard":"Ei saanud kopeerida","Unable to delete bookmark":"Ei saanud järjehoidjat kustutada!","Unable to determine ordering":"Ei saa järjekorda määrata!","Unable to find layer extent":"Ei leia kihi ulatust","Unable to find location.":"Ei leia asukohta!","Unable to find route":"Ei leia teekonda","Unable to get routing result":"Tulemus puudub!","Unable to load bookmark":"Ei saanud järjehoidjat laadida!","Unable to perform search!":"Otsing luhtus!","Unable to save bookmark":"Ei saanud järjehoidjat salvestada!","Unavailable":"Ajutiselt kättesaamatud","Unknown":"Teadmata","Unsupported file type":"Seda faili ei toeta hetkel","URL":"URL","URL is not valid WMS resource!":"URL ei ole õige!","User denied the request for Geolocation.":"Kasutaja tühistas päringu.","Username":"Kasutajanimi","Waypoint|Final Location":"Lõpp-punkt","Waypoint|Parking Area":"Parkla","Waypoint|Physical Stage":"Vahepunkt","Waypoint|Reference Point":"Lisapunkt","Waypoint|Stages of a Multicache":"Vahepunkt","Waypoint|Trailhead":"Matkaraja algus","Waypoint|Virtual Stage":"Virtuaalne vahepunkt","Zoom in":"Suurenda","Zoom out":"Vähenda"}}')},356:function(e,t,n){var o=n(233);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(233,(function(){var t=n(233);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},360:function(e,t,n){var o=n(236);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(236,(function(){var t=n(236);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},388:function(e,t,n){var o=n(241);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(241,(function(){var t=n(241);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},389:function(e,t,n){var o=n(242);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(242,(function(){var t=n(242);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},390:function(e,t,n){var o=n(243);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(243,(function(){var t=n(243);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},391:function(e,t,n){var o=n(244);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(244,(function(){var t=n(244);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},392:function(e,t,n){var o=n(245);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(245,(function(){var t=n(245);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},393:function(e,t,n){var o=n(246);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(246,(function(){var t=n(246);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},395:function(e,t,n){var o=n(249);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(249,(function(){var t=n(249);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},396:function(e,t,n){var o=n(250);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(250,(function(){var t=n(250);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},397:function(e,t,n){var o=n(251);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(251,(function(){var t=n(251);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},399:function(e,t,n){var o=n(252);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(252,(function(){var t=n(252);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},400:function(e,t,n){var o=n(253);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(253,(function(){var t=n(253);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},401:function(e,t,n){var o=n(254);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(254,(function(){var t=n(254);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},402:function(e,t,n){var o=n(255);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(255,(function(){var t=n(255);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},403:function(e,t,n){var o=n(256);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(256,(function(){var t=n(256);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},404:function(e,t,n){var o=n(257);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(257,(function(){var t=n(257);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},405:function(e,t,n){var o=n(258);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(258,(function(){var t=n(258);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},406:function(e,t,n){var o=n(259);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(259,(function(){var t=n(259);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},407:function(e,t,n){var o=n(260);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(260,(function(){var t=n(260);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},408:function(e,t,n){var o=n(261);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(261,(function(){var t=n(261);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},409:function(e,t,n){var o=n(262);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(262,(function(){var t=n(262);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},410:function(e,t,n){var o=n(263);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(263,(function(){var t=n(263);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},411:function(e,t,n){var o=n(264);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(264,(function(){var t=n(264);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},412:function(e,t,n){var o=n(265);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(265,(function(){var t=n(265);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},413:function(e,t,n){var o=n(266);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0},a=n(40)(o,r);o.locals&&(e.exports=o.locals),e.hot.accept(266,(function(){var t=n(266);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,o=0;for(n in e){if(!t||e[n]!==t[n])return!1;o++}for(n in t)o--;return 0===o}(o.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");a(t)})),e.hot.dispose((function(){a()}))},414:function(e,t,n){"use strict";n.r(t),n.d(t,"reloadApp",(function(){return ks}));n(121),n(39),n(38),n(42),n(25),n(273),n(98),n(16),n(20),n(73),n(23),n(24),n(18),n(19),n(229),n(63),n(55),n(343);var o=n(299),r=n.n(o),a=n(300),i=n.n(a),c=n(53),s=n(190);n(282);function l(e){return function(e){for(var t=2,n="",o=e.length,r=0,a=0;a<o;a++)t=a%3,a>0&&4*a/3%76==0&&(n+="\r\n"),r|=e[a]<<(16>>>t&24),2!==t&&e.length-a!=1||(n+=String.fromCharCode(u(r>>>18&63),u(r>>>12&63),u(r>>>6&63),u(63&r)),r=0);return n.substr(0,n.length-2+t)+(2===t?"":1===t?"=":"==")}(function(e){for(var t,n,o=e.length,r=0,a=0;a<o;a++)n=e.charCodeAt(a),r+=n<128?1:n<2048?2:n<65536?3:n<2097152?4:n<67108864?5:6;t=new Uint8Array(r);for(var i=0,c=0;i<r;c++)(n=e.charCodeAt(c))<128?t[i++]=n:n<2048?(t[i++]=192+(n>>>6),t[i++]=128+(63&n)):n<65536?(t[i++]=224+(n>>>12),t[i++]=128+(n>>>6&63),t[i++]=128+(63&n)):n<2097152?(t[i++]=240+(n>>>18),t[i++]=128+(n>>>12&63),t[i++]=128+(n>>>6&63),t[i++]=128+(63&n)):n<67108864?(t[i++]=248+(n>>>24),t[i++]=128+(n>>>18&63),t[i++]=128+(n>>>12&63),t[i++]=128+(n>>>6&63),t[i++]=128+(63&n)):(t[i++]=252+n/1073741824,t[i++]=128+(n>>>24&63),t[i++]=128+(n>>>18&63),t[i++]=128+(n>>>12&63),t[i++]=128+(n>>>6&63),t[i++]=128+(63&n));return t}(e))}function u(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var p=new r.a,d=[];function h(e){return new Promise((function(t,n){try{var o=document.createElement("textarea");o.value=e,o.style.position="absolute",o.style.left="-9999px",document.body.appendChild(o),o.select();var r=document.execCommand("copy");document.body.removeChild(o),r?t():n(Error(r))}catch(e){n(e)}}))}function y(e,t){!function(e,t){var n=document.createEvent("MouseEvent"),o=document.createElement("a");n.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.setAttribute("href",t),o.setAttribute("download",e),o.dispatchEvent(n)}(e,"data:text/gpx+xml;base64,"+l('<?xml version="1.0" encoding="utf-8"?>'+(new s.a).writeFeatures(t)))}function g(){p.enable(),document.removeEventListener("click",g,!1)}function m(e){return 360*e/(2*Math.PI)}function b(e){return e*Math.PI*2/360}function v(e){return 1/Math.cos(b(e[1]))}function w(e){if(e&&e.length>1)try{return JSON.parse('{"'+e.slice(1).replace(/&/g,'","').replace(/=/g,'":"')+'"}',(function(e,t){return""===e?t:decodeURIComponent(t)}))}catch(e){return null}}function k(e){var t=e.match(/^(?:(https?:)\/\/)?(([^:/?#]*)(?::([0-9]+))?)([/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);return t&&{href:e,protocol:t[1],host:t[2],hostname:t[3],port:t[4],pathname:t[5],search:t[6],hash:t[7],query:w(t[6])||{}}}function A(e){var t=Object.keys(e.query).map((function(t){return t+"="+e.query[t]})).join("&");return e.protocol+"//"+e.host+e.pathname+"?"+t}function S(){return Math.random().toString(36).substr(2,10)}function O(e,t){var n;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return 3===(n=e.substring(1).split("")).length&&(n=[n[0],n[0],n[1],n[1],n[2],n[2]]),"rgba("+[(n="0x"+n.join(""))>>16&255,n>>8&255,255&n].join(",")+","+t+")";throw new Error("Bad Hex")}function j(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[2,2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t||(t=Object(c.c)(e));var r="km";if(t>1e4){var a=Math.pow(10,n[0]);t=Math.round(t/1e3*a)/a}else{var i=Math.pow(10,n[1]);t=Math.round(t*i)/i,r="m"}return o?[t,r]:"".concat(t," ").concat(r)}function x(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[2,2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t||(t=Object(c.a)(e));var r="km<sup>2</sup>";if(t>1e6){var a=Math.pow(10,n[0]);t=Math.round(t/1e6*a)/a}else{var i=Math.pow(10,n[0]);t=Math.round(t*i)/i,r="m<sup>2</sup>"}return o?[t,r]:"".concat(t," ").concat(r)}function C(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Date(e),o=(1+n.getMonth()).toString();o=o.length>1?o:"0"+o;var r=n.getDate().toString();return r=r.length>1?r:"0"+r,t?r+"."+o:n.getFullYear()+"."+o+"."+r}function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"timestamp",n=null;switch(t){case"timestamp":n=new Date(e).toTimeString().slice(0,8);break;case"seconds":var o=Math.floor(e/60/60),r=Math.floor(60*(e/60/60-o)),a=Math.floor(60*(60*(e/60/60-o)-r));n="".concat(o,"h ").concat(r,"m ").concat(a,"s")}return n}function P(e){return JSON.parse(JSON.stringify(e))}function E(e,t){var n=m(Math.atan2(t[0]-e[0],t[1]-e[1]));return n<0&&(n=360+n),n}var _=!0,T={oldURL:null,newURL:null,hash:null},M=[];function L(e){var t={};return e&&e.slice(1).split("&").forEach((function(e){var n=e.split("=");t[n[0]]=n[1]})),t}function G(e){return e?T.hash[e]:T.hash}function F(e){if(_){var t;if(e){var n=Object.assign(T.hash,e);Object.keys(n).forEach((function(e){null!==n[e]&&void 0!==n[e]||delete n[e]})),T.hash=n,t=function(e){return"#"+Object.keys(e).map((function(t){return t+"="+e[t]})).join("&")}(T.hash)}else T.hash=e,t=" ";window.history.pushState(T.hash,"geop",t)}else _=!0}function D(e){M.push(e)}function N(e){return[Math.round(1e5*e.center[1])/1e5,Math.round(1e5*e.center[0])/1e5,Math.round(100*e.zoom)/100,parseInt(e.rotation),e.baseLayer].join("/")}var I={locale:"et",layerManager:!0,searchEnabled:!0,locateEnabled:!0,mouseCoordinates:!0,settings:!0,tooltip:!0,featureInfo:!0,scaleLine:!0,streetView:!0,measureTool:!0,fullScreen:!0,screenLock:!0,mousePosition:!0,geoLocation:!0,shareState:!0,shareOnlyTripFeatures:!0,settingsTabOpen:"settings-tab",debug:!1,debugFile:"geop_debug.log",nominatimCountries:"ee",routing:{provider:"openrouteservice",profile:"driving"}},U={el:"#map",center:[25.5,58.5],zoom:7,rotation:0,extent:[21,57,29,60],projection:"EPSG:3857",baseLayer:"osm",minZoom:0,maxZoom:20,clustered:!1},q={ideditor:"https://www.openstreetmap.org/edit?editor=id#background=custom:http://tiles.maaamet.ee/tm/tms/1.0.0/foto@GMC/{z}/{x}/{-y}.png&map=",nominatim:"https://nominatim.openstreetmap.org",jsonstore:"https://projekt-gp.ee/api/v1/bookmark",qrcode:"http://api.qrserver.com/v1/create-qr-code/?size=150x150&data=",osrm:{directions:"https://router.project-osrm.org/route/v1/"},openrouteservice:{key:"5b3ce3597851110001cf624801b177c2b8ea4b76a5f0b724b5fe6067",directions:"https://api.openrouteservice.org/v2/directions/",optimize:"https://api.openrouteservice.org/optimization/"},google:{streetview:"https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=",directions:"https://www.google.com/maps/dir/?api=1&destination="},wmsexamples:{"Kataster (WMS)":"http://kaart.maaamet.ee/wms/alus?layers=TOPOYKSUS_6569,TOPOYKSUS_7793&SRS=EPSG:3301&title=Kataster","Looduskaitse (WMS)":"https://gsavalik.envir.ee/geoserver/eelis/ows?layers=kr_kaitseala,kr_hoiuala,kr_hooldatav_skv,kr_looduslik_skv,kr_reservaat,kr_vep,plk,kr_kohalik_objekt_pv,kr_yksikobjekti_kaitsetsoon,kr_kohalik_objekt,kr_yksikobjektid&SRS=EPSG:3301&opacity=0.9&title=Looduskaitse","Pärandkultuur (WMS)":"https://gsavalik.envir.ee/geoserver/eelis/ows?layers=pk_objekt_metsas&SRS=EPSG:3301&title=Pärandkultuur","LV foto (WMS)":"https://wmsbm3.kartes.lv/BMdMiAsVp/wgs/orto/?title=LV orto&layers=0&srs=EPSG:3857","LV kaart (WMS)":"https://wmsbm3.kartes.lv/BMdMiAsVp/wgs/15/?title=LV&layers=0&srs=EPSG:3857","Soome kaart (WMTS)":"https://mapservices-a.navici.com/basemaps/gwc/service/wmts?apikey=gdqWSTM10Le9XVAX8B6vFKxnpZAmTx5x&title=Soome kaart&layer=basemaps:rk&srs=EPSG:3067&matrixSet=ETRS-TM35FIN&matrixTemplate=ETRS-TM35FIN:{z}&scaleDenominator=2.925714285714286E7&topLeftCorner=-2097152,9437184&matrixWidth=3&matrixHeight=2&format=image/png8","Soome foto (WMTS)":"https://www.retkikartta.fi/wmts/30c616a00f157e7357721900e8b0415c/?srs=EPSG:3067&title=Soome foto&format=image/jpeg&layer=ortokuva&matrixSet=ETRS-TM35FIN&scaleDenominator=29257142.85714286&matrixWidth=1&matrixHeight=1&topLeftCorner=-548576,8388608"}},W={authUrl:"https://geopeitus.ee",downloadUrl:{page:"https://www.geopeitus.ee/index.php?p=300",geojson:"https://www.geopeitus.ee/index.php?p=301&status[]=1&format=2",gpx:{gpxActive:"https://www.geopeitus.ee/index.php?p=301&status[]=1&status[]=3&format=1",gpxActiveLogs:"https://www.geopeitus.ee/index.php?p=301&status[]=1&status[]=3&format=1&gpx_events=2",gpxAll:"https://www.geopeitus.ee/index.php?p=301&status[]=1&status[]=2&status[]=3&format=1"}},cacheUrl:"https://geopeitus.ee/aare/",logUrl:{"geopeitus.ee":"https://www.geopeitus.ee/logs/new/c/{id}","geocaching.com":"https://www.geocaching.com/seek/log.aspx?ID={id}&lcn=1","coord.info":"https://www.geocaching.com/play/geocache/{id}/log"},radiusStyle:{maxResolution:30,radius:160},newCacheDays:30,waypointMaxResolution:10,overviewMinResolution:100,exportFileName:"geop.gpx",mapping:{fstatusJSON:{0:"Not Found",1:"Found",2:"Owner"},fstatusGPX:{Geocache:"Not Found","Geocache Found":"Found","Geocache Owner":"Owner"},type:{"Tavaline aare":"Geocache|Traditional Cache",Multiaare:"Geocache|Multi-cache","Mõistatusaare":"Geocache|Unknown Cache","Väljakutse-aare":"Geocache|Unknown Cache|Challenge",Kirjakastiaare:"Geocache|Letterbox Hybrid","Virtuaalne aare":"Geocache|Virtual Cache",Veebikaamera:"Geocache|Webcam Cache","Asukohata (tagurpidi) aare":"Geocache|Locationless Cache","KusMaLäen":"Geocache|Wherigo Cache","Maa-aare":"Geocache|Earthcache","Sündmusaare":"Geocache|Event Cache"},container:{mikro:"Micro","väike":"Small",normaalne:"Regular",suur:"Large",muu:"Unknown"}},filter:{fstatus:"fstatusGPX",type:"type",status:["Available","Unavailable","Archived"],newCache:["New Cache"]},styles:{base:{text:"",class:"fas fa-map-marker-alt",font:'900 16px "Font Awesome 5 Free"',textBaseline:"middle",fill:{color:"#aaa"},stroke:{color:"#fff",width:4}},overview:{text:"",class:"fa fa-circle",font:'900 8px "Font Awesome 5 Free"',stroke:{color:"#fff",width:2}},text:{"Geocache|Traditional Cache":{text:"",class:"fa fa-cube",font:'900 13px "Font Awesome 5 Free"'},"Geocache|Multi-cache":{text:"",class:"fa fa-cubes",font:'900 16px "Font Awesome 5 Free"'},"Geocache|Webcam Cache":{text:"",class:"fa fa-camera",font:'900 12px "Font Awesome 5 Free"'},"Geocache|Virtual Cache":{text:"",class:"fa fa-wifi",font:'900 12px "Font Awesome 5 Free"'},"Geocache|Event Cache":{text:"",class:"fa fa-calendar-check-o",font:'900 12px "Font Awesome 5 Free"'},"Geocache|Locationless Cache":{text:"",class:"fa fa-refresh",font:'900 12px "Font Awesome 5 Free"'},"Geocache|Unknown Cache":{text:"",class:"fa fa-question-circle",font:'900 13px "Font Awesome 5 Free"'},"Geocache|Unknown Cache|Challenge":{text:"",class:"fa fa-exclamation-circle",font:'900 13px "Font Awesome 5 Free"'},"Geocache|Letterbox Hybrid":{text:"",class:"fa fa-envelope",font:'900 12px "Font Awesome 5 Free"'},"Geocache|Wherigo Cache":{text:"",class:"fa fa-arrow-circle-right",font:'900 12px "Font Awesome 5 Free"'},"Geocache|Earthcache":{text:"",class:"fa fa-globe-africa",font:'900 13px "Font Awesome 5 Free"'},"Waypoint|Parking Area":{text:"",class:"fas fa-parking",font:'900 12px "Font Awesome 5 Free"'},"Waypoint|Reference Point":{text:"",class:"far fa-arrow-alt-circle-down",font:'900 12px "Font Awesome 5 Free"'},"Waypoint|Stages of a Multicache":{text:"",class:"fas fa-plus-circle",font:'900 12px "Font Awesome 5 Free"'},"Waypoint|Physical Stage":{text:"",class:"fas fa-plus-circle",font:'900 12px "Font Awesome 5 Free"'},"Waypoint|Virtual Stage":{text:"",class:"fas fa-plus-circle",font:'900 12px "Font Awesome 5 Free"'},"Waypoint|Final Location":{text:"",class:"far fa-times-circle",font:'900 12px "Font Awesome 5 Free"'},"Waypoint|Trailhead":{text:"",class:"far fa-hiking",font:'900 12px "Font Awesome 5 Free"'}},color:{"Not Found":{fill:{color:"#444"}},Found:{fill:{color:"#4c9900"}},Owner:{fill:{color:"#f00"}}},newCache:{"New Cache":{stroke:{color:"#ffff00",width:4}}},radiusStyle:{fill:{color:"rgba(255, 0, 0, 0.1)"}}}},V={base:[{id:"osm",type:"XYZ",title:"OSM",url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png",projection:"EPSG:3857",crossOrigin:null},{id:"photo",type:"Bing",title:"Aerial",key:"AozX0lfGO2nv-11kPOU6_BKWeJwgfAcyFQAXAwXQmnQtSJahtmYj8ZJ3JAzk36Z4",projection:"EPSG:3857",imagerySet:"AerialWithLabels",maxZoom:19},{id:"makaart",type:"Group",title:"Map",projection:"EPSG:3301",layers:[{type:"XYZ",projection:"EPSG:3857",url:"https://tiles.maaamet.ee/tm/tms/1.0.0/kaart@GMC/{z}/{x}/{-y}.png",minResolution:.5,crossOrigin:null},{type:"TileWMS",url:"https://kaart.maaamet.ee/wms/kaart",params:{LAYERS:"MA-KAART",TILED:!0,FORMAT:"image/png",VERSION:"1.1.1"},maxResolution:.75,tileSize:1024,gutter:20,crossOrigin:null}]},{id:"mapkaart",type:"Group",title:"Topo",projection:"EPSG:3301",layers:[{type:"XYZ",projection:"EPSG:3857",url:"https://tiles.maaamet.ee/tm/tms/1.0.0/kaart@GMC/{z}/{x}/{-y}.png",minResolution:7.1,crossOrigin:null},{type:"XYZ",url:"https://tiles.maaamet.ee/tm/tms/1.0.0/reljeef@LEST/{z}/{x}/{-y}.png",minResolution:7.1,crossOrigin:null,opacity:.5},{type:"XYZ",url:"https://tiles.maaamet.ee/tm/tms/1.0.0/epk_vv@LEST/{z}/{x}/{-y}.png",minResolution:.9765625,maxResolution:7.1,crossOrigin:null},{type:"TileWMS",url:"https://kaart.maaamet.ee/wms/alus",params:{LAYERS:"pohi_vv",TILED:!0,FORMAT:"image/png",VERSION:"1.1.1"},maxResolution:.9765625,tileSize:1024,gutter:20,crossOrigin:null}]},{id:"maorto",type:"Group",title:"Aerial Estonia",projection:"EPSG:3301",layers:[{type:"XYZ",projection:"EPSG:3857",url:"https://tiles.maaamet.ee/tm/tms/1.0.0/foto@GMC/{z}/{x}/{-y}.png",minResolution:.5,crossOrigin:null},{type:"TileWMS",url:"https://kaart.maaamet.ee/wms/fotokaart",params:{LAYERS:"EESTIFOTO",TILED:!0,FORMAT:"image/png",VERSION:"1.1.1"},maxResolution:.75,tileSize:1024,gutter:20,crossOrigin:null}]},{id:"okaart",type:"XYZ",title:"O-kaart",url:"https://okaart.osport.ee/{z}/{x}/{y}.png",projection:"EPSG:3857",crossOrigin:null},{id:"tf_outdoors",type:"XYZ",title:"Outdoors",url:"https://tile.thunderforest.com/outdoors/{z}/{x}/{y}.png?apikey=bc215709c53e44c9b78c1bcbe825af07",projection:"EPSG:3857",crossOrigin:null}],layers:[],overlays:[]},z=(n(35),n(231),n(232),n(87),n(176));function B(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function J(e,t,n,o,r,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}var Y={},Z={},X=!!window.indexedDB;function K(){return new Promise((function(e,t){if(X)try{Object(z.c)().then(function(){var t,n=(t=regeneratorRuntime.mark((function t(n){var o,r,a,i,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o={},r=B(n),t.prev=2,r.s();case 4:if((a=r.n()).done){t.next=12;break}return i=a.value,t.next=8,Object(z.b)(i);case 8:null!=(c=t.sent)&&(o[i]=c);case 10:t.next=4;break;case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(2),r.e(t.t0);case 17:return t.prev=17,r.f(),t.finish(17);case 20:e(P(o));case 21:case"end":return t.stop()}}),t,null,[[2,14,17,20]])})),function(){var e=this,n=arguments;return new Promise((function(o,r){var a=t.apply(e,n);function i(e){J(a,o,r,i,c,"next",e)}function c(e){J(a,o,r,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}())}catch(e){t(e)}else t(new Error("Storage is not available"))}))}function Q(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Y[e]=t,n&&X?Object(z.d)(e,t).then((function(){e in Z&&Z[e].forEach((function(t){return t(Y[e])}))})):e in Z&&Z[e].forEach((function(t){return t(Y[e])}))}function $(e){return Y[e]}function ee(e,t){e in Z||(Z[e]=[]),-1===Z[e].indexOf(t)&&Z[e].push(t)}function te(){Object(z.a)()}n(29),n(168),n(6),n(30),n(7),n(56),n(70);function ne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var re=function(){function e(t){ne(this,e),this.target=t,this.el=null,this.state={},this.create(),this.components={}}var t,n,o;return t=e,(n=[{key:"create",value:function(){this.target&&this.el&&(this.target.append(this.el),this.render())}},{key:"render",value:function(){}},{key:"renderComponents",value:function(){}},{key:"getComponent",value:function(e){return this.components[e]}},{key:"getEl",value:function(){return this.el}},{key:"set",value:function(e,t){this.state[e]=t}},{key:"get",value:function(e){return this.state[e]}},{key:"destroy",value:function(){var e=this;Object.keys(this.components).forEach((function(t){return e.components[t].destroy()})),this.components={},this.el.remove()}}])&&oe(t.prototype,n),o&&oe(t,o),e}(),ae={locale:null,texts:{}};function ie(e,t){e&&e in t&&(ae.texts=t,ae.locale=e),Q("app/locale",ae.locale,!0)}function ce(e){return e in ae.texts[ae.locale]?ae.texts[ae.locale][e]:e}var se=n(162);function le(e,t,n){switch(e){case"success":!function(e,t){se.a.success(e,"",void 0,t)}(t);break;case"info":!function(e,t){se.a.info(e,"",void 0,t)}(t);break;case"warning":!function(e,t){se.a.warn(e,"",void 0,t)}(t);break;case"error":!function(e,t){se.a.error(e,"",void 0,t)}(t)}"function"==typeof n&&setTimeout(n,4e3)}se.a.init({timeout:4e3});var ue=n(5),fe=n.n(ue),pe=n(172),de=n.n(pe),he=n(301),ye=n.n(he);n(356);function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function be(e){return function(e){if(Array.isArray(e))return ve(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ve(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function we(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function ke(e,t,n){return(ke="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=je(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Ae(e,t){return(Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=je(e);if(t){var r=je(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Oe(this,n)}}function Oe(e,t){return!t||"object"!==ge(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(a,e);var t,n,o,r=Se(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()('\n      <div class="btn-group"></div>\n    '),t.modal=fe()("#modal_bookmark"),t.state={bookmarks:$("app/bookmarks")||[],bookmark:G("b")},t.create(),t.el.on("click","button.share",(function(e){e.preventDefault(),t.share()})),t.el.on("click","li",(function(e){e.preventDefault(),t.openModal(fe()(e.currentTarget).data("id"))})),t.el.on("click","li .tools a.remove",(function(e){e.preventDefault(),e.stopPropagation(),t.delete(fe()(e.currentTarget).closest("li").data("id"))})),t.modal.on("click","button.copy",(function(e){t.copy(fe()(e.target).closest(".modal").find("input").val())})),D((function(e){t.state.bookmark!==e.b&&ks()})),t}return t=a,(n=[{key:"render",value:function(){this.modal&&0!==this.modal.length||(this.modal=fe()('\n        <div class="modal fade"\n          id="modal_bookmark">\n          <div class="modal-dialog">\n            <div class="modal-content">\n              <div class="modal-header">\n                <h4 class="modal-title">'.concat(ce("Share bookmark"),'</h4>\n                <button type="button"\n                  class="close"\n                  data-dismiss="modal"\n                  aria-label="Close">\n                  <span aria-hidden="true">&times;</span>\n                </button>\n              </div>\n              <div class="modal-body text-muted">\n                <div class="input-group mb-5">\n                  <input type="text" class="form-control" name="bookmark" readonly>\n                  <div class="input-group-append">\n                    <button class="btn btn-secondary copy" type="button">\n                      <i class="far fa-clone"></i>\n                    </button>\n                    <a class="btn btn-secondary go" href="#" target="_blank">\n                      <i class="fas fa-link"></i>\n                    </a>\n                  </div>\n                </div>\n                <div class="mb-5 text-center display-4">\n                  ').concat(ce("or"),'\n                </div>\n                <div class="mb-5 text-center">\n                  <canvas class="rounded mx-auto d-block img-thumbnail"></canvas>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      ')),fe()("body").append(this.modal)),this.el.html('\n      <div class="btn-group dropup">\n        <button type="button" class="btn btn-secondary share" title="'.concat(ce("Share"),'">\n          <i class="fas fa-share-alt"></i>\n        </button>\n        <button ').concat(this.state.bookmarks.length?"":"disabled",'\n          type="button"\n          class="btn btn-secondary dropdown-toggle dropdown-toggle-split"\n          data-toggle="dropdown">\n        </button>\n        <div class="dropdown-menu dropdown-menu-right">\n          ').concat(this.state.bookmarks.map((function(e){return'\n            <li\n              class="dropdown-item"\n              data-id="'.concat(e,'">\n              <i class="fas fa-star"></i>\n              ').concat(e,'\n              <div class="tools">\n                <a href="#" class="remove">\n                  <i class="fa fa-times"></i>\n                </a>\n              </div>\n            </li>')})).join(""),"\n        </div>\n      </div>\n    "))}},{key:"share",value:function(){var e=this,t=$("app/debug");new Promise((function(e,t){K().then(e).catch(t)})).then((function(n){var o;(o=n,new Promise((function(e,t){Ce&&"function"==typeof Ce.abort&&Ce.abort();var n=S();Ce=fe.a.ajax({type:"POST",crossDomain:!0,url:q.jsonstore+"/"+n,data:JSON.stringify({state:JSON.stringify(de.a.pack(Re("up",o)))}),dataType:"json",contentType:"application/json; charset=utf-8"}).done((function(o){o&&o.ok?e(n):t(new Error("Unable to save bookmark"))})).fail((function(n){"abort"===n.statusText?e(null):t(new Error("Unable to save bookmark"))}))}))).then((function(n){e.state.bookmarks.push(n),Q("app/bookmarks",e.state.bookmarks,!0),e.render(),e.openModal(n),t&&console.debug("Bookmark saved: "+n)})).catch((function(e){le("error",ce(e.message)),t&&console.error("Bookmark error [setBookmarkState]: "+JSON.stringify(e))}))})).catch((function(e){le("error",ce(e.message)),t&&console.error("Bookmark error [getSessionState]: "+JSON.stringify(e))}))}},{key:"copy",value:function(e){h(e).then((function(){le("success","".concat(ce("URL")," ").concat(e," ").concat(ce("copied to clipboard")))})).catch((function(){le("error",ce("Unable to copy to clipboard"))}))}},{key:"delete",value:function(e){var t,n=this,o=$("app/debug");(t=e,new Promise((function(e,n){Ce&&"function"==typeof Ce.abort&&Ce.abort(),Ce=fe.a.ajax({type:"DELETE",crossDomain:!0,url:q.jsonstore+"/"+t,dataType:"json",contentType:"application/json; charset=utf-8"}).done((function(t){t&&t.ok?e():n(new Error("Unable to delete bookmark"))})).fail((function(t){"abort"===t.statusText?e(null):n(new Error("Unable to delete bookmark"))}))}))).then((function(){n.state.bookmarks=n.state.bookmarks.filter((function(t){return t!==e})),Q("app/bookmarks",n.state.bookmarks,!0),n.render(),le("success","".concat(ce("Bookmark deleted!"))),o&&console.debug("Bookmark deleted: "+e)})).catch((function(e){le("error",ce(e.message)),o&&console.error("Bookmark error [deleteBookmarkState]: "+JSON.stringify(e))}))}},{key:"bookmarkUrl",value:function(e){return window.location.origin+window.location.pathname+"#b="+e}},{key:"openModal",value:function(e){this.modal.find("input").val(this.bookmarkUrl(e)),this.modal.find("a.go").attr("href",this.bookmarkUrl(e)),new ye.a({element:this.modal.find("canvas")[0],size:200}).value=this.bookmarkUrl(e),this.modal.modal()}},{key:"destroy",value:function(){this.modal.modal("dispose"),this.modal.remove(),this.modal=null,ke(je(a.prototype),"destroy",this).call(this)}}])&&we(t.prototype,n),o&&we(t,o),a}(re),Ce=null;function Re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"down",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o={};switch(e){case"up":"app_bookmarks"in(o=P(Object.assign.apply(Object,[{}].concat(be(Object.keys(t).map((function(e){return me({},e.replace(/\//g,"_"),t[e])})))))))&&delete o.app_bookmarks,"app_bookmark_loaded"in o&&delete o.app_bookmark_loaded,$("app/shareOnlyTripFeatures")&&"geocache_trip_ids"in o&&(o.layer_layers&&o.layer_layers.forEach((function(e){e.features=e.features?e.features.filter((function(e){return o.geocache_trip_ids.indexOf(e.id)>-1})):[]})),o.layer_overlays&&o.layer_overlays.forEach((function(e){e.features=e.features?e.features.filter((function(e){return o.geocache_trip_ids.indexOf(e.id)>-1})):[]})));break;case"down":o=P(Object.assign.apply(Object,[{}].concat(be(Object.keys(t).map((function(e){return me({},e.replace(/_/g,"/"),t[e])})))))),n&&(o["app/bookmark/loaded"]=n);break;default:o=t}return o}function Pe(e){return new Promise((function(t,n){Ce&&"function"==typeof Ce.abort&&Ce.abort(),Ce=fe.a.ajax({type:"GET",crossDomain:!0,url:q.jsonstore+"/"+e,dataType:"json",contentType:"application/json; charset=utf-8"}).done((function(o){if(o&&o.ok&&o.result&&o.result.state){var r=Re("down",de.a.unpack(o.result.state),e);t(r)}else n(new Error("Unable to load bookmark"))})).fail((function(e){"abort"===e.statusText?t(null):n(new Error("Unable to load bookmark"))}))}))}var Ee=xe;function _e(e,t,n,o,r,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function Te(){return new Promise(function(){var e,t=(e=regeneratorRuntime.mark((function e(t,n){var o,r,a,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={},r=G("b"),e.prev=2,e.next=5,K();case 5:if(a=e.sent,!r||!r.length){e.next=12;break}return e.next=9,Pe(r);case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0={};case 13:i=e.t0,e.next=20;break;case 16:e.prev=16,e.t1=e.catch(2),a={},i={};case 20:Object.keys(I).forEach((function(e){o["app/"+e]=I[e]})),Object.keys(U).forEach((function(e){o["map/"+e]=U[e]})),Object.keys(V).forEach((function(e){o["layer/"+e]=V[e]})),c=Object.assign({},o,a,i),"onhashchange"in window||(c["app/shareState"]=!1),Object.keys(c).forEach((function(e){Q(e,c[e])})),t(c);case 27:case"end":return e.stop()}}),e,null,[[2,16]])})),function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){_e(a,o,r,i,c,"next",e)}function c(e){_e(a,o,r,i,c,"throw",e)}i(void 0)}))});return function(e,n){return t.apply(this,arguments)}}())}n(358),n(359),n(360),n(361),n(362),n(363),n(364),n(365),n(367);var Me=n(302),Le=(n(95),n(205)),Ge=n(314),Fe=n(312),De=n(157),Ne=n(304),Ie=n(305),Ue=n(313),qe=n(316),We=n(174),Ve=n(315),ze=n(311),Be=n(79),He=n(2),Je=n(1),Ye=n(141),Ze=n(202),Xe=(n(115),n(84)),Ke=n(90),Qe=n(160),$e=n(175),et=n(173),tt=n(93),nt=n(197);function ot(e){var t={};return e?Object.keys(e).forEach((function(n){switch(n){case"stroke":t[n]=new Ke.a(e[n]);break;case"fill":t[n]=new Xe.a(e[n]);break;case"image":case"circle":t.image=new Qe.a({fill:e[n].fill&&new Xe.a(e[n].fill),stroke:e[n].stroke&&new Ke.a(e[n].stroke),radius:e[n].radius||5});break;case"shape":e[n].fill&&(e[n].fill=new Xe.a(e[n].fill)),e[n].stroke&&(e[n].stroke=new Ke.a(e[n].stroke)),t.image=new nt.a(e[n]);break;case"icon":t.image=new $e.a(e[n]);break;case"text":e[n].fill&&(e[n].fill=new Xe.a(e[n].fill)),e[n].stroke&&(e[n].stroke=new Ke.a(e[n].stroke)),t[n]=new et.a(e[n]);break;default:t[n]=e[n]}}),this):t=function(){var e={fill:new Xe.a({color:"rgba(255,255,255,0.4)"}),stroke:new Ke.a({color:"#3399CC",width:2})};return e.image=new Qe.a({fill:e.fill,stroke:e.stroke,radius:5}),e}(),new tt.c(t)}function rt(e){return"function"==typeof e?function(t,n){return e(t,n,ot)}:Array.isArray(e)?e.map((function(e){return ot(e)})):ot(e)}var at=n(303),it=n.n(at);function ct(e){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function st(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ut(e,t)}function ut(e,t){return(ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ft(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=dt(e);if(t){var r=dt(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return pt(this,n)}}function pt(e,t){return!t||"object"!==ct(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dt(e){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ht={XYZ:Ne.a,TileWMS:Ie.a,WMTS:Ve.a,ImageWMS:Ue.a,Bing:qe.a,Vector:We.a},yt={geojson:new Be.a,wmts:new ze.a},gt=function(e){lt(n,e);var t=ft(n);function n(){return st(this,n),t.apply(this,arguments)}return n}(Le.a),mt=function(e){lt(n,e);var t=ft(n);function n(e){st(this,n);var o={source:new ht[e.type](e)};return t.call(this,o)}return n}(Ge.a),bt=function(e){lt(n,e);var t=ft(n);function n(e){st(this,n);var o={};"TileWMS"===e.type&&e.tileSize&&256!==e.tileSize&&(o.tileGrid=function(e){for(var t=Object(He.k)(e.projection).getExtent(),n=Object(Je.E)(t)/e.tileSize,o=it()(U.minZoom,U.maxZoom+1),r=0,a=o.length;r<a;++r)o[r]=n/Math.pow(2,r);return new Ye.a({extent:t,resolutions:o,tileSize:[e.tileSize,e.tileSize]})}(e)),"WMTS"===e.type&&(o.tileGrid=function(e){for(var t=e.tileSize||256,n=function(e,t,n,o,r,a){var i=n*o,c=r*a,s=e*i*28e-5+t[0],l=t[1]-e*c*28e-5,u=Math.round((s-t[0])/i),f=Math.round((t[1]-l)/c);if(u!==f)throw new Error("Could not calculate resolution!");return{extent:[t[0],l,s,t[1]],maxResolution:u}}(e.scaleDenominator,e.topLeftCorner,t,e.matrixWidth,t,e.matrixHeight),o=n.extent,r=n.maxResolution,a=Array(16),i=[],c=0,s=a.length;c<s;++c)a[c]=r/Math.pow(2,c),i[c]=e.matrixTemplate?e.matrixTemplate.replace(/{z}/,c):c;return new Ze.b({extent:n.extent,origin:Object(Je.C)(o),resolutions:a,matrixIds:i})}(e));var r=Object.assign({},e,o);delete r.maxResolution,delete r.minResolution;var a={source:ht[e.type]?new ht[e.type](r):null};return t.call(this,a)}return n}(Fe.a),vt=function(e){lt(n,e);var t=ft(n);function n(e){st(this,n);var o=e.features?yt.geojson.readFeatures(e,{dataProjection:"EPSG:4326",featureProjection:$("map/projection")}):[],r={source:new We.a({features:o}),style:rt(e.style),updateWhileAnimating:e.updateWhileAnimating,updateWhileInteracting:e.updateWhileInteracting};return t.call(this,r)}return n}(De.a);function wt(e){var t;switch(e.type){case"Group":var n=e.layers.map((function(t){var n=P(t);return n.projection||(n.projection=e.projection),n.zIndex||(n.zIndex=e.zIndex),wt(n)}));void 0===e.visible&&(e.visible=!0),t=new gt({layers:n});break;case"XYZ":case"TileWMS":case"Bing":case"WMTS":t=new bt(P(e));break;case"ImageWMS":t=new mt(P(e));break;case"FeatureCollection":t=new vt(e)}return!!t&&(function(e,t){"boolean"==typeof t.visible&&e.setVisible(t.visible);void 0===t.id&&(t.id=S());e.set("id",t.id),t.title&&e.set("title",t.title);t.layerType&&e.set("type",t.type);t.icon&&e.set("icon",t.icon);t.minResolution&&e.setMinResolution(t.minResolution);t.maxResolution&&e.setMaxResolution(t.maxResolution);void 0!==t.opacity&&e.setOpacity(t.opacity);void 0!==t.zIndex?e.setZIndex(t.zIndex):e.setZIndex(100);e.set("conf",t)}(t,e),t)}var kt=n(309),At=n(210),St=n(306),Ot=n(163);n(387),n(388);function jt(e){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ct(e,t,n){return(Ct="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_t(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Rt(e,t){return(Rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=_t(e);if(t){var r=_t(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Et(this,n)}}function Et(e,t){return!t||"object"!==jt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _t(e){return(_t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tt(e,t,n){var o={feature:null,layer:null,distance:1/0};return e.forEachFeatureAtPixel(t,(function(e,t){if(e.getGeometry().getCoordinates()){var r=Object(c.b)(Object(He.q)(n),Object(He.q)(e.getGeometry().getCoordinates()));(!isNaN(r)&&t&&e.get("isCache")&&r===o.distance||!isNaN(r)&&t&&r<o.distance)&&(o.feature=e,o.layer=t,o.distance=r)}}),{hitTolerance:10}),o.feature||e.forEachFeatureAtPixel(t,(function(e,t){if(e.getGeometry().getCoordinates()){var r=Object(c.b)(Object(He.q)(n),Object(He.q)(e.getGeometry().getCoordinates()));isNaN(r)&&(o.feature=e,o.layer=t,o.distance=0)}}),{hitTolerance:5}),o.feature?[o.layer,o.feature]:null}Ot.a.defs("EPSG:3301","+proj=lcc +lat_1=59.33333333333334 +lat_2=58 +lat_0=57.51755393055556 +lon_0=24 +x_0=500000 +y_0=6375000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),Ot.a.defs("EPSG:32634","+proj=utm +zone=34 +datum=WGS84 +units=m +no_defs"),Ot.a.defs("EPSG:32635","+proj=utm +zone=35 +datum=WGS84 +units=m +no_defs"),Ot.a.defs("EPSG:3067","+proj=utm +zone=35 +ellps=GRS80 +units=m +no_defs"),Object(St.a)(Ot.a),Object(He.k)("EPSG:3301").setExtent([40500,5993e3,1064500,7017e3]),Object(He.k)("EPSG:3067").setExtent([-2097152,1601644.86,848181.26,9437184]);var Mt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rt(e,t)}(a,e);var t,n,o,r=Pt(a);function a(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()('<div id="'.concat($("map/el").slice(1),'"></div>')),t.create(),t.map=null,t.layers={base:wt({type:"Group",layers:[]}),layers:wt({type:"Group",layers:[]}),overlays:wt({type:"Group",layers:[]})},t.format={geojson:new Be.a},t.activeBaseLayer=null,t.geoLocation=null,t.controls={mouseCoordinates:null},t.shouldUpdate=!0;var n=t.permalinkToViewConf(G("view"));return t.createBaseLayers($("layer/base"),n?n.baselayer:null),t.createLayers($("layer/layers")),t.createOverlays($("layer/overlays")),Q("map/layer/base",t.layers.base.getLayers()),Q("map/layer/layers",t.layers.layers.getLayers()),Q("map/layer/overlays",t.layers.overlays.getLayers()),Q("map/baseLayer",t.activeBaseLayer&&t.activeBaseLayer.get("id"),!0),Q("map/que",[]),t.layers.base.getLayers().on("add",(function(){t.storeLayers("base")})),t.layers.base.getLayers().on("remove",(function(){t.storeLayers("base")})),t.layers.layers.getLayers().on("add",(function(){t.storeLayers("layers")})),t.layers.layers.getLayers().on("remove",(function(){t.storeLayers("layers")})),t.layers.overlays.getLayers().on("add",(function(){t.storeLayers("overlays")})),t.layers.overlays.getLayers().on("remove",(function(){t.storeLayers("overlays")})),ee("layerchange",(function(e){"string"==typeof e&&(e=["overlays",e]),t.updateStore(e[0],e[1])})),D((function(e){if(e.view){var n=t.permalinkToViewConf(e.view);n&&t.map.getView().animate({center:Object(He.h)(n.center,$("map/projection")),zoom:n.zoom,rotation:b(n.rotation),duration:500})}})),t}return t=a,(n=[{key:"init",value:function(){var e=this,t=this.permalinkToViewConf(G("view"));this.map=this.createMap(t),Q("map",this.map),this.map.on("moveend",(function(e){var t=e.map.getView();Q("map/resolution",t.getResolution()),Q("map/center",Object(He.q)(t.getCenter()),!0),Q("map/zoom",t.getZoom(),!0),Q("map/rotation",m(t.getRotation()),!0),F({view:N({center:Object(He.q)(t.getCenter()),zoom:t.getZoom(),rotation:m(t.getRotation()),baseLayer:$("map/baseLayer")})})})),$("map/que").forEach((function(t){"function"==typeof t&&t(e.map)}))}},{key:"permalinkToViewConf",value:function(e){var t=e?e.split("/"):[];return{center:isNaN(t[1])||isNaN(t[0])?$("map/center"):[Number(t[1]),Number(t[0])],zoom:isNaN(t[2])?$("map/zoom"):Number(t[2]),rotation:isNaN(t[3])?$("map/rotation"):Number(t[3]),baselayer:t[4]||$("map/baseLayer")}}},{key:"createMap",value:function(e){var t=this;return new kt.a({layers:Object.keys(this.layers).map((function(e){return t.layers[e]})),controls:[],target:document.querySelector($("map/el")),moveTolerance:2,pixelRatio:2,view:new At.a({projection:$("map/projection"),center:Object(He.h)(e.center,$("map/projection")),zoom:e.zoom,rotation:b(e.rotation),maxZoom:$("map/maxZoom"),minZoom:$("map/minZoom")})})}},{key:"createBaseLayers",value:function(e,t){var n=this;e.forEach((function(e){e.visible=e.id===t,e.zIndex=0;var o=wt(e);n.addBaseLayer(o),e.visible&&(n.activeBaseLayer=o)}))}},{key:"createLayers",value:function(e){var t=this;e.forEach((function(e){t.addLayer(wt(e))}))}},{key:"createOverlays",value:function(e){var t=this;e.forEach((function(e){t.addOverlay(wt(e))}))}},{key:"addBaseLayer",value:function(e){this.layers.base.getLayers().push(e)}},{key:"addLayer",value:function(e){this.layers.layers.getLayers().push(e)}},{key:"addOverlay",value:function(e){this.layers.overlays.getLayers().push(e)}},{key:"getLayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e in this.layers){if(t){var n=this.layers[e].getLayers().getArray().filter((function(e){return e.get("id")===t}));return n[0]||!1}return this.layers[e]}return!1}},{key:"storeLayers",value:function(e){Q("layer/"+e,this.layers[e].getLayers().getArray().map((function(e){return e.get("conf")})),!0)}},{key:"updateStore",value:function(e,t){var n=this.getLayer(e,t);if(n){var o=n.get("conf");if("FeatureCollection"===o.type){var r=this.format.geojson.writeFeaturesObject(n.getSource().getFeatures(),{featureProjection:$("map/projection"),dataProjection:"EPSG:4326"});o.features=r.features}o.visible=n.getVisible(),n.set("conf",o),this.storeLayers(e)}}},{key:"destroy",value:function(){this.map.setTarget(null),this.map=null,Ct(_t(a.prototype),"destroy",this).call(this)}}])&&xt(t.prototype,n),o&&xt(t,o),a}(re);n(170),n(389);function Lt(e){return(Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ft(e,t){return(Ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=It(e);if(t){var r=It(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Nt(this,n)}}function Nt(e,t){return!t||"object"!==Lt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function It(e){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ut=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ft(e,t)}(a,e);var t,n,o,r=Dt(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),e.target||(e.target=fe()("body")),(t=r.call(this,e.target)).id="sidebar-"+S(),t.el=fe()('<nav id="'.concat(t.id,'" class="sidebar bg-light p-3"></nav>')),t.shadow=fe()('<div id="'.concat(t.id,'-shadow" class="sidebar-shadow"></div>')),t.state={trigger:e.trigger,position:e.position,shadow:e.shadow,active:e.activeComponent},t.trigger=e.trigger,t.create(),t.components=t.renderComponents(t.el.find(" > ul"),t.el.find("> div"),e.components,e.props),t}return t=a,(n=[{key:"create",value:function(){this.target&&this.el&&(this.target.append(this.el),this.target.append(this.el),this.state.shadow&&this.target.append(this.shadow),this.render())}},{key:"render",value:function(){var e=this;this.el.html('\n      <button type="button" class="close" aria-label="'.concat(ce("Close"),'">\n        <i class="fa fa-times"></i>\n      </button>\n      <ul class="nav nav-pills mb-3" role="tablist"></ul>\n      <div class="tab-content"></div>\n    ')),this.trigger.on("click",(function(t){e.openSidebar()})),this.el.on("click","> button",(function(t){e.closeSidebar()})),this.shadow.on("click",(function(t){e.closeSidebar()}))}},{key:"openSidebar",value:function(){this.el.addClass("active"),this.shadow.addClass("active")}},{key:"closeSidebar",value:function(){this.el.removeClass("active"),this.shadow.removeClass("active")}},{key:"renderComponents",value:function(e,t,n,o){var r=this,a={};return Object.keys(n).forEach((function(i){var c=new n[i](t,o),s=fe()('\n        <li class="nav-item">\n          <a class="nav-link '.concat(r.state.active===c.id?"active":"",'"\n            data-toggle="pill"\n            href="#').concat(c.id,'"\n            role="tab"\n            aria-controls="').concat(c.id,'">\n            ').concat(c.icon?'<i class="'.concat(c.icon,'"></i>'):"",'\n            <span class="').concat(c.btnTextVisible?"":"d-none d-sm-inline-block",'">').concat(ce(i),"</span>\n          </a>\n        </li>\n      "));c.set("tab",s),e.append(s),a[i]=c})),a}}])&&Gt(t.prototype,n),o&&Gt(t,o),a}(re);n(111);function qt(e){return(qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Vt(e,t){return(Vt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Ht(e);if(t){var r=Ht(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Bt(this,n)}}function Bt(e,t){return!t||"object"!==qt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ht(e){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vt(e,t)}(a,e);var t,n,o,r=zt(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).id="tab-loader",t.icon="fa fa-cloud-download-alt",t.el=fe()('\n      <div\n        class="tab-pane fade show active"\n        id="'.concat(t.id,'"\n        role="tabpanel">\n      </div>\n    ')),t.create(),t}return t=a,(n=[{key:"render",value:function(){var e=this;this.el.html('\n      <ul class="list-group mb-3">\n        <li class="list-group-item">\n          <span class="badge badge-pill badge-secondary">1</span>\n          '.concat(ce("Go to"),'\n          <a href="').concat(W.authUrl,'" target="geopeitus">geopeitus.ee</a>\n          ').concat(ce("and log in"),',\n        </li>\n        <li class="list-group-item">\n          <span class="badge badge-pill badge-secondary">2</span>\n          ').concat(ce("download GPX from"),'\n          <a href="').concat(W.downloadUrl.page,'" target="geopeitus">').concat(ce("here"),"</a>\n          ").concat(ce("and drop it on map or import file from layers menu"),'\n          <div class="alert alert-light" role="alert">\n            ').concat(ce("Quick links"),"<br/>\n            ").concat(Object.keys(W.downloadUrl.gpx).map((function(e){return'<a href="'.concat(W.downloadUrl.gpx[e],'" target="_blank">').concat(ce(e),"</a>")})).join("<br/>"),'\n          </div>\n        </li>\n        <li class="list-group-item">\n          <span class="badge badge-pill badge-secondary">3</span>\n          ').concat(ce("or open"),'\n          <a href="').concat(W.downloadUrl.geojson,'" target="geopeitus">link</a>\n          ').concat(ce("and copy page content to textbox below"),'\n        </li>\n      </ul>\n      <div class="mb-3">\n        <textarea class="form-control" rows="6"></textarea>\n      </div>\n      <button disabled\n        type="button"\n        class="btn btn-secondary confirm">\n        ').concat(ce("Add geocaches to map"),"\n      </button>\n    ")),this.el.find("textarea").on("input",(function(t){var n=e.el.find("textarea").val().trim();e.el.find("button.confirm").prop("disabled",0===n.length)})),this.el.find("textarea").on("keyup",(function(t){if(13===t.keyCode){var n=e.el.find("textarea");n.val().trim().length>'{"type":"Feature"}'.length&&(e.addCaches(n.val().trim()),n.val("").trigger("input"))}})),this.el.on("click","button.confirm",(function(t){var n=e.el.find("textarea");e.addCaches(n.val().trim()),n.val("").trigger("input")}))}},{key:"addCaches",value:function(e){var t=null;e=this.fixme(e);var n=$("app/debug");try{if("FeatureCollection"!==(t=JSON.parse(e)).type||!t.features)throw new Error("Not valid GeoJSON")}catch(e){le("error",ce(e.message)),n&&console.debug("GeocacheLoader.addCaches: error "+JSON.stringify(e))}if(t){var o=this.createLayer(t),r=o.getSource().getFeatures();zo(r)?Bo(r):($("map/layer/layers").push(o),le("success","".concat(ce("Added")," ").concat(t.features.length," ").concat(ce("features"))),n&&console.debug("GeocacheLoader.addCaches: added "+t.features.length))}}},{key:"fixme",value:function(e){return e.replace('Männiku "NAVY"',"Männiku &quot;NAVY&quot;").replace('Seikluse "Pärnu villad" boonusaare',"Seikluse &quot;Pärnu villad&quot; boonusaare").replace('SPA 36: "Inetu kuusepoeg"',"SPA 36: &quot;Inetu kuusepoeg&quot;")}},{key:"createLayer",value:function(e){return e.features&&e.features.forEach((function(e){e.id=S()})),wt({type:"FeatureCollection",id:S(),title:"Geocaches",features:e.features,style:{stroke:{color:"#000000",width:2},fill:{color:O("#000000",.5)},circle:{stroke:{color:"#000000"},fill:{color:O("#000000",.3)},radius:5}}})}}])&&Wt(t.prototype,n),o&&Wt(t,o),a}(re),Yt=[{regexpParse:/^(34N)[ ,;:]\s*([0-9]{7}|[0-9]{1,7}[,.]\d{0,9})[ ,;:]\s*([0-9]{6}|[0-9]{6}[,.]\d{0,9})\s*$/,srid:"EPSG:32634",srname:"UTM 34N",get:function(e){return[Number(e[3].replace(",",".")),Number(e[2].replace(",","."))]}},{regexpParse:/^(34N)[ ,;:]\s*?([0-9]{6}|[0-9]{6}[,.]\d{0,9})[ ,;:]\s*([0-9]{7}|[0-9]{1,7}[,.]\d{0,9})\s*$/,srid:"EPSG:32634",srname:"UTM 34N",get:function(e){return[Number(e[2].replace(",",".")),Number(e[3].replace(",","."))]}},{regexpParse:/^(35N)[ ,;:]\s*([0-9]{7}|[0-9]{1,7}[,.]\d{0,9})[ ,;:]\s*([0-9]{6}|[0-9]{6}[,.]\d{0,9})\s*$/,srid:"EPSG:32635",srname:"UTM 35N",get:function(e){return[Number(e[3].replace(",",".")),Number(e[2].replace(",","."))]}},{regexpParse:/^(35N)[ ,;:]\s*?([0-9]{6}|[0-9]{6}[,.]\d{0,9})[ ,;:]\s*([0-9]{7}|[0-9]{1,7}[,.]\d{0,9})\s*$/,srid:"EPSG:32635",srname:"UTM 35N",get:function(e){return[Number(e[2].replace(",",".")),Number(e[3].replace(",","."))]}},{regexpParse:/^\d{1,2}[^ABIOYZabioyz]\s?[A-Za-z]{2}\s?([0-9]+)\s?([0-9]+)$/,srid:"mrgs",srname:"MRGS",get:function(e){return e[0].replace(/\s/g,"")}},{regexpParse:/^(6[3-6][0-9]{5}|6[3-6][0-9]{5}[,.]\d{0,9})[ ,;:]\s*([3-7][0-9]{5}|[3-7][0-9]{5}[,.]\d{0,9})\s*$/,srid:"EPSG:3301",srname:"L-EST",get:function(e){return[Number(e[2].replace(",",".")),Number(e[1].replace(",","."))]}},{regexpParse:/^([3-7][0-9]{5}|[3-7][0-9]{5}[,.]\d{0,9})[ ,;:]\s*(6[3-6][0-9]{5}|6[3-6][0-9]{5}[,.]\d{0,9})\s*$/,srid:"EPSG:3301",srname:"L-EST",get:function(e){return[Number(e[1].replace(",",".")),Number(e[2].replace(",","."))]}},{regexpParse:/^([-NS])?\s?([0-8]\d?|90)[ °]+([0-9]{2})[ ’'′´]+([0-9]{1,2}[,.]?\d{1,9})["″]?[\s,;]\s*([-EW])?\s?0?([0-1]\d{0,2}|\d{2})[ °]+([0-9]{2})[ ’'′´]+([0-9]{1,2}[,.]?\d{1,9})["″]?\s*$/,regexpFind:/(([NS])?\s?([0-8]\d?|90)[ °]+([0-9]{2})[ ’'′´]+([0-9]{1,2}[,.]?\d{1,9})["″]?[\s,;](<br\/?>)?\s*([EW])?\s?0?([0-1]\d{0,2}|\d{2})[ °]+([0-9]{2})[ ’'′´]+([0-9]{1,2}[,.]?\d{1,9})["″]?)(?![^<>]*>|[^"]*?<\/a)/g,srid:"EPSG:4326",srname:"WGS84 (dms)",get:function(e){var t=[Number(e[6])+Number(e[7])/60+Number(e[8].replace(",","."))/60/60,Number(e[2])+Number(e[3])/60+Number(e[4].replace(",","."))/60/60];return t[1]="-"===e[1]||"S"===e[1]?-t[1]:t[1],t[0]="-"===e[5]||"W"===e[5]?-t[0]:t[0],t}},{regexpParse:/^([-NS])?\s?([0-8]\d?|90)[ °]+([0-9]{1,2}[,.]?\d{1,18})[’'′´]?[\s,;]\s*([-EW])?\s?0?([0-1]\d{0,2}|\d{2})[ °]+([0-9]{1,2}[,.]?\d{1,18})[’'′]?\s*$/,regexpFind:/(([NS])?\s?([0-8]\d?|90)[ °]+([0-9]{1,2}[,.]?\d{1,18})[’'′´]?[\s,;]\s*([EW])?\s?0?([0-1]\d{0,2}|\d{2})[ °]+([0-9]{1,2}[,.]?\d{1,18})[’'′]?)(?![^<>]*>|[^"]*?<\/a)/g,srid:"EPSG:4326",srname:"WGS84 (dm)",get:function(e){var t=[Number(e[5])+Number(e[6].replace(",","."))/60,Number(e[2])+Number(e[3].replace(",","."))/60];return t[1]="-"===e[1]||"S"===e[1]?-t[1]:t[1],t[0]="-"===e[4]||"W"===e[4]?-t[0]:t[0],t}},{regexpParse:/^([-NS])?\s?([1-8]?\d(?:[,.]\d{1,18})?|90(?:\.0{1,18})?)[°]?[\s,;]\s*([-EW])?\s?0?((?:1[0-7]|[1-9])?\d(?:[,.]\d{1,18})?|180(?:\.0{1,18})?)[°]?\s*$/,regexpFind:/(([NS])\s?([1-8]?\d(?:[,.]\d{1,18})?|90(?:\.0{1,18})?)[°]?[\s,;]\s*([EW])\s?0?((?:1[0-7]|[1-9])?\d(?:[,.]\d{1,18})?|180(?:\.0{1,18})?)[°]?)(?![^<>]*>|[^"]*?<\/a)/g,srid:"EPSG:4326",srname:"WGS84 (d)",get:function(e){var t=[Number(e[4].replace(",",".")),Number(e[2].replace(",","."))];return t[1]="-"===e[1]||"S"===e[1]?-t[1]:t[1],t[0]="-"===e[3]||"W"===e[3]?-t[0]:t[0],t}}];function Zt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var Xt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"clear",value:function(){this.xhr&&"function"==typeof this.xhr.abort&&this.xhr.abort()}},{key:"test",value:function(e){return!(e.length<2)}},{key:"formatInput",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.filter((function(e){return!!e})).map((function(e){var n=e.slice(0,2);return t?n.join():n}))}},{key:"toGeoJSON",value:function(e){return e.id=e.id||S(),{type:"Feature",id:e.id,geometry:{type:"Point",coordinates:Object(He.q)(e.coords,e.srid)},bbox:e.bbox||null,properties:e}}}])&&Zt(t.prototype,n),o&&Zt(t,o),e}(),Kt=n(117);function Qt(e){return(Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function en(e,t){return(en=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=on(e);if(t){var r=on(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return nn(this,n)}}function nn(e,t){return!t||"object"!==Qt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function on(e){return(on=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rn(e,t){var n=e.match(t.regexpParse);if(n&&n.length>0){var o={coords:t.get(n),srid:t.srid,srname:t.srname};return"mrgs"===t.srid&&(o.srid="EPSG:4326",o.coords=Kt.a.toPoint(o.coords)),o}return!1}function an(e){for(var t=function(t,n){if(Yt[t].regexpFind){var o=e.match(Yt[t].regexpFind);if(!o||!o.length)return"continue";o.forEach((function(n){var o=rn(n.trim(),Yt[t]);if(o){var r=n.trim().replace(/"/g,"&quot;").replace(/'/g,"&rsquo;");e=e.split(n.trim()).join('<a class="createMarker" data-coordinates="'.concat(JSON.stringify(o.coords),'" data-srid=').concat(o.srid,' href="#">').concat(r,"</a>"))}}))}},n=0,o=Yt.length;n<o;n++)t(n);return e}var cn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&en(e,t)}(a,e);var t,n,o,r=tn(a);function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=r.call(this)).title="Coordinate",e.query=null,e}return t=a,(n=[{key:"test",value:function(e){for(var t=0,n=Yt.length;t<n;t++){var o=rn(e,Yt[t]);if(o)return o}return!1}},{key:"find",value:function(e){var t=this;return this.query=e,new Promise((function(n,o){if(e.length<1)throw new Error(ce("Query string empty, aborting!"));var r=t.test(e),a=[];r&&r.srid&&a.push(r),n(t.format(a))}))}},{key:"format",value:function(e){var t=this;return e.map((function(e){return t.toGeoJSON({provider:t.title,name:"".concat(e.srname," ").concat(t.query),srid:e.srid,coords:e.coords})}))}}])&&$t(t.prototype,n),o&&$t(t,o),a}(Xt),sn=n(188),ln=n(129),un=n(28),fn=n(11),pn=n(54);n(390);function dn(e){return(dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function yn(e,t){return(yn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=bn(e);if(t){var r=bn(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return mn(this,n)}}function mn(e,t){return!t||"object"!==dn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bn(e){return(bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vn=[{projection:"EPSG:4326",srname:"WGS (d)",coordinateFormat:function(e){return Object(un.f)(e,"{y}, {x}",5)}},{projection:"EPSG:4326",srname:"WGS (dm)",coordinateFormat:function(e){return function(e,t,n){return e?kn("NS",e[1],t,n)+" "+kn("EW",e[0],t,n):""}(e,3)}},{projection:"EPSG:4326",srname:"WGS (dms)",coordinateFormat:function(e){return function(e,t,n){return e?An("NS",e[1],t,n)+" "+An("EW",e[0],t,n):""}(e,1)}},{projection:"EPSG:3301",srname:"L-EST",coordinateFormat:function(e){return Object(un.f)(e,"{y}, {x}",0)}},{projection:"EPSG:4326",srname:"MGRS",coordinateFormat:function(e){return Kt.a.forward(e)}}];function wn(e){var t=Object(He.t)(e,$("map/projection"),vn[$("map/coordinateFormat")].projection);return vn[$("map/coordinateFormat")].coordinateFormat(t)}function kn(e,t,n,o){var r=Object(fn.e)(t+180,360)-180,a=Math.abs(3600*r),i=n||0,c=Math.pow(10,i),s=Math.floor(a/3600),l=(a-3600*s)/60;return(l=Math.ceil(l*c)/c)>=60&&(l=0,s+=1),"end"===o?s+"° "+Object(pn.b)(l,2,i)+"′"+(0===r?"":" "+e.charAt(r<0?1:0)):"front"===o?(0===r?"":e.charAt(r<0?1:0)+" ")+s+"° "+Object(pn.b)(l,2,i)+"′":s+"° "+Object(pn.b)(l,2,i)+"′"}function An(e,t,n,o){var r=Object(fn.e)(t+180,360)-180,a=Math.abs(3600*r),i=n||0,c=Math.pow(10,i),s=Math.floor(a/3600),l=Math.floor((a-3600*s)/60),u=a-3600*s-60*l;return(u=Math.ceil(u*c)/c)>=60&&(u=0,l+=1),l>=60&&(l=0,s+=1),"end"===o?s+"° "+Object(pn.b)(l,2)+"′ "+Object(pn.b)(u,2,i)+"″"+(0===r?"":" "+e.charAt(r<0?1:0)):"front"===o?(0===r?"":e.charAt(r<0?1:0)+" ")+s+"° "+Object(pn.b)(l,2)+"′ "+Object(pn.b)(u,2,i)+"″":s+"° "+Object(pn.b)(l,2)+"′ "+Object(pn.b)(u,2,i)+"″"}function Sn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=On(),o=n.getSource().getFeatures().filter((function(n){return JSON.stringify(n.getGeometry().getCoordinates())===JSON.stringify(e)&&(t&&t.name&&n.getProperties().name&&n.getProperties().name===t.name||!t)}));if(o.length)return o[0];t||(t={name:wn(e)});var r=(new Be.a).readFeature({type:"Feature",id:S(),properties:t,geometry:{type:"Point",coordinates:e}});return n.getSource().addFeature(r),Q("layerchange",["overlays",n.get("id")]),r}function On(){var e,t={type:"FeatureCollection",id:S(),title:"Features",style:{stroke:{color:"#000000",width:2},fill:{color:O("#fff",.5)},circle:{stroke:{color:"#000000"},fill:{color:O("#fff",.9)}}}},n=$("layer/mousePositionId");if(n){var o=$("map/layer/overlays").getArray().filter((function(e){return e.get("id")===n}));o&&o[0]?e=o[0]:(e=wt(t),$("map/layer/overlays").push(e),Q("layer/mousePositionId",e.get("id"),!0))}else e=wt(t),$("map/layer/overlays").push(e),Q("layer/mousePositionId",e.get("id"),!0);return e}var jn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yn(e,t)}(a,e);var t,n,o,r=gn(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()('\n      <span class="mouse-position"></span>\n    '),t.animationEl=fe()('\n      <svg width="20" height="20"></svg>'),t.state={format:0,control:null,lock:!1,lastCoord:null,overlay:new ln.a({element:t.animationEl[0],positioning:"center-center"})},Q("map/coordinateFormat",t.state.format,!0),t.handlers={onclick:function(e){t.clicked(e)},animate:function(e){t.animate(e)}},t.create(),$("map/contextmenu").push({content:function(e){return'<i class="fa fa-map-marker-alt size-1_1"></i>\n          '.concat(wn(e),'\n          <a href="#" class="btn btn-link context-item-btn"><i class="far fa-clone"></i></a>')},onClick:function(e,t,n){!n&&Sn(t)},onBtnClick:function(e,n){e.preventDefault(),t.copy(wn(n))},closeOnClick:!0}),t}return t=a,(n=[{key:"render",value:function(){var e=this;if(this.el.html('\n      <div class="btn-group dropup float-left">\n        <button type="button" class="btn btn-secondary lock">\n          <i class="fa fa-'.concat(this.state.lock?"lock":"lock-open",'"></i>\n        </button>\n        <button type="button"\n          class="btn btn-secondary dropdown-toggle dropdown-toggle-split"\n          data-toggle="dropdown">\n        </button>\n        <div class="dropdown-menu">\n          ').concat(vn.map((function(t,n){return'\n              <a class="dropdown-item" href="#" data-format="'.concat(n,'">\n                <i class="far ').concat(n===e.state.format?"fa-dot-circle":"fa-circle",'"></i>\n                ').concat(t.srname,"\n              </a>")})).join(""),'\n        </div>\n      </div>\n      <button type="button" class="btn btn-link copy float-left">\n        <i class="far fa-clone"></i>\n      </button>\n    ')),this.el.on("click",".lock",(function(t){e.state.lock=!e.state.lock,e.activate($("map")),fe()(t.currentTarget).find("i").toggleClass("fa-lock fa-lock-open")})),this.el.on("click",".copy",(function(t){var n=e.el.find(".coords").html();e.copy(n)})),this.el.on("click","a[data-format]",(function(t){e.state.format=fe()(t.currentTarget).data("format"),Q("map/coordinateFormat",e.state.format,!0),e.state.control.setProjection(vn[e.state.format].projection),e.state.control.setCoordinateFormat(vn[e.state.format].coordinateFormat),e.el.find("a[data-format] i").removeClass("fa-dot-circle").addClass("fa-circle"),fe()(t.currentTarget).find("i").removeClass("fa-circle").addClass("fa-dot-circle")})),!this.state.control){this.state.control=new sn.a({coordinateFormat:vn[this.state.format].coordinateFormat,projection:vn[this.state.format].projection,className:"float-left coords",target:this.el[0],undefinedHTML:""});var t=$("map");t?this.activate(t):$("map/que").push((function(t){e.activate(t)}))}}},{key:"activate",value:function(e){e.addOverlay(this.state.overlay),e.on("singleclick",this.handlers.animate),this.state.lock?(e.removeControl(this.state.control),this.el.append('<div class="float-left coords"></div>'),e.on("click",this.handlers.onclick)):(this.el.find(".coords").remove(),e.un("click",this.handlers.onclick),e.addControl(this.state.control))}},{key:"clicked",value:function(e){this.el.find(".coords").html(wn(e.coordinate))}},{key:"copy",value:function(e){h(e).then((function(){le("success","".concat(ce("Coordinates")," ").concat(e," ").concat(ce("copied to clipboard")))})).catch((function(){le("error",ce("Unable to copy to clipboard"))}))}},{key:"animate",value:function(e){var t=this,n=e.coordinate;this.state.overlay.setPosition(n),this.animationEl.html('<circle id="map-click-animation" cx="10" cy="10" r="0" fill="#000" opacity="0.5"/>'),setTimeout((function(){t.state.overlay.setPosition(void 0),t.animationEl.html("")}),500)}}])&&hn(t.prototype,n),o&&hn(t,o),a}(re);n(391);function xn(e){return(xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Rn(e,t){return(Rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=_n(e);if(t){var r=_n(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return En(this,n)}}function En(e,t){return!t||"object"!==xn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _n(e){return(_n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rn(e,t)}(a,e);var t,n,o,r=Pn(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).id="tab-cacheinfo",t.icon="fa fa-cube",t.btnTextVisible=!0,t.el=fe()('\n      <div\n        class="tab-pane fade"\n        id="'.concat(t.id,'"\n        role="tabpanel">\n      </div>\n    ')),t.state={layer:null,cache:null,logType:{"Found it":"found","Didn't find it":"notfound","Needs Maintenance":"problem"}},t.create(),ee("geocache/loadend",(function(e){t.state.layer=e})),ee("popup/show",(function(e){var n=e.layerId,o=e.feature;t.state.layer&&t.state.layer.get("id")===n&&o.get("isCache")&&(t.state.cache=o,t.render())})),t}return t=a,(n=[{key:"render",value:function(){var e=this;this.el.html('\n      <ul class="list-group mb-3">\n      '.concat(this.state.layer&&this.state.layer.get("_featureInfo")&&this.state.cache?this.renderCacheInfo():'<li class="list-group-item">\n          <i class="fas fa-plus"></i>\n          '.concat(ce("Select geocache from map"),"\n        </li>"),"\n      </ul>\n      ").concat(this.state.layer&&this.state.cache?this.renderLogs():"","\n    ")),this.el.find("img").addClass("img-fluid").css("height","auto"),this.el.find("a.createMarker").each((function(e,t){fe()(t).parent().attr("style")&&fe()(t).attr("style",fe()(t).parent().attr("style"))})),this.el.find("a.createMarker").on("click",(function(t){t.preventDefault(),e.mapCoordinates(fe()(t.target).data("coordinates"),fe()(t.target).text())}))}},{key:"renderCacheInfo",value:function(){var e=this.state.layer.get("_featureInfo"),t="function"==typeof e.title?e.title(this.state.cache):e.title,n="function"==typeof e.content?e.content(this.state.cache):e.content,o=an(this.state.cache.get("description")||"");return'\n      <li class="list-group-item header">\n        '.concat(t,'\n      </li>\n      <li class="list-group-item content">\n        ').concat(n,"\n      </li>\n      ").concat(o?'\n        <li class="list-group-item description">\n          '.concat(o,"\n        </li>"):"")}},{key:"renderLogs",value:function(){var e,t=this,n=this.state.cache.get("logs")||[],o=this.state.cache.get("url");if(this.state.cache.get("id")){var r=Object.keys(W.logUrl).find((function(e){return o.indexOf(e)>-1}));e=W.logUrl[r].replace("{id}",this.state.cache.get("id"))}else e=o;return'\n      <ul class="list-group mb-3">\n        <li class="list-group-item d-flex justify-content-between align-items-center">\n          <b>'.concat(ce("Logs"),'</b> <a href="').concat(e,'" target="_blank">').concat(ce("Add log"),"</a>\n        </li>\n        ").concat(n.map((function(e){return'\n          <li class="list-group-item log">\n          <i class="fas fa-circle fstatus '.concat(t.state.logType[e.type]||"",'"></i>\n            <b class="text-muted">\n              ').concat(C(e.date),"\n            </b>\n            <b>").concat(e.finder,"</b>\n            <br/>\n            ").concat(an(e.text||""),"\n          </li>")})).join(""),"\n      </ul>")}},{key:"mapCoordinates",value:function(e,t){var n=$("map");Sn(e=Object(He.h)(e),{name:t}),n.getView().animate({center:e,zoom:15,duration:500})}}])&&Cn(t.prototype,n),o&&Cn(t,o),a}(re);n(288),n(94),n(392);function Mn(e){return(Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ln(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Gn(e,t){return(Gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Nn(e);if(t){var r=Nn(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Dn(this,n)}}function Dn(e,t){return!t||"object"!==Mn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nn(e){return(Nn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var In=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gn(e,t)}(a,e);var t,n,o,r=Fn(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).id="tab-filter",t.icon="fa fa-filter",t.btnTextVisible=!0,t.el=fe()('\n      <div\n        class="tab-pane fade"\n        id="'.concat(t.id,'"\n        role="tabpanel">\n      </div>\n    ')),t.state={tab:null,conf:t.createConf(),layer:null,filter:{}},t.create(),ee("geocache/loadend",(function(e){t.state.layer=e,t.render()})),t}return t=a,(n=[{key:"render",value:function(){var e=this;this.state.filter=this.buildPropertyList(this.state.layer);var t=$("geocache/filter");this.el.html('\n      <ul class="list-group mb-3">\n      '.concat(Object.keys(this.state.filter).length?this.renderFilter(this.state.filter,t?t.query:{}):'<li class="list-group-item">\n          <i class="fas fa-plus"></i>\n          '.concat(ce("Add caches to map"),"\n        </li>"),"\n      </ul>\n    ")),this.el.find("input[data-filter]").on("change",(function(t){t.stopPropagation(),e.filter()})),this.el.find("input[name=radiusStyle]").on("change",(function(t){t.stopPropagation();var n=fe()(t.target).is(":checked");e.state.layer.getSource().forEachFeature((function(e){e.get("isCache")&&e.set("radiusVisible",n)})),e.filter()})),Object.keys(this.state.filter).length&&t&&t.count&&this.filter()}},{key:"renderFilter",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return'\n      <li class="list-group-item">\n        <label>\n          <input type="checkbox" name="radiusStyle" value="160" '.concat(n.radiusStyle&&n.radiusStyle.indexOf("160")>-1?'checked="true"':"","> ").concat(ce("Show 160m radius"),"\n        </label>\n      </li>\n      ").concat(Object.keys(e).map((function(o){var r=t.state.conf[o],a={};return Object.keys(e[o]).sort((function(e,t){return r.indexOf(e)-r.indexOf(t)})).forEach((function(t){a[t]=e[o][t]})),'<li class="list-group-item">'+Object.keys(a).map((function(t){var r=n[o]&&n[o].indexOf(t)>-1?'checked="true"':"";return'<label>\n                <input type="checkbox" name="'.concat(o,'" data-filter="').concat(o,'" value="').concat(t,'" ').concat(r,">\n                ").concat(ce(e[o][t]),"\n              </label>")})).join("")+"</li>"})).join(""))}},{key:"createConf",value:function(){var e={};return Object.keys(W.filter).forEach((function(t){"string"==typeof W.filter[t]?e[t]=Object.values(W.mapping[W.filter[t]]):e[t]=W.filter[t]})),e}},{key:"buildPropertyList",value:function(e){var t=this,n={};return e&&"function"==typeof e.getSource&&e.getSource().forEachFeature((function(e){var o=e.getProperties();Object.keys(o).forEach((function(e){e in t.state.conf&&(n[e]||(n[e]={}),t.state.conf[e].indexOf(o[e])>-1&&!n[e][o[e]]&&(n[e][o[e]]=o[e]))}))})),Object.keys(n).forEach((function(e){0===Object.keys(n[e]).length&&delete n[e]})),n}},{key:"filter",value:function(){var e=this.getChecked("input[data-filter]");this.state.layer.getSource().forEachFeature((function(t){if(t.get("isCache"))if(e.count){var n=t.getProperties(),o=Object.keys(e.query).filter((function(t){return t in n&&e.query[t].indexOf(n[t])>-1}));t.set("hidden",o.length!==Object.keys(e.query).length)}else t.set("hidden",!1)})),Q("geocache/filter",this.getChecked("input"),!0)}},{key:"getChecked",value:function(e){for(var t=this.el.find(e).serializeArray(),n={query:{},count:0},o=0,r=t.length;o<r;o++)n.query[t[o].name]||(n.query[t[o].name]=[]),-1===n.query[t[o].name].indexOf(t[o].value)&&(n.query[t[o].name].push(t[o].value),n.count++);return n}}])&&Ln(t.prototype,n),o&&Ln(t,o),a}(re),Un=n(211);function qn(e){return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Vn(e,t){return(Vn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Hn(e);if(t){var r=Hn(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Bn(this,n)}}function Bn(e,t){return!t||"object"!==qn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hn(e){return(Hn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vn(e,t)}(a,e);var t,n,o,r=zn(a);function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=r.call(this)).title="OSRM",e.xhr=null,e.profiles={driving:"driving"},e}return t=a,(n=[{key:"test",value:function(e){return(void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile)in this.profiles&&!(e.length<2)}},{key:"directions",value:function(e){var t=this;return new Promise((function(n,o){t.clear(),t.xhr=fe.a.ajax({type:"GET",crossDomain:!0,url:q.osrm.directions+t.profiles.driving+"/"+e.join(";"),data:{overview:"full"},dataType:"json"}).done((function(e){"Ok"===e.code?n(t.format(e.routes[0].geometry)):o(new Error(ce("Unable to find route")+": "+e.code))})).fail((function(e){"abort"!==e.statusText&&o(new Error(ce("Unable to find route")+": "+ce(e.responseJSON?e.responseJSON.message:e.statusText)))}))}))}},{key:"format",value:function(e){return new Un.a({factor:1e5}).readFeature(e,{dataProjection:"EPSG:4326",featureProjection:$("map/projection")})}}])&&Wn(t.prototype,n),o&&Wn(t,o),a}(Xt);function Yn(e){return(Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Xn(e,t){return(Xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=$n(e);if(t){var r=$n(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Qn(this,n)}}function Qn(e,t){return!t||"object"!==Yn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $n(e){return($n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var eo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xn(e,t)}(a,e);var t,n,o,r=Kn(a);function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=r.call(this)).title="OpenRouteService",e.xhr=null,e.profiles={driving:"driving-car",hiking:"foot-hiking"},e}return t=a,(n=[{key:"test",value:function(e){return(void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile)in this.profiles&&!(e.length<2)}},{key:"formatInput",value:function(e){return e.filter((function(e){return!!e})).map((function(e){return e.slice(0,2)}))}},{key:"directions",value:function(e){var t=this,n=void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile;return new Promise((function(o,r){if(t.clear(),n in t.profiles){var a=e.map((function(e){return 5e3}));t.xhr=fe.a.ajax({type:"POST",crossDomain:!0,url:q.openrouteservice.directions+t.profiles[n],headers:{Authorization:q.openrouteservice.key},data:JSON.stringify({coordinates:e,radiuses:a}),contentType:"application/json",dataType:"json"}).done((function(e){if(e&&e.routes&&e.routes.length){var n=t.format(e.routes[0].geometry);n.set("distance",e.routes[0].summary.distance),n.set("duration",e.routes[0].summary.duration),o(n)}else r(new Error(ce("Unable to find route")+": "+JSON.stringify(e)))})).fail((function(e){"abort"!==e.statusText&&r(new Error(ce("Unable to find route")+": "+ce(e.responseJSON?e.responseJSON.message:e.statusText)))}))}else r(new Error(ce("Routing disabled")))}))}},{key:"optimize",value:function(e,t,n){var o=this,r=void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile;return new Promise((function(a,i){o.clear();var c=[{id:1,profile:o.profiles[r],start:e,end:t}],s=n.map((function(e,t){return{id:t,location:e}}));r in o.profiles?o.xhr=fe.a.ajax({type:"POST",crossDomain:!0,url:q.openrouteservice.optimize,headers:{Authorization:q.openrouteservice.key},data:JSON.stringify({jobs:s,vehicles:c}),contentType:"application/json",dataType:"json"}).done((function(e){e&&e.routes&&e.routes.length?a(e.routes[0]):i(new Error(ce("Unable to find route")+": "+JSON.stringify(e)))})).fail((function(e){"abort"!==e.statusText&&i(new Error(ce("Unable to find route")+": "+ce(e.responseJSON?e.responseJSON.message:e.statusText)))})):i(new Error(ce("Routing disabled")))}))}},{key:"format",value:function(e){return new Un.a({factor:1e5}).readFeature(e,{dataProjection:"EPSG:4326",featureProjection:$("map/projection")})}}])&&Zn(t.prototype,n),o&&Zn(t,o),a}(Xt);function to(e){return(to="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function no(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function oo(e,t){return(oo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ro(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=io(e);if(t){var r=io(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return ao(this,n)}}function ao(e,t){return!t||"object"!==to(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function io(e){return(io=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var co={osrm:new Jn,openrouteservice:new eo},so={from:null,to:null},lo=null;function uo(){so.from=null,so.to=null,lo&&(lo.setMap(null),lo.getSource().clear(),lo=null)}function fo(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return lo&&lo.getSource().getFeatures().length&&lo.getSource().clear(),new Promise((function(n,o){var r=$("app/routing").provider,a=r in co?co[r]:null;if(!a)throw new Error(ce("Missing provider, aborting!"));var i=a.formatInput(e,!0);if(!a.test(i))throw new Error(ce("Routing input test failed, aborting!"));a.directions(i).then((function(o){if(uo(),o){po();var r=o.getGeometry().getCoordinates(),a=Object(c.b)(e[0],e[e.length-1]),i=E(Object(He.h)(e[0]),Object(He.h)(e[e.length-1]));if(!(r.length>1&&a>Object(c.b)(e[0],Object(He.q)(r[0]))&&a>Object(c.b)(e[e.length-1],Object(He.q)(r[r.length-1]))))throw new Error(ce("Invalid route"));r.unshift(Object(He.h)(e[0],$("map/projection"))),r.push(Object(He.h)(e[e.length-1],$("map/projection"))),o.getGeometry().setCoordinates(r),lo.getSource().addFeature(o),Q("routing/stops",e),$("routing/infoFromRoute")||o.set("distance",a),o.set("bearing",i),t&&Q("routing/info","<b>".concat(ce("Directions"),"</b> ").concat($("routing/infoFromRoute")?"":" - ".concat(ce("As crow flies")),"\n                ").concat(j(null,o.get("distance"),[0,1]),"\n                <i>&middot;</i> ").concat(Math.round(o.get("bearing")),"&deg;\n                ").concat($("routing/infoFromRoute")?"<i>&middot;</i> ".concat(R(o.get("duration"),"seconds")):"","\n              ")),n(o)}})).catch(o)}))}function po(){lo||(lo=ho()).setMap($("map"))}function ho(){return wt({type:"FeatureCollection",id:S(),zIndex:99,title:"Route",style:[{stroke:{color:"rgba(255, 255, 255, 0.7)",width:7}},{stroke:{color:"rgba(0, 133, 203, 1)",width:3}}]})}var yo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oo(e,t)}(a,e);var t,n,o,r=ro(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=null,t.state={contextmenu:{from:{content:'<i class="fas fa-directions text-success size-1_1"></i> '.concat(ce("Directions from here")),onClick:function(e,n,o){var r=o?o[1]:Sn(n);so.from=r.getGeometry().getCoordinates(),Q("routing/stops",[Object(He.q)(so.from),so.to&&Object(He.q)(so.to)]),t.findRoute()},closeOnClick:!0},to:{content:'<i class="fas fa-directions text-danger size-1_1"></i>\n            '.concat(ce("Directions to here"),'\n            <a href="#" class="btn btn-link context-item-btn"><i class="fab fa-google"></i></a>'),onClick:function(e,n,o){var r=o?o[1]:Sn(n);so.to=r.getGeometry().getCoordinates(),Q("routing/stops",[so.from&&Object(He.q)(so.from),Object(He.q)(so.to)]),t.findRoute()},closeOnClick:!0,onBtnClick:function(e,t,n){e.preventDefault();var o=Object(He.q)(t).slice(0,2).reverse().join(",");fe()("<a>").attr("href",q.google.directions+o).attr("target","_blank")[0].click()}},done:{content:'<i class="fas fa-directions text-info size-1_1"></i>\n            '.concat(ce("Retry directions"),'\n            <a href="#" class="btn btn-link context-item-btn"><i class="fas fa-times"></i></a>'),onClick:function(e,n,o){t.findRoute()},closeOnClick:!0,onBtnClick:function(e,t,n){e.preventDefault(),uo(),Q("routing/stops",[]),Q("routing/info",null),Q("navigate/to",null)}}}},t.handleContextMenuItems(),ee("routing/stops",(function(){t.handleContextMenuItems()})),ee("routing/profile",(function(){t.handleContextMenuItems()})),t}return t=a,(n=[{key:"handleContextMenuItems",value:function(){var e=this,t=$("map/contextmenu"),n=void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile;Object.keys(this.state.contextmenu).forEach((function(n){var o=t.indexOf(e.state.contextmenu[n]);o>-1&&t.splice(o,1)})),n&&(lo&&lo.getSource().getFeatures().length?t.push(this.state.contextmenu.done):(so.from||t.push(this.state.contextmenu.from),so.to||t.push(this.state.contextmenu.to),so.from&&so.to&&t.push(this.state.contextmenu.done)))}},{key:"findRoute",value:function(){var e=$("routing/stops");e.filter((function(e){return!!e})).length>1&&fo(e,!0).then((function(e){})).catch((function(e){le("error",e),$("app/debug")&&console.error("routing error",e)}))}}])&&no(t.prototype,n),o&&no(t,o),a}(re),go=n(50),mo=n(208),bo=n(48),vo=n(60),wo=n(43),ko=n(310);n(393);function Ao(e){return(Ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function So(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Oo(e,t){return(Oo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Co(e);if(t){var r=Co(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return xo(this,n)}}function xo(e,t){return!t||"object"!==Ao(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Co(e){return(Co=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ro=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oo(e,t)}(a,e);var t,n,o,r=jo(a);function a(e){var t;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).id="tab-geotrip",t.icon="fa fa-thumbtack",t.btnTextVisible=!0,t.el=fe()('\n      <div\n        class="tab-pane fade"\n        id="'.concat(t.id,'"\n        role="tabpanel">\n      </div>\n    ')),t.state={tab:null,routeLayer:null,layers:$("map/layer/layers"),collection:new go.a,init:!1},Q("geocache/trip",t.state.collection),$("map/layer/layers").on("remove",(function(e){$("ui/layermanager/sorting")||t.loadState()})),$("map/layer/overlays").on("remove",(function(e){$("ui/layermanager/sorting")||t.loadState()})),t.state.collection.on("add",(function(e){e.element.getGeometry()instanceof bo.a?(e.element.set("_inGeotrip",!0),t.render()):t.state.collection.remove(e.element)})),t.state.collection.on("remove",(function(e){e.element.set("_inGeotrip",!1),t.render()})),t.create(),t.initEvents(),$("map"))?t.loadState():$("map/que").push((function(e){t.loadState()}));return t}return t=a,(n=[{key:"render",value:function(){var e=this,t=this.state.collection.getArray().filter((function(e){return!!e.get("fstatus_timestamp")&&"Found"===e.get("fstatus")}));if(this.el.html('\n      <ul class="list-group mb-3">\n      '.concat(this.state.collection.getLength()?this.renderTrip(this.state.collection):'<li class="list-group-item">\n          <i class="fas fa-plus"></i>\n          '.concat(ce("Add features from map"),"\n        </li>"),"\n      </ul>\n      ").concat(this.state.collection.getLength()?'<div class="dropdown sort">\n          <button class="btn btn-link dropdown-toggle"\n            type="button"\n            id="geotripSort"\n            data-toggle="dropdown"\n            aria-haspopup="true"\n            aria-expanded="false">\n            <i class="fas fa-sort-amount-down"></i>\n          </button>\n          <div class="dropdown-menu" aria-labelledby="geotripSort">\n            <a class="dropdown-item sortby-found '.concat(t.length?"":"disabled",'" href="#">').concat(ce("Found"),'</a>\n            <a class="dropdown-item sortby-routing" href="#">').concat(ce("Optimize"),'</a>\n          </div>\n        </div>\n        <button type="button" class="btn btn-link routing">\n          <i class="fas fa-directions"></i> ').concat(ce("Routing"),'\n        </button>\n        <div class="btn-group float-right" role="group">\n          <a role="button" class="btn btn-secondary export" title="').concat(ce("Download"),'">\n            <i class="fas fa-download"></i> GPX\n          </a>\n          <button type="button" class="btn btn-secondary clear" title="').concat(ce("Clear trip"),'">\n            <i class="fas fa-trash"></i>\n          </button>\n        </div>'):"","\n    ")),this.state.tab&&this.state.tab.find("span").html(this.state.collection.getLength()||ce("Geotrip")),this.state.collection.getLength()){this.state.routeLayer||(this.state.routeLayer=this.createLayer(),this.state.routeLayer.setMap($("map"))),this.state.routeLayer.getSource().clear();var n=this.state.collection.getArray().map((function(e){return e.getGeometry().getCoordinates()})),o=[];if(n.length>1){for(var r=0,a=n.length;r<a;r++)r!==a-1?o[r]=[n[r],n[r+1]]:o[r-1][1]=n[r];o.forEach((function(t){e.state.routeLayer.getSource().addFeature(new wo.a(new vo.a(t)))}))}mo.a.create(this.el.find("ul")[0],{draggable:"li.sort-item",handle:".badge",onUpdate:function(t){e.reorderTrip(),e.render()}})}this.state.init&&(Q("geocache/trip/ids",this.state.collection.getArray().map((function(e){return e.getId()})),!0),Q("geocache/trip/found",t.map((function(e){return{id:e.getId(),fstatus:e.get("fstatus"),timestamp:e.get("fstatus_timestamp")}})),!0)),this.state.init=!0}},{key:"renderTrip",value:function(e){return e.getArray().map((function(e,t){return'\n        <li class="list-group-item sort-item" data-id="'.concat(e.getId(),'">\n          <button type="button" class="close" aria-label="').concat(ce("Close"),'">\n            <i class="fa fa-times"></i>\n          </button>\n          <span class="badge badge-pill badge-primary">').concat(t+1,'</span>\n          <a href="#">').concat(ce(e.get("name")),'</a>\n          <i class="fas fa-circle fstatus ').concat("Found"===e.get("fstatus")?"found":"",'"></i>\n          ').concat(e.get("fstatus_timestamp")?'<div class="text-muted small timestamp">\n              '.concat(ce("Found"),":\n              ").concat(C(e.get("fstatus_timestamp"),!0)+" "+R(e.get("fstatus_timestamp")),"</div>"):"","\n        </li>")})).join("")}},{key:"initEvents",value:function(){var e=this;this.el.on("click","li button.close",(function(t){t.preventDefault(),e.remove(fe()(t.currentTarget).closest("li").data("id"))})),this.el.on("click","li a",(function(t){t.preventDefault(),e.zoomTo(fe()(t.currentTarget).closest("li").data("id"))})),this.el.on("click","button.clear",(function(t){t.preventDefault(),e.clearTrip()})),this.el.on("click","a.export",(function(t){t.preventDefault(),e.export()})),this.el.on("click","a.sortby-found",(function(t){t.preventDefault(),e.sortByFound()})),this.el.on("click","a.sortby-routing",(function(t){t.preventDefault(),e.sortByRouting()})),this.el.on("click","button.routing",(function(t){t.preventDefault(),e.routing()}))}},{key:"reorderCollection",value:function(e,t){for(var n=function(n,o){var r=e.getArray().filter((function(e){return e.getId()===t[n]}));r&&r[0]&&(e.remove(r[0]),e.insertAt(n,r[0]))},o=0,r=t.length;o<r;o++)n(o)}},{key:"reorderTrip",value:function(){var e=[];this.el.find("li.sort-item").each((function(t,n){e.push(fe()(n).data("id"))})),this.reorderCollection(this.state.collection,e)}},{key:"sortByFound",value:function(){var e=$("geocache/trip/found");e.sort((function(e,t){return e.timestamp<t.timestamp?-1:e.timestamp>t.timestamp?1:0})),this.reorderCollection(this.state.collection,e.map((function(e){return e.id})))}},{key:"sortByRouting",value:function(){var e=this;if(void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile){var t=$("map/geolocation/position"),n=this.state.collection.getArray().map((function(e){return Object(He.q)(e.getGeometry().getCoordinates())})),o=n[0],r=n[n.length-1];t&&(o=Object(He.q)(t)),function(e,t,n){return new Promise((function(o,r){var a=$("app/routing").provider,i=a in co?co[a]:null;if(!i)throw new Error(ce("Missing provider, aborting!"));var c=i.formatInput(n,!1);if(!i.test(c))throw new Error(ce("Routing input test failed, aborting!"));i.optimize(e,t,c).then(o).catch(r)}))}(o,r,n).then((function(t){var n=t.steps.filter((function(e){return"job"===e.type})).map((function(t){return e.state.collection.getArray()[t.job].getId()}));e.reorderCollection(e.state.collection,n),le("success",ce("Geotrip reordered by optimum path"))})).catch((function(e){console.error(e),le("error",ce("Unable to determine ordering"))}))}else le("error",ce("Routing disabled"))}},{key:"routing",value:function(){if(void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile){var e=$("map/geolocation/position"),t=this.state.collection.getArray().map((function(e){return Object(He.q)(e.getGeometry().getCoordinates())}));e&&t.unshift(Object(He.q)(e)),fo(t,!0).then((function(e){})).catch((function(e){return le("error",ce("Unable to find route")+e)}))}else le("error",ce("Routing disabled"))}},{key:"loadState",value:function(){var e=$("geocache/trip/ids"),t=$("geocache/trip/found");this.clearTrip(),e&&(this.getTripFeaturesFromGroup($("map/layer/layers"),e,this.state.collection),this.getTripFeaturesFromGroup($("map/layer/overlays"),e,this.state.collection),t&&this.state.collection.forEach((function(e){var n=t.filter((function(t){return t.id===e.getId()}))[0];n&&(e.set("fstatus",n.fstatus),e.set("fstatus_timestamp",n.timestamp))})),this.reorderCollection(this.state.collection,e))}},{key:"getTripFeaturesFromGroup",value:function(e,t,n){e.getArray().filter((function(e){return e.get("conf")&&"FeatureCollection"===e.get("conf").type})).forEach((function(e){e.getSource().forEachFeature((function(e){t.indexOf(e.getId())>-1&&n.push(e)}))}))}},{key:"clearTrip",value:function(){this.state.routeLayer&&this.state.routeLayer.getSource().clear(),this.state.collection.clear()}},{key:"remove",value:function(e){var t=this.state.collection.getArray().filter((function(t){return t.getId()===e}));t&&t[0]&&this.state.collection.remove(t[0])}},{key:"zoomTo",value:function(e){var t=this.state.collection.getArray().filter((function(t){return t.getId()===e}));t&&t[0]&&$("map").getView().animate({center:t[0].getGeometry().getCoordinates(),zoom:15,duration:500})}},{key:"export",value:function(){var e=[],t=this.state.collection.getArray().map((function(t){var n=t.clone();return n.getGeometry().transform($("map/projection"),"EPSG:4326"),e.push(n.getGeometry().getCoordinates()),n}));t.length>1&&t.push(new wo.a(new vo.a(e))),y(W.exportFileName,t)}},{key:"createLayer",value:function(){var e=$("map").getView(),t=$("map/projection");return wt({type:"FeatureCollection",title:"Route",updateWhileAnimating:!0,updateWhileInteracting:!0,style:function(n,o,r){var a=n.getGeometry(),i=6*e.getResolution()/1e3,s=Object(c.c)(a)/1e3,l=a.clone().transform(t,"EPSG:4326");if(s-2*i>i){var u=Object(ko.a)({type:"LineString",coordinates:l.getCoordinates()},i,s-1.5*i);l.setCoordinates(u.geometry.coordinates),l.transform("EPSG:4326",t);var f=l.getCoordinates(),p=f[f.length-1][0]-f[f.length-2][0],d=f[f.length-1][1]-f[f.length-2][1],h=Math.atan2(d,p);return[r({stroke:{color:"white",width:5},geometry:l}),r({stroke:{color:"rgba(0, 0, 0, 0.6)",width:3},geometry:l}),r({shape:{fill:{color:"rgba(0, 0, 0, 0.6)"},stroke:{color:"white",width:1},points:3,radius:8,rotateWithView:!0,rotation:-h,angle:33},geometry:new bo.a(l.getLastCoordinate())})]}return null}})}}])&&So(t.prototype,n),o&&So(t,o),a}(re),Po=n(209),Eo=(n(247),n(248),{test:function(e){return e.filter((function(e){return void 0!==e.get("fstatus")&&void 0!==e.get("type")&&void 0===e.get("wpt")&&e.get("date_hidden")})).length>0},formatFeatures:function(e){var t=new Date;e.features.forEach((function(n){if(n.get("isCache")&&e.user&&e.user===n.get("owner")){n.set("fstatus",e.mapping.fstatusGPX["Geocache Owner"]||"Geocache Owner")}if(void 0===n.get("isCache")){var o=e.mapping.type[n.get("type")]||n.get("type"),r=n.get("name");"Geocache|Unknown Cache"===o&&r&&r.toLowerCase().includes("challenge")&&(o="Geocache|Unknown Cache|Challenge"),n.set("type",o),n.set("isCache","Geocache"===n.get("type").substring(0,8)),n.set("fstatus",e.mapping.fstatusJSON[n.get("fstatus")]||n.get("fstatus")),n.set("status","Available"),n.set("time",n.get("date_hidden")),n.set("url",e.url+n.get("id")),n.set("owner",n.get("user_id")),n.unset("user_id"),n.set("container",e.mapping.container[n.get("size")]||n.get("size")),n.unset("size");var a=new Date(n.get("date_hidden")),i=new Date(a.getFullYear(),a.getMonth(),a.getDate()+e.newCacheDays),c="Not Found"===n.get("fstatus")&&i>t?"New Cache":null;n.get("newCache")||n.set("newCache",c)}n.getId()||n.setId(e.uid())}))}}),_o=(n(394),{test:function(e){var t=e.filter((function(e){return e.get("pgc")&&e.get("content")&&e.get("icon")}));return t.length>0},formatFeatures:function(e){e.features.forEach((function(t){var n=fe()(t.get("content")),o=t.get("icon"),r=fe()(n[2]).text().split(" / ").map((function(e){return e.trim()})),a=fe()(n[0]).text();t.set("isCache",!0);var i="Geocache|"+r[0];"Geocache|Unknown Cache"===i&&a&&a.toLowerCase().includes("challenge")&&(i="Geocache|Unknown Cache|Challenge"),t.set("type",i),t.set("owner","");var c=o.endsWith("&isFound")?"1":"0";o.endsWith("&isOwned")&&e.user&&(c="2",t.set("owner",e.user)),t.set("fstatus",e.mapping.fstatusJSON[c]||c);var s=o.endsWith("&fade")?"Unavailable":"Available";t.set("status",s);var l=fe()(n[0]).attr("href");t.set("id",l?l.split("/").pop():null),t.set("name",a),t.set("url",l),t.set("container",r[1]),t.set("difficulty",r[2]),t.set("terrain",r[3]),t.set("time",null),t.getId()||t.setId(e.uid())}))}});function To(e){return(To="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Mo={test:function(e){return e.filter((function(e){return e.get("wpt")&&e.get("wpt")["groundspeak:cache"]})).length>0},formatFeatures:function(e){var t=new Date;e.features.forEach((function(n){var o=n.get("wpt");if(n.get("isCache")){var r=n.get("sym");e.user&&e.user===n.get("owner")&&(r="Geocache Owner"),n.set("fstatus",e.mapping.fstatusGPX[r]||r)}if(void 0===n.get("isCache")&&o["groundspeak:cache"]){var a={};Object.keys(o["groundspeak:cache"]).forEach((function(e){"_text"!==e&&(a[e.replace("groundspeak:","")]=o["groundspeak:cache"][e]._text?o["groundspeak:cache"][e]._text:o["groundspeak:cache"][e])})),n.set("id",a["@id"]);var i=n.get("type");n.set("isCache","Geocache"===i.substring(0,8)),"Geocache|Unknown Cache"===i&&a.name&&a.name.toLowerCase().includes("challenge")&&n.set("type","Geocache|Unknown Cache|Challenge");var c=n.get("sym");e.user&&e.user===a.owner&&(c="Geocache Owner"),n.set("fstatus",e.mapping.fstatusGPX[c]||c);var s=a["@available"]&&"true"===a["@available"].toLowerCase()?"Available":"Unavailable";a["@archived"]&&"true"===a["@archived"].toLowerCase()&&(s="Archived"),n.set("status",s),n.set("time",o.time._text),n.set("name",a.name),n.set("code",o.name._text),n.set("eid",o.name._text.slice(o.name._text.length-5)),n.set("url",o.url._text),n.set("owner",a.owner),n.set("container",a.container),n.set("difficulty",a.difficulty),n.set("terrain",a.terrain);var l=new Date(n.get("time")),u=new Date(l.getFullYear(),l.getMonth(),l.getDate()+e.newCacheDays),f="Not Found"===n.get("fstatus")&&u>t?"New Cache":null;n.set("newCache",f),a.long_description&&n.set("description",a.long_description),a.logs&&a.logs["groundspeak:log"]&&("object"===To(a.logs["groundspeak:log"])&&"@id"in a.logs["groundspeak:log"]&&(a.logs["groundspeak:log"]=[a.logs["groundspeak:log"]]),n.set("logs",a.logs["groundspeak:log"].map((function(e){return{type:e["groundspeak:type"]._text,date:e["groundspeak:date"]._text,finder:e["groundspeak:finder"]._text,text:e["groundspeak:text"]._text}})))),n.set("wpt",{"groundspeak:cache":!0})}void 0!==n.get("isCachePoint")||o["groundspeak:cache"]||(n.set("name",n.get("type")),n.set("url",o.url._text),n.set("isCachePoint",!0),n.set("pid",o.name._text.slice(o.name._text.length-5)),n.set("hidden",!0)),n.getId()||n.setId(e.uid())}))}};n(395);function Lo(e){return(Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Go(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Fo(e,t){return(Fo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Do(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Io(e);if(t){var r=Io(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return No(this,n)}}function No(e,t){return!t||"object"!==Lo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Io(e){return(Io=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Uo=[Eo,_o,Mo],qo={layer:null,layerOnMap:!1,styleCache:{},styleConfig:W.styles,cacheFormatParser:null,stat:{"Not Found":"far fa-square",Found:"far fa-check-square",Owner:"fas fa-user"},featureCount:0};function Wo(){return qo.layer.getSource().getFeatures().filter((function(e){return e.get("isCache")&&!e.get("hidden")})).length}function Vo(e,t){var n=e.get("type"),o=e.get("fstatus"),r=e.get("newCache"),a=e.get("status"),i=t>W.overviewMinResolution,c=n+o+r+a+i;if(!e.get("_inGeotrip")&&!e.get("isCache")&&t>W.waypointMaxResolution)return null;if(!e.get("_inGeotrip")&&e.get("hidden"))return null;if(!qo.styleCache[c]){var s=P(i?Object.assign({},qo.styleConfig.base,qo.styleConfig.overview,qo.styleConfig.color[o],qo.styleConfig.newCache[r]||{}):Object.assign({},qo.styleConfig.base,qo.styleConfig.text[n],qo.styleConfig.color[o],qo.styleConfig.newCache[r]||{}));"Available"!==a&&(s.fill&&(s.fill.color=O(s.fill.color,.5)),s.stroke&&(s.stroke.color=O(s.stroke.color,.7))),qo.styleCache[c]=rt({text:s,zIndex:e.get("isCache")?2:1})}return e.get("isCache")&&e.get("radiusVisible")&&"Geocache|Locationless Cache"!==n&&"Geocache|Virtual Cache"!==n&&"Geocache|Webcam Cache"!==n&&"Geocache|Event Cache"!==n&&"Geocache|Earthcache"!==n&&"Archived"!==a&&t<=W.radiusStyle.maxResolution?(qo.styleCache.radiusStyle||(qo.styleCache.radiusStyle=rt(qo.styleConfig.radiusStyle)),[qo.styleCache[c],qo.styleCache.radiusStyle]):[qo.styleCache[c]]}function zo(e){if(e)for(var t=0,n=Uo.length;t<n;t++)if(Uo[t].test(e))return qo.cacheFormatParser=Uo[t],!0;return!1}function Bo(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e||0===e.length||!qo.cacheFormatParser)return le("error",ce("No caches to add!")),!1;qo.layerOnMap||($("map/layer/layers").push(qo.layer),qo.layerOnMap=!0),$("cache/import/appendLayer")||qo.layer.getSource().clear(),qo.cacheFormatParser.formatFeatures({features:e,newCacheDays:W.newCacheDays,mapping:W.mapping,user:$("app/account"),uid:S,url:W.cacheUrl,date:C}),qo.featureCount=e.length,qo.layer.getSource().addFeatures(e),Q("geocache/loadend",qo.layer),Q("layerchange",["layers",qo.layer.get("id")]),t||le("success","".concat(ce("Imported")," ").concat(Wo()," ").concat(ce("caches"))),$("app/debug")&&console.debug("Geocache.createCacheLayer: "+e.length)}var Ho=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fo(e,t)}(a,e);var t,n,o,r=Do(a);function a(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()('\n      <div id="geocache" class="btn-group">\n        <button\n          class="btn btn-secondary"\n          title="'.concat(ce("Caches"),'">\n          <i class="fa fa-cube"></i>\n          <span>').concat(ce("Caches"),"</span>\n        </button>\n      </div>\n    ")),qo.styleConfig.radiusStyle.geometry=function(e){var t=e.getGeometry().getCoordinates(),n=v(Object(He.q)(t));return new Po.a(t,W.radiusStyle.radius*n)},t.create(),t.sidebar=new Ut({target:fe()("#geop"),trigger:t.el.find("button"),position:"left",components:{GeocacheLoader:Jt,GeocacheInfo:Tn,Filter:In,Geotrip:Ro},activeComponent:"tab-loader",shadow:!1});var n=function(e){var n=Wo();t.el.find("button > span").html(n||ce("Caches")),t.sidebar.getComponent("Filter").get("tab").find("span").html(n||ce("Filter"))},o=$("map/layer/layers");o.forEach((function(e){e&&"function"==typeof e.getSource().getFeatures&&zo(e.getSource().getFeatures())&&(qo.layer=t.createLayer(e),qo.layerOnMap=!0,Bo(e.getSource().getFeatures(),!0))})),o.on("remove",(function(e){e.element.get("id")===qo.layer.get("id")&&!0!==$("ui/layermanager/sorting")&&(qo.layer.getSource().clear(),Q("geocache/loadend",qo.layer),n(),qo.layerOnMap=!1)})),qo.layer||(qo.layer=t.createLayer());var i=0;return qo.layer.getSource().on("addfeature",(function(e){++i>=qo.featureCount&&(n(),qo.featureCount=0,i=0)})),qo.layer.getSource().on("clear",n),ee("geocache/filter",(function(){n(),Q("layerchange",["layers",qo.layer.get("id")])})),n(),t}return t=a,(n=[{key:"createLayer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e||(e=wt({type:"FeatureCollection",id:S(),title:ce("Caches"),visible:!0})),e.set("_featureInfo",{title:function(e){var t=$("geocache/trip"),n=t&&t.getArray().indexOf(e)>-1,o=qo.styleConfig.text[e.get("type")];return e.get("isCache")?'\n            <i\n              class="fstatus '.concat(o?o.class:qo.styleConfig.base.class," ").concat("Available"!==e.get("status")?"unavailable":"",'"\n              style="color:').concat(qo.styleConfig.color[e.get("fstatus")].fill.color,'"></i>\n            <a href="').concat(e.get("url"),'" target="_blank" class="').concat("Archived"===e.get("status")?"archived":"",'">').concat(ce(e.get("name")),'</a>\n            <div class="tools">\n              <a href="#" class="cache-toggle" data-id="').concat(e.getId(),'" title="').concat(ce("Add to geotrip"),'">\n                <i class="fas ').concat(n?"fa-minus-square":"fa-thumbtack",'"></i>\n              </a>\n            </div>'):'\n            <i class="'.concat(o?o.class:qo.styleConfig.base.class,'"></i>\n            <a href="').concat(e.get("url"),'" target="_blank">').concat(ce(e.get("name")),'</a>\n            <div class="tools">\n              <a href="#" class="cache-toggle" data-id="').concat(e.getId(),'" title="').concat(ce("Add to geotrip"),'">\n                <i class="fas ').concat(n?"fa-minus-square":"fa-thumbtack",'"></i>\n              </a>\n            </div>')},content:function(e){var t=qo.styleConfig.text[e.get("type")];return e.get("isCache")?'\n            <p class="text-muted metadata">\n              <i class="fas fa-clock"></i> '.concat(e.get("time")?C(e.get("time")):"",'<br/>\n              <i class="fa fa-user"></i> ').concat(e.get("owner"),'<br/>\n              <i class="').concat(t?t.class:qo.styleConfig.base.class,'"></i>\n              ').concat(ce(e.get("type")),'<br/>\n              <i class="fa fa-chart-area"></i> ').concat(e.get("terrain"),'\n              <i class="fa fa-star ml-2"></i> ').concat(e.get("difficulty"),'\n              <i class="fa fa-expand-arrows-alt ml-2"></i> ').concat(ce(e.get("container")),"<br/>\n              ").concat(e.get("cmt")?'<i class="fa fa-hand-point-right"></i> '.concat(e.get("cmt")):"",'\n            </p>\n            <p class="toggle-found">\n              <i class="').concat(qo.stat[e.get("fstatus")],'"></i> <span>').concat(ce(e.get("fstatus")),"</span>\n            </p>"):"\n            <p>\n              ".concat(e.get("desc"),"\n            </p>")},onShow:function(e,t){var n=e[1].get("fstatus");n&&fe()(t).find("h3 i.fstatus").css("color",qo.styleConfig.color[n].fill.color);var o=$("geocache/trip");fe()(t).on("click",".toggle-found",(function(r){var a=o&&o.getArray().indexOf(e[1])>-1,i="Found"===n;if(fe()(r.currentTarget).find("i").removeClass(qo.stat[e[1].get("fstatus")]),e[1].set("fstatus",i?"Not Found":"Found"),e[1].set("fstatus_timestamp",i?null:Date.now()),fe()(r.currentTarget).find("span").html(ce(e[1].get("fstatus"))),fe()(r.currentTarget).find("i").addClass(qo.stat[e[1].get("fstatus")]),a||i||o.push(e[1]),a){var c=o.getArray().indexOf(e[1]);o.remove(e[1]),o.insertAt(c,e[1])}fe()(t).popover("dispose")}))}}),e.setStyle(Vo),e}}])&&Go(t.prototype,n),o&&Go(t,o),a}(re),Jo=(n(285),n(116)),Yo=n(45),Zo=n(22),Xo=n(10),Ko=n(0),Qo=n(3);function $o(e){var t={};if(1===e.nodeType)for(var n=0,o=e.attributes.length;n<o;n++){var r=e.attributes.item(n);t["@"+r.nodeName]=r.nodeValue}else if(3===e.nodeType)return e.nodeValue.trim();if(e.hasChildNodes())for(var a,i=0,c=e.childNodes.length;i<c;i++){var s=e.childNodes.item(i),l=s.nodeName.replace("#","_");if(void 0===t[l])("string"!=typeof(a=$o(s))||a.length)&&(t[l]=a);else{if(void 0===t[l].push){var u=t[l];t[l]=[],("string"!=typeof u||u.length)&&t[l].push(u)}("string"!=typeof(a=$o(s))||a.length)&&t[l].push(a)}}return t}function er(e){return(er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nr(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function or(e,t){return(or=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ir(e);if(t){var r=ir(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return ar(this,n)}}function ar(e,t){return!t||"object"!==er(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ir(e){return(ir=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cr=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1","http://www.groundspeak.com/cache/1/0"],sr=Object(Ko.q)(cr,{text:Object(Ko.m)(Qo.e,"linkText"),type:Object(Ko.m)(Qo.e,"linkType")}),lr=Object(Ko.q)(cr,{rte:Object(Ko.i)((function(e,t){var n=t[0],o=Object(Ko.t)({flatCoordinates:[],layoutOptions:{}},fr,e,t);if(!o)return;var r=o.flatCoordinates;delete o.flatCoordinates;var a=o.layoutOptions;delete o.layoutOptions;var i=wr(a,r),c=new vo.a(r,i);Object(Yo.b)(c,!1,n);var s=new wo.a(c);return s.setProperties(o),s})),trk:Object(Ko.i)((function(e,t){var n=t[0],o=Object(Ko.t)({flatCoordinates:[],ends:[],layoutOptions:{}},pr,e,t);if(!o)return;var r=o.flatCoordinates;delete o.flatCoordinates;var a=o.ends;delete o.ends;var i=o.layoutOptions;delete o.layoutOptions;var c=wr(i,r,a),s=new Jo.a(r,c,a);Object(Yo.b)(s,!1,n);var l=new wo.a(s);return l.setProperties(o),l})),wpt:Object(Ko.i)((function(e,t){var n=t[0],o=Object(Ko.t)({},ur,e,t);if(!o)return;var r={},a=vr([],r,e,o),i=wr(r,a),c=new bo.a(a,i);Object(Yo.b)(c,!1,n);var s=new wo.a(c);return s.setProperties(o),s.set("wpt",$o(e)),s}))}),ur=Object(Ko.q)(cr,{ele:Object(Ko.m)(Qo.c),time:Object(Ko.m)(Qo.b),magvar:Object(Ko.m)(Qo.c),geoidheight:Object(Ko.m)(Qo.c),name:Object(Ko.m)(Qo.e),cmt:Object(Ko.m)(Qo.e),desc:Object(Ko.m)(Qo.e),src:Object(Ko.m)(Qo.e),link:mr,sym:Object(Ko.m)(Qo.e),type:Object(Ko.m)(Qo.e),fix:Object(Ko.m)(Qo.e),sat:Object(Ko.m)(Qo.d),hdop:Object(Ko.m)(Qo.c),vdop:Object(Ko.m)(Qo.c),pdop:Object(Ko.m)(Qo.c),ageofdgpsdata:Object(Ko.m)(Qo.c),dgpsid:Object(Ko.m)(Qo.d),extensions:br}),fr=Object(Ko.q)(cr,{name:Object(Ko.m)(Qo.e),cmt:Object(Ko.m)(Qo.e),desc:Object(Ko.m)(Qo.e),src:Object(Ko.m)(Qo.e),link:mr,number:Object(Ko.m)(Qo.d),extensions:br,type:Object(Ko.m)(Qo.e),rtept:function(e,t){var n=Object(Ko.t)({},dr,e,t);if(n){var o=t[t.length-1],r=o.flatCoordinates,a=o.layoutOptions;vr(r,a,e,n)}}}),pr=Object(Ko.q)(cr,{name:Object(Ko.m)(Qo.e),cmt:Object(Ko.m)(Qo.e),desc:Object(Ko.m)(Qo.e),src:Object(Ko.m)(Qo.e),link:mr,number:Object(Ko.m)(Qo.d),type:Object(Ko.m)(Qo.e),extensions:br,trkseg:function(e,t){var n=t[t.length-1];Object(Ko.s)(hr,e,t);var o=n.flatCoordinates;n.ends.push(o.length)}}),dr=Object(Ko.q)(cr,{ele:Object(Ko.m)(Qo.c),time:Object(Ko.m)(Qo.b)}),hr=Object(Ko.q)(cr,{trkpt:function(e,t){var n=Object(Ko.t)({},yr,e,t);if(n){var o=t[t.length-1],r=o.flatCoordinates,a=o.layoutOptions;vr(r,a,e,n)}}}),yr=Object(Ko.q)(cr,{ele:Object(Ko.m)(Qo.c),time:Object(Ko.m)(Qo.b)}),gr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&or(e,t)}(a,e);var t,n,o,r=rr(a);function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return tr(this,a),r.call(this,e)}return t=a,(n=[{key:"readFeaturesFromNode",value:function(e,t){if(!Object(Xo.f)(cr,e.namespaceURI))return[];if("gpx"===e.localName){var n=Object(Ko.t)([],lr,e,[this.getReadOptions(e,t)]);return n?(this.handleReadExtensions_(n),n):[]}return[]}}])&&nr(t.prototype,n),o&&nr(t,o),a}(s.a);function mr(e,t){var n=t[t.length-1],o=e.getAttribute("href");null!==o&&(n.link=o),Object(Ko.s)(sr,e,t)}function br(e,t){t[t.length-1].extensionsNode_=e}function vr(e,t,n,o){return e.push(parseFloat(n.getAttribute("lon")),parseFloat(n.getAttribute("lat"))),"ele"in o?(e.push(o.ele),delete o.ele,t.hasZ=!0):e.push(0),"time"in o?(e.push(o.time),delete o.time,t.hasM=!0):e.push(0),e}function wr(e,t,n){var o=Zo.a.XY,r=2;if(e.hasZ&&e.hasM?(o=Zo.a.XYZM,r=4):e.hasZ?(o=Zo.a.XYZ,r=3):e.hasM&&(o=Zo.a.XYM,r=3),4!==r){for(var a=0,i=t.length/4;a<i;a++)t[a*r]=t[4*a],t[a*r+1]=t[4*a+1],e.hasZ&&(t[a*r+2]=t[4*a+2]),e.hasM&&(t[a*r+2]=t[4*a+3]);if(t.length=t.length/4*r,n)for(var c=0,s=n.length;c<s;c++)n[c]=n[c]/4*r}return o}var kr=n(268),Ar=n(171);function Sr(e){return(Sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Or(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function jr(e,t){return(jr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Rr(e);if(t){var r=Rr(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Cr(this,n)}}function Cr(e,t){return!t||"object"!==Sr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rr(e){return(Rr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pr(e){return{stroke:{color:e,width:2},fill:{color:O(e,.5)},circle:{stroke:{color:e},fill:{color:O(e,.3)}}}}var Er=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jr(e,t)}(a,e);var t,n,o,r=xr(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),t=r.call(this,e),window.File&&window.FileReader&&window.FileList&&window.Blob?(t.el=fe()("<li />"),t.isRow=!0,t.fileTypes={gpx:new gr,geojson:new Be.a,kml:new kr.a},t.fileTypes.json=t.fileTypes.geojson,t.state={layers:$("map/layer/layers")},t.addDragNDrop(),t):Cr(t)}return t=a,(n=[{key:"render",value:function(){var e=this,t=$("app/debug");this.el.html('\n      <a href="#"\n        id="add-file-layer"\n        class="dropdown-item">\n        <i class="fa fa-plus"></i>\n        '.concat(ce("Add File layer"),'\n      </a>\n      <input type="file" style="display:none;" />\n    ')),this.el.on("click","a#add-file-layer",(function(e){e.preventDefault(),e.stopPropagation(),fe()(e.target).closest("li").find("input").trigger("click")})),this.el.on("change","input",(function(n){var o=n.target.files;if(o&&o[0]){var r=o[0].name,a=r.split(".").pop().toLowerCase();if(a in e.fileTypes){t&&console.debug("FileLayer.render input change: ".concat(r));var i=new window.FileReader;i.onload=function(t){var n=e.fileTypes[a].readFeatures(t.target.result);e.addLayer(r,n)},i.readAsText(o[0])}else le("error",ce("Unsupported file type")),t&&console.error("FileLayer.render Unsupported file type: ".concat(r))}}))}},{key:"addDragNDrop",value:function(){var e=this,t=$("map"),n=!1;if(t&&t.getInteractions().forEach((function(e){e instanceof Ar.a&&(n=!0)})),!n){var o=new Ar.a({projection:"EPSG:4326",formatConstructors:[gr,Be.a,kr.a]});o.on("addfeatures",(function(t){e.addLayer(t.file.name,t.features)})),t?t.addInteraction(o):$("map/que").push((function(e){e.addInteraction(o)}))}}},{key:"createLayer",value:function(e){if(e.features.length>0){var t=function(e){return i()(e)}({luminosity:"dark"});e.id=S(),e.features&&e.features.forEach((function(e){e.id=S()})),e.color=t,e.visible=!0,e.style=Pr(t);try{return wt(e)}catch(t){le("error",ce("Error creating layer")+t),$("app/debug")&&console.debug("FileLayer.addDragNDrop layer created: ".concat(t.file.name,", features: ").concat(e.features.length))}}else le("error",ce("Empty file")),$("app/debug")&&console.debug("FileLayer.addDragNDrop empty file: ".concat(e.title))}},{key:"addLayer",value:function(e,t){var n=$("app/debug"),o=this.fileTypes.geojson.writeFeaturesObject(t);o.title=e;var r=this.createLayer(o);zo(t=r.getSource().getFeatures())?Bo(t):r&&(this.state.layers.push(r),le("success","".concat(ce("Added")," ").concat(o.features.length," ").concat(ce("features"))),n&&console.debug("FileLayer layer created: ".concat(e,", features: ").concat(o.features.length)))}}])&&Or(t.prototype,n),o&&Or(t,o),a}(re);n(396);function _r(e){return(_r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tr(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Mr(e,t){return(Mr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Fr(e);if(t){var r=Fr(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Gr(this,n)}}function Gr(e,t){return!t||"object"!==_r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fr(e){return(Fr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Dr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mr(e,t)}(a,e);var t,n,o,r=Lr(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()('\n      <a href="#" id="osm-edit" title="'.concat(ce("Edit OSM here"),'">\n        <i class="fa fa-edit"></i>\n      </a>\n    ')),t.isRow=!1,t}return t=a,(n=[{key:"render",value:function(){this.el.on("click",(function(e){e.preventDefault();var t=$("map/center"),n=$("map/zoom");window.open(q.ideditor+n+"/"+t[1]+"/"+t[0])}))}}])&&Tr(t.prototype,n),o&&Tr(t,o),a}(re);function Nr(e){return(Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ir(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ur(e,t,n){return(Ur="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zr(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function qr(e,t){return(qr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=zr(e);if(t){var r=zr(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Vr(this,n)}}function Vr(e,t){return!t||"object"!==Nr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zr(e){return(zr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Br=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qr(e,t)}(a,e);var t,n,o,r=Wr(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()("<li />"),t.modal=fe()("#modal_wmslayer"),t.isRow=!0,t.layer_conf={TileWMS:{type:"TileWMS",url:null,projection:"EPSG:3301",gutter:20,crossOrigin:null},WMTS:{type:"WMTS",url:null,projection:"EPSG:3301",layer:null,matrixSet:null,scaleDenominator:null,topLeftCorner:null,matrixWidth:1,matrixHeight:1,format:"image/png",crossOrigin:null}},t.layer_conf_params={LAYERS:null,TILED:!0,FORMAT:"image/png",VERSION:"1.1.1"},t}return t=a,(n=[{key:"render",value:function(){var e=this;if(!this.modal||0===this.modal.length){var t=Object.keys(q.wmsexamples).map((function(e){return'<a href="'.concat(q.wmsexamples[e],'">\n          ').concat(e,"\n        </a>")}));this.modal=fe()('\n        <div class="modal fade"\n          id="modal_wmslayer"\n          tabindex="-1"\n          role="dialog"\n          aria-hidden="true">\n          <div class="modal-dialog">\n            <div class="modal-content">\n              <div class="modal-header">\n                <h4 class="modal-title">'.concat(ce("Add WMS layer"),'</h4>\n                <button type="button"\n                  class="close"\n                  data-dismiss="modal"\n                  aria-label="Close">\n                  <span aria-hidden="true">&times;</span>\n                </button>\n              </div>\n              <div class="modal-body">\n                <div class="text-muted">\n                  ').concat(ce("Insert WMS/WMTS URL"),'\n                </div>\n                <textarea class="form-control" rows="3"></textarea>\n                <input name="id" type="hidden" />\n                <div class="form-inline py-2">\n                  <div class="form-check form-check-inline">\n                    <input class="form-check-input" type="radio" name="group" id="group1" value="base">\n                    <label class="form-check-label" for="group1">').concat(ce("Add as base map"),'</label>\n                  </div>\n                  <div class="form-check form-check-inline">\n                    <input class="form-check-input" type="radio" name="group" id="group2" value="layers" checked>\n                    <label class="form-check-label" for="group2">').concat(ce("Add as overlay"),'</label>\n                  </div>\n                </div>\n                <div class="small examples">\n                  ').concat(t.length?"<b>Näited:</b><br>":"","\n                  ").concat(t.join("<br/>"),'\n                </div>\n              </div>\n              <div class="modal-footer">\n                <button type="button" class="btn btn-secondary confirm">').concat(ce("Add"),"</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      ")),this.modal.on("click","button.confirm",(function(t){if(t.preventDefault(),!(e.modal.find("textarea").val().length<10)){var n=e.modal.find("input[name=group]:checked").val(),o=$("map/layer/"+n),r=o.getLength();if(e.modal.find("input[name=id]").val().length){var a=o.getArray().filter((function(t){return t.get("id")===e.modal.find("input[name=id]").val()}));a.length&&(r=o.getArray().indexOf(a[0]),o.remove(a[0]))}var i=e.createLayer(e.modal.find("textarea").val().trim(),"base"===n);i&&(o.insertAt(r,i),e.modal.find("textarea, input[name=id]").val(""),e.modal.modal("hide"))}})),this.modal.on("click",".examples a",(function(t){t.preventDefault(),e.modal.find("textarea").val(decodeURIComponent(t.target.href))})),fe()("body").append(this.modal)}this.el.html('\n      <a href="#"\n        id="add-wms-layer"\n        class="dropdown-item"\n        data-toggle="modal"\n        data-target="#modal_wmslayer">\n        <i class="fa fa-plus"></i>\n        '.concat(ce("Add WMS layer"),"\n      </a>\n    "))}},{key:"createLayer",value:function(e,t){var n=$("app/debug"),o=k(e);if(null!==e.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/g)&&o.query){var r=this.pickService(o.query);if(!r||!(r in this.layer_conf))return!1;var a=Object.assign({},this.layer_conf[r],o.query);switch(r){case"TileWMS":if(a.params=Object.assign({},this.layer_conf_params),!o.query.LAYERS&&!o.query.layers)return le("error",ce("Missing LAYERS parameter")),void(n&&console.error("WMSLayer.createLayer: Missing LAYERS parameter - ".concat(e)));a.params.LAYERS=o.query.LAYERS||o.query.layers,a.title=o.query.title||a.params.LAYERS,delete o.query.LAYERS,delete o.query.layers;break;case"WMTS":a.topLeftCorner=o.query.topLeftCorner.split(",").map((function(e){return Number(e)})),a.title=o.query.title||a.layer,a.scaleDenominator=Number(o.query.scaleDenominator),a.matrixWidth=Number(o.query.matrixWidth),a.matrixHeight=Number(o.query.matrixHeight),delete o.query.topLeftCorner,delete o.query.layer,delete o.query.matrixSet,delete o.query.scaleDenominator,delete o.query.matrixWidth,delete o.query.matrixHeight,delete o.query.format}return o.query.SRS||o.query.srs?(a.projection=o.query.srs||o.query.SRS,delete o.query.SRS,delete o.query.srs,delete o.query.title,a.url=A(o),a.id=S(),a.visible=!0,a.opacity=Number(o.query.opacity)||1,a.editable=!0,t&&(a.zIndex=0),wt(a)):(le("error",ce("Missing SRS parameter")),void(n&&console.error("WMSLayer.createLayer: Missing SRS parameter - ".concat(e))))}return le("error",ce("URL is not valid WMS resource!")),n&&console.error("WMSLayer.createLayer: URL is not valid WMS resource! - ".concat(e)),null}},{key:"destroy",value:function(){this.modal.modal("dispose"),this.modal.remove(),this.modal=null,Ur(zr(a.prototype),"destroy",this).call(this)}},{key:"pickService",value:function(e){return"matrixSet"in e?"WMTS":"layers"in e&&"TileWMS"}}])&&Ir(t.prototype,n),o&&Ir(t,o),a}(re);function Hr(e){return(Hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jr(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Yr(e,t){return(Yr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Kr(e);if(t){var r=Kr(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Xr(this,n)}}function Xr(e,t){return!t||"object"!==Hr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kr(e){return(Kr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yr(e,t)}(a,e);var t,n,o,r=Zr(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).format=new Be.a,t.state={layers:$("map/layer/layers")},t.init(),t}return t=a,(n=[{key:"init",value:function(){var e,t=this,n=G("hash"),o=G("view");n&&(e=this.loadFeaturesFromUrl(n));var r=G("icon");if(r&&(e=this.addMarker(r)),!o&&e){var a=$("map");a?this.fitTo(a,e):$("map/que").push((function(n){t.fitTo(n,e)}))}}},{key:"fitTo",value:function(e,t){e.getView().fit(t,{padding:[100,100,100,100],maxZoom:14,duration:500})}},{key:"loadFeaturesFromUrl",value:function(e){F({hash:null});var t=de.a.unpack(decodeURIComponent(e));if(t&&t.length){var n=t.map((function(e){return e.id}));n&&n.length&&Q("geocache/trip/ids",n,!0);var o=t.filter((function(e){return void 0!==e.properties.fstatus})),r=t.filter((function(e){return void 0===e.properties.fstatus})),a=[];if(o.length){var i=this.createLayer("Geocaches",o);Object(Je.q)(a,i.getSource().getExtent()),this.state.layers.push(i)}if(r.length){var c=this.createLayer("Features",r);Object(Je.q)(a,c.getSource().getExtent()),this.state.layers.push(c)}return $("app/debug")&&console.error("UrlLayer.loadFeaturesFromUrl: caches ".concat(o.length,", features ").concat(r.length)),a}return null}},{key:"addMarker",value:function(e){var t=e.split("/");if(t&&2===t.length){var n={type:"Feature",id:S(),geometry:{type:"Point",coordinates:[Number(t[1]),Number(t[0])]},properties:{name:"Point"}},o=this.createLayer("Point",[n],{text:{text:"",class:"fas fa-map-marker-alt",font:'900 24px "Font Awesome 5 Free"',textBaseline:"bottom",fill:{color:"#000"},stroke:{color:"#fff",width:4}}}),r=$("map");return r?o.setMap(r):$("map/que").push((function(e){o.setMap(e)})),$("app/debug")&&console.error("UrlLayer.addMarker: ".concat(e)),o.getSource().getExtent()}return null}},{key:"createLayer",value:function(e,t,n){return wt({type:"FeatureCollection",id:S(),title:ce(e),visible:!0,features:t,style:n})}}])&&Jr(t.prototype,n),o&&Jr(t,o),a}(re);n(397);function $r(e){return($r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ea(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ta(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ta(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function ta(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function na(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function oa(e,t,n){return(oa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ca(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function ra(e,t){return(ra=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function aa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ca(e);if(t){var r=ca(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return ia(this,n)}}function ia(e,t){return!t||"object"!==$r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ca(e){return(ca=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ra(e,t)}(a,e);var t,n,o,r=aa(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()('<div class="btn-group float-right" id="layermanager"></div>'),t.state={activeBaseLayer:null,base:$("map/layer/base"),layers:$("map/layer/layers"),overlays:$("map/layer/overlays"),open:!1},t.handlers={onbaselayerschange:function(e){t.changeBaseLayer(e.element.get("id"))||(t.state.open=!0,t.render())},onchange:function(){$("ui/layermanager/sorting")||t.render()}},t.state.base.forEach((function(e){e.get("id")===$("map/baseLayer")&&(t.state.activeBaseLayer=e)})),t.state.base.on("add",t.handlers.onbaselayerschange),t.state.base.on("remove",t.handlers.onbaselayerschange),t.state.layers.on("add",t.handlers.onchange),t.state.layers.on("remove",t.handlers.onchange),t.state.overlays.on("add",t.handlers.onchange),t.state.overlays.on("remove",t.handlers.onchange),t.create(),t.components={osm:Dr,wms:Br,file:Er},t.renderComponents(t.el.find(".dropdown-menu")),t.urlLayer=new Qr,D((function(e){if(e.view){var n=t.permalinkToViewConf(e.view);n&&t.changeBaseLayer(n)}})),t}return t=a,(n=[{key:"create",value:function(){oa(ca(a.prototype),"create",this).call(this),this.target&&this.el}},{key:"render",value:function(){var e=this;this.el.html('\n      <button type="button"\n        class="btn btn-secondary toggle-btn dropdown-toggle no-caret"\n        data-toggle="dropdown"\n        aria-label="'.concat(ce("Layers"),'"\n        aria-expanded="false">\n        <span class="display-name d-none d-sm-inline-block">\n          ').concat(this.state.activeBaseLayer?ce(this.state.activeBaseLayer.get("title")):ce("Layers"),'\n        </span>\n        <i class="fa fa-layer-group"></i>\n      </button>\n      <ul class="dropdown-menu dropdown-menu-right">\n        ').concat(this.state.base.getLength()>0?this.state.base.getArray().map((function(t){var n="";return"FeatureCollection"===t.get("conf").type?n='<a href="#" class="fit-layer">\n            <i class="fa fa-search-plus"></i>\n          </a>':t.get("conf").editable&&(n='<a href="#" class="edit-layer" data-toggle="modal" data-target="#modal_wmslayer">\n            <i class="fa fa-edit"></i>\n          </a>\n          <a href="#" class="remove-layer">\n            <i class="fa fa-times"></i>\n          </a>'),'\n        <li\n          class="dropdown-item baselayer '.concat(e.layerVisible(t)?"":"disabled",'"\n          data-group="base" data-id="').concat(t.get("id"),'">\n          <label>\n            <i class="check far ').concat(t.getVisible()?"fa-dot-circle":"fa-circle",'"></i>\n            <span class="layer-title">').concat(ce(t.get("title")),"</span>\n          </label>\n          ").concat(n.length?'<div class="layer-tools">\n            '.concat(n,"\n          </div>"):"","\n        </li>")})).join(""):'<li class="dropdown-item disabled">'.concat(ce("No baselyers added"),"</li>"),"\n        ").concat(this.renderLayerGroup("overlays",this.state.overlays),"\n        ").concat(this.renderLayerGroup("layers",this.state.layers,!0),"\n      </ul>"));var t=this.el.find(".dropdown-menu");this.renderComponents(t),this.state.open&&(this.el.find("button.toggle-btn").dropdown("toggle"),this.state.open=!1),t.on("click",".baselayer label",(function(t){t.preventDefault(),t.stopPropagation();var n=fe()(t.currentTarget).closest("li").data("id");e.state.activeBaseLayer&&n===e.state.activeBaseLayer.get("id")?e.toggleLayer("base",n):e.changeBaseLayer(n)&&F({view:N({center:$("map/center"),zoom:$("map/zoom"),rotation:$("map/rotation"),baseLayer:n})})})),t.on("click",".layer label",(function(t){t.preventDefault(),t.stopPropagation(),e.toggleLayer(fe()(t.currentTarget).closest("li").data("group"),fe()(t.currentTarget).closest("li").data("id"))})),t.on("click",".tools a",(function(e){e.preventDefault(),e.stopPropagation()})),t.on("click","a.fit-layer",(function(t){t.preventDefault(),t.stopPropagation(),e.fitTo(fe()(t.currentTarget).closest("li").data("group"),fe()(t.currentTarget).closest("li").data("id"))})),t.on("click","a.remove-layer",(function(t){t.preventDefault(),t.stopPropagation(),e.removeLayer(fe()(t.currentTarget).closest("li").data("group"),fe()(t.currentTarget).closest("li").data("id"))})),t.on("change","input[type=color]",(function(t){e.setLayerColor(fe()(t.currentTarget).closest("li").data("group"),fe()(t.currentTarget).closest("li").data("id"),t.target.value),fe()(t.currentTarget).closest(".color").find(".dot").css("background",t.target.value)})),t.on("click",".colorpicker",(function(e){e.preventDefault(),e.stopPropagation(),fe()(e.currentTarget).closest(".color").find("input[type=color]").click()})),t.on("click","a.edit-layer",(function(t){t.preventDefault(),t.stopPropagation();var n=fe()(t.currentTarget).closest("li").data("id"),o=fe()(t.currentTarget).closest("li").data("group"),r=e.getWMSUrl(o,n);r&&(fe()(fe()(t.currentTarget).data("target")).modal(),fe()(fe()(t.currentTarget).data("target")).find("textarea").val(r),fe()(fe()(t.currentTarget).data("target")).find("input[name=id]").val(n),fe()(fe()(t.currentTarget).data("target")).find("input[type=radio]").filter("[value=".concat(o,"]")).prop("checked",!0))})),mo.a.create(t[0],{draggable:"li.sort-item",handle:".sort-handle",onUpdate:function(t){e.reorderLayers(t)}})}},{key:"renderLayerGroup",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t.getLength()>0?'<li class="dropdown-divider"></li>'+t.getArray().map((function(t){var r=t.get("conf").color&&!t.get("_cacheFormatParser")?'<span class="color">\n              <span class="colorpicker">\n                <i class="dot" style="background:'.concat(t.get("conf").color,'"></i>\n              </span>\n              <input type="color" class="" value="').concat(t.get("conf").color,'"/>\n            </span>'):"",a="";"FeatureCollection"===t.get("conf").type?a='<a href="#" class="fit-layer">\n              <i class="fa fa-search-plus"></i>\n            </a>':t.get("conf").editable&&(a='<a href="#" class="edit-layer" data-toggle="modal" data-target="#modal_wmslayer">\n              <i class="fa fa-edit"></i>\n            </a>');var i=o?'<a href="#" class="sort-handle">\n              <i class="dot"></i>\n            </a>':"";return'\n          <li\n            class="dropdown-item '.concat(o?"sort-item":""," layer ").concat(n.layerVisible(t)?"":"disabled",'"\n            data-group="').concat(e,'" data-id="').concat(t.get("id"),'">\n            ').concat(r,'\n            <label>\n              <i class="check far ').concat(t.getVisible()?"fa-check-square":"fa-square",'"></i>\n              <span class="layer-title">').concat(ce(t.get("title")),'</span>\n            </label>\n            <div class="layer-tools">\n              ').concat(i,"\n              ").concat(a,'\n              <a href="#" class="remove-layer">\n                <i class="fa fa-times"></i>\n              </a>\n            </div>\n          </li>')})).join(""):""}},{key:"permalinkToViewConf",value:function(e){return(e?e.split("-"):[])[4]}},{key:"layerVisible",value:function(e){return!(e.minResolution&&this._map.getView().getResolution()<e.minResolution||e.maxResolution&&this._map.getView().getResolution()>e.maxResolution)}},{key:"changeBaseLayer",value:function(e){var t=this.state.base.getArray().filter((function(t){return t.get("id")===e}));return 1===t.length&&(this.state.base.forEach((function(e){e.setVisible(!1)})),t[0].setVisible(!0),this.state.activeBaseLayer=t[0],Q("map/baseLayer",e,!0),this.state.open=!0,this.render(),!0)}},{key:"toggleLayer",value:function(e,t){this.state[e].forEach((function(n){n.get("id")===t&&(n.setVisible(!n.getVisible()),Q("layerchange",[e,t]))})),this.state.open=!0,this.render()}},{key:"removeLayer",value:function(e,t){var n=this;this.state[e].forEach((function(o){o&&o.get("id")===t&&(n.state.open=!0,n.state[e].remove(o))}))}},{key:"reorderLayers",value:function(e){var t=this;if(e.oldDraggableIndex!==e.newDraggableIndex){var n=fe()(e.item).data("id"),o=fe()(e.item).data("group");this.state[o].forEach((function(r){r.get("id")===n&&(Q("ui/layermanager/sorting",!0),t.state[o].remove(r),t.state[o].insertAt(e.newDraggableIndex,r),Q("ui/layermanager/sorting",!1))}))}}},{key:"fitTo",value:function(e,t){var n,o=ea(this.state[e].getArray());try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r&&r.get("id")===t){this.state.open=!0;var a=r.getSource().getExtent?r.getSource().getExtent():r.getExtent();a?$("map").getView().fit(a,{padding:[50,50,50,50],maxZoom:17,duration:500}):(le("error","".concat(ce("Unable to find layer extent"))),$("app/debug")&&console.error("LayerManager.fitTo: no bbox ".concat(e,", ").concat(t)));break}}}catch(e){o.e(e)}finally{o.f()}}},{key:"renderComponents",value:function(e){var t=this,n=!1;Object.keys(this.components).forEach((function(o){var r=new t.components[o](e);r&&r.isRow&&!n&&(e.append('<div class="dropdown-divider"></div>'),n=!0),r.create()}))}},{key:"setLayerColor",value:function(e,t,n){var o=this;this.state[e].forEach((function(r){if(r&&r.get("id")===t){var a=r.get("conf");return a.color=n,a.style=Pr(n),r.set("conf",a),r.setStyle(rt(a.style)),o.storeLayers(e),!0}}))}},{key:"getWMSUrl",value:function(e,t){var n,o=ea(this.state[e].getArray());try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r&&r.get("id")===t){var a=r.get("conf"),i=k(a.url);switch(i.query.srs=a.projection,i.query.title=r.get("title"),a.format&&(i.query.format=a.format),a.type){case"TileWMS":i.query.layers=a.params.LAYERS;break;case"WMTS":i.query.layer=a.layer,i.query.matrixSet=a.matrixSet,i.query.scaleDenominator=a.scaleDenominator,i.query.matrixWidth=a.matrixWidth,i.query.matrixHeight=a.matrixHeight,i.query.topLeftCorner=a.topLeftCorner.join(",")}return A(i)}}}catch(e){o.e(e)}finally{o.f()}return null}},{key:"storeLayers",value:function(e){Q("layer/"+e,this.state[e].getArray().map((function(e){return e.get("conf")})),!0)}}])&&na(t.prototype,n),o&&na(t,o),a}(re);n(398),n(186),n(185);function la(e){return(la="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ua(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function fa(e,t){return(fa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ha(e);if(t){var r=ha(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return da(this,n)}}function da(e,t){return!t||"object"!==la(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ha(e){return(ha=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ya=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fa(e,t)}(a,e);var t,n,o,r=pa(a);function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=r.call(this)).title="Addresses",e.xhr=null,e}return t=a,(n=[{key:"test",value:function(e){return e.length>=3}},{key:"find",value:function(e){var t=this;return new Promise((function(n,o){if(!t.test(e))throw new Error(ce("Query string too short, aborting!"));t.geocode(e,(function(e){if(!e)throw new Error(ce("Unable to perform search!"));n(t.format(e))}))}))}},{key:"geocode",value:function(e,t){this.clear(),this.xhr=fe.a.ajax({type:"GET",crossDomain:!0,url:q.nominatim+"/search/",data:{q:e,countrycodes:$("app/nominatimCountries")||"",format:"json"},dataType:"json",context:this}).done(t).fail((function(e){t(null),e.statusText}))}},{key:"format",value:function(e){var t=this;return e.map((function(e){var n=e.boundingbox&&e.boundingbox.map((function(e){return Number(e)}));return t.toGeoJSON({provider:t.title,id:e.place_id,name:e.display_name,srid:"EPSG:4326",coords:[Number(e.lon),Number(e.lat)],bbox:[n[2],n[0],n[3],n[1]]})}))}}])&&ua(t.prototype,n),o&&ua(t,o),a}(Xt);n(238);function ga(e){return(ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ma(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function ba(e,t){return(ba=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function va(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ka(e);if(t){var r=ka(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return wa(this,n)}}function wa(e,t){return!t||"object"!==ga(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ka(e){return(ka=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Aa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ba(e,t)}(a,e);var t,n,o,r=va(a);function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=r.call(this)).title="Features",e.layers=$("map/layer/layers"),e.geojson=new Be.a({featureProjection:$("map/projection"),dataProjection:"EPSG:4326"}),e}return t=a,(n=[{key:"test",value:function(e){return e.length>=3}},{key:"find",value:function(e){var t=this;return new Promise((function(n,o){if(!t.test(e))throw new Error(ce("Query string too short, aborting!"));t.searchFeatures(e,(function(e){n(e)}))}))}},{key:"searchFeatures",value:function(e,t){var n=this,o=this.getAllFeatures().filter((function(t){var n=t.get("name");return n&&n.search(new RegExp(e,"i"))>-1})).map((function(e){return n.format(e)}));"function"==typeof t&&t(o)}},{key:"getAllFeatures",value:function(){var e=[];return this.layers.forEach((function(t){t instanceof De.a&&(e=e.concat(t.getSource().getFeatures()))})),e}},{key:"format",value:function(e){var t=this.geojson.writeFeatureObject(e),n={};return t.properties.id&&(n.id=t.properties.id),t.properties.name&&(n.name=t.properties.name),n.provider=this.title,t.properties=n,t}}])&&ma(t.prototype,n),o&&ma(t,o),a}(Xt);n(399);function Sa(e){return(Sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oa(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function ja(e,t,n){return(ja="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Pa(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function xa(e,t){return(xa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ca(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Pa(e);if(t){var r=Pa(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Ra(this,n)}}function Ra(e,t){return!t||"object"!==Sa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pa(e){return(Pa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ea=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xa(e,t)}(a,e);var t,n,o,r=Ca(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()('\n      <div id="search" class="float-right">\n        <button class="btn btn-secondary d-inline-block d-sm-none toggle" aria-label="'.concat(ce("Search"),'">\n          <i class="fa fa-search"></i>\n        </button>\n        <div class="d-none d-sm-block">\n          <div class="input-group">\n            <input type="text" class="form-control" placeholder="').concat(ce("Search"),'">\n            <div class="input-group-append fill-width">\n              <button class="btn btn-secondary dropdown-toggle no-caret"\n                type="button"\n                data-toggle="dropdown"\n                aria-expanded="true"\n                disabled>\n                <i class="fa fa-search"></i>\n              </button>\n              <ul class="dropdown-menu dropdown-menu-right scrollable-menu" role="menu"></ul>\n            </span>\n          </div>\n        </div>\n      </div>\n    ')),t.state={results:[],open:!1,query:null},t.providers={coordinates:new cn,features:new Aa,nominatim:new ya},t.format=new Be.a({featureProjection:$("map/projection")}),t.create(),t}return t=a,(n=[{key:"create",value:function(){var e=this;ja(Pa(a.prototype),"create",this).call(this),this.target&&this.el&&(this.resultsEl=this.el.find("ul"),this.el.on("click",".toggle",(function(t){e.el.find(">.toggle").toggleClass("d-none d-inline-block"),e.el.find(">div").toggleClass("d-none")})),this.el.find(".dropdown-toggle").on("shown.bs.dropdown",(function(){e.state.open=!0})).on("hidden.bs.dropdown",(function(){e.state.open=!1})).on("click",(function(t){var n=e.el.find("input").val().trim();e.query!==n&&(e.clear(),e.search(n))})),this.el.find("input").on("keyup",(function(t){var n=fe()(t.target).val().trim();e.el.find(".dropdown-toggle").prop("disabled",n.length<1),n.length?13===t.keyCode&&(e.clear(),e.state.open=!0,e.search(n)):e.clear()})),this.resultsEl.on("click",".clear",(function(t){e.clear(),e.el.find("input").val("").trigger("keyup")})),this.resultsEl.on("click","a",(function(t){t.preventDefault(),t.stopPropagation();var n=$("map"),o=fe()(t.currentTarget).attr("data-id"),r=e.state.results.filter((function(e){return String(o)===String(e.id)}))[0];if(r.bbox){var a=Object(He.u)(r.bbox,"EPSG:4326",$("map/projection"));n.getView().fit(a,{padding:[50,50,50,50],maxZoom:17,duration:500})}else n.getView().animate({center:Object(He.h)(r.geometry.coordinates),zoom:15,duration:500})})))}},{key:"render",value:function(){var e=null,t=[];this.state.results.forEach((function(n){e!==n.properties.provider&&(t.push('<li class="dropdown-header">'.concat(ce(n.properties.provider),"</li>")),e=n.properties.provider),t.push('\n        <li>\n          <a href="#" class="dropdown-item"\n            data-id="'.concat(n.id,'" data-provider="').concat(e,'">\n            <i class="fa fa-map-marker-alt"></i>\n            ').concat(n.properties.name,"\n          </a>\n        </li>"))})),t.length||t.push('\n        <li class="dropdown-item">\n          <i class="fa fa-frown"></i>\n          '.concat(ce("No result"),"\n        </li>")),t.push('\n      <div class="tools text-right">\n        <button class="btn btn-link clear">\n          <i class="fa fa-backspace"></i>\n        </button>\n        <button class="btn btn-link toggle d-inline-block d-sm-none" aria-label="'.concat(ce("Close"),'">\n          <i class="fa fa-times"></i>\n        </button>\n      </div>')),this.el.find(".dropdown-toggle").dropdown("update"),this.resultsEl&&(this.resultsEl.html(t.join("")),this.state.open&&(this.el.find(".dropdown-toggle").dropdown("toggle"),this.state.open=!1)),this.handleFeatures()}},{key:"clear",value:function(){var e=this;Object.keys(this.providers).forEach((function(t){e.providers[t].clear()})),this.state.results=[],this.query=null,this.render()}},{key:"search",value:function(e){var t=this,n=$("app/debug");this.query=e;var o=0,r=!1;this.searchStart(),Object.keys(this.providers).some((function(a){o++,t.providers[a].find(e).then((function(i){r||(t.state.results=t.state.results.concat(i)),"coordinates"===a&&i.length&&(r=!0,o=1),n&&console.debug("Search.search: query: ".concat(e,", results: ").concat(i.length))})).catch((function(e){n&&console.error("Search.search: error: ".concat(JSON.stringify(e)))})).finally((function(){0==--o&&(t.render(),t.searchEnd())}))}))}},{key:"searchStart",value:function(){this.el.find(".dropdown-toggle i").removeClass("fa-search").addClass("fa-spinner fa-pulse")}},{key:"searchEnd",value:function(){this.el.find(".dropdown-toggle i").removeClass("fa-spinner fa-pulse").addClass("fa-search")}},{key:"handleFeatures",value:function(){if(this.state.results&&this.state.results.length){var e=this.createLayer(this.query,this.state.results);$("map/layer/overlays").push(e)}}},{key:"createLayer",value:function(e,t){return wt({type:"FeatureCollection",id:S(),title:"".concat(ce("Search"),": ").concat(e),features:t,zIndex:50,style:{stroke:{color:"#000000",width:2},fill:{color:O("#fff",.5)},circle:{stroke:{color:"#000000"},fill:{color:O("#fff",.5)},radius:5}}})}}])&&Oa(t.prototype,n),o&&Oa(t,o),a}(re);n(400);function _a(e){return(_a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ta(e,t){return(Ta=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ma(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Ga(e);if(t){var r=Ga(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return La(this,n)}}function La(e,t){return!t||"object"!==_a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ga(e){return(Ga=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Fa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ta(e,t)}(n,e);var t=Ma(n);function n(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(o=t.call(this,e)).el=fe()('<header id="header" class="panel-bar"></header>'),o.create(),o.components={geocache:new Ho(o.el),lyrmngr:$("app/layerManager")&&new sa(o.el),search:$("app/searchEnabled")&&new Ea(o.el)},o}return n}(re);n(401);function Da(e){return(Da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Na(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ia(e,t){return(Ia=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ua(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Wa(e);if(t){var r=Wa(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return qa(this,n)}}function qa(e,t){return!t||"object"!==Da(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wa(e){return(Wa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Va=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ia(e,t)}(a,e);var t,n,o,r=Ua(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).id="info-tab",t.icon="fa fa-info-circle",t.el=fe()('\n      <div\n        class="tab-pane fade '.concat(t.id===$("app/settingsTabOpen")?"show active":"",'"\n        id="').concat(t.id,'"\n        role="tabpanel">\n      </div>\n    ')),t.create(),t}return t=a,(n=[{key:"render",value:function(){this.el.html('\n      <h5>\n        Geop\n        <i class="text-muted small">'.concat(window.geop.version,'</i>\n      </h5>\n      <span class="attribution small">\n        <a href="http://openstreetmap.org" >OSM</a> |\n        <a href="http://www.maaamet.ee" >maa-amet</a> |\n        <a href="http://sookoll.ee" >oo</a>\n      </span>\n      <ul>\n        <li>').concat(ce("Geop is progressive web application with partial offline support."),"</li>\n        <li>").concat(ce("Install it to Your home screen."),"</li>\n        <li>").concat(ce("Add any GPX, GeoJSON, KML files or WMS layers to map from layers menu or drag and drop file."),"</li>\n        <li>").concat(ce("App will recognize if geocaches are added to map."),"</li>\n        <li>").concat(ce("Filter and search caches on map."),"</li>\n        <li>").concat(ce("Search and display coordinates in WGS, L-Est, UTM and MGRS system."),"</li>\n        <li>").concat(ce("Find streetview link and measure tools from context menu."),"</li>\n        <li>").concat(ce("Add caches and map objects to geotrip. Reorder geotrip."),"</li>\n        <li>").concat(ce("Navigate to cache with two tracking mode"),"</li>\n        <li>").concat(ce("Driving directions between points or from your current location"),"</li>\n        <li>").concat(ce("Share snapshot of app state via link or QR-code. Download geotrip as GPX-file."),"</li>\n      </ul>\n      <h5>").concat(ce("Search coordinates"),"</h5>\n      <ul>\n        <li>WGS'84: lat, lon; kk.nnnn; kk° mm.nnn; kk° mm' ss''</li>\n        <li>L-EST'97: x, y; y, x</li>\n        <li>UTM zone 34N: x, y; y, x</li>\n        <li>UTM zone 35N: x, y; y, x</li>\n        <li>MGRS</li>\n      </ul>\n    "))}}])&&Na(t.prototype,n),o&&Na(t,o),a}(re),za=n(307),Ba=n.n(za);n(402);function Ha(e){return(Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ja(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ya(e,t){return(Ya=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Za(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Ka(e);if(t){var r=Ka(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Xa(this,n)}}function Xa(e,t){return!t||"object"!==Ha(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ka(e){return(Ka=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ya(e,t)}(a,e);var t,n,o,r=Za(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).id="settings-tab",t.icon="fa fa-cog",t.el=fe()('\n      <div\n        class="tab-pane fade '.concat(t.id===$("app/settingsTabOpen")?"show active":"",'"\n        id="').concat(t.id,'"\n        role="tabpanel">\n      </div>\n    ')),t.create(),t}return t=a,(n=[{key:"create",value:function(){this.target&&this.el&&(this.target.append(this.el),this.render())}},{key:"render",value:function(){var e,t=this,n=void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile;this.el.html('\n      <div class="install mb-3">\n        <button\n          id="install"\n          class="btn btn-danger btn-lg btn-block">\n          <i class="fa fa-plus"></i>\n          '.concat(ce("Install app to home screen"),'\n        </button>\n        <small class="form-text text-muted">\n          ').concat(ce("Install web app to your home screen."),"\n        </small>\n      </div>\n      <h5>").concat(ce("Language"),'</h5>\n      <div class="btn-group" role="group">\n        ').concat(Object.keys(ae.texts).map((function(e){return'\n            <button type="button"\n              class="btn btn-outline-primary set-locale-btn '.concat(ae.locale===e?"active":"",'"\n              data-locale="').concat(e,'">\n              ').concat(e,"\n            </button>")})).join(""),'\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(ce("Change language. App will reload after change!"),"\n      </small>\n      <h5>").concat(ce("Account"),'</h5>\n      <div class="form-group">\n        <input type="text"\n          class="form-control"\n          id="settings-account"\n          tabindex="-1"\n          placeholder="').concat(ce("Username"),'"\n          value="').concat($("app/account")||"",'"/>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(ce("Enter geopeitus.ee or geocaching.com username. App will reload after change!"),"\n      </small>\n      <h5>").concat(ce("Search"),'</h5>\n      <div class="form-group">\n        <input type="text"\n          class="form-control"\n          id="settings-search"\n          tabindex="-1"\n          placeholder="').concat(ce("Country codes"),'"\n          value="').concat($("app/nominatimCountries")||"",'"/>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(ce("Limit address search with comma separated list of country codes (ee,fi - Estonia, Finland). Empty means no limit."),"\n      </small>\n      <h5>").concat(ce("Routing"),'</h5>\n      <div class="form-group">\n        <select\n          tabindex="-1"\n          class="form-control"\n          id="settings-routing">\n          <option value="" ').concat(""===n?"selected":"",">").concat(ce("Disabled"),'</option>\n          <option value="driving" ').concat("driving"===n?"selected":"",">").concat(ce("Driving"),'</option>\n          <option value="hiking" ').concat("hiking"===n?"selected":"",">").concat(ce("Hiking"),'</option>\n        </select>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(ce("Select routing profile or disable routing"),'\n      </small>\n      <div class="btn-group" role="group">\n        <button type="button"\n          class="btn btn-outline-primary set-route-btn ').concat($("routing/infoFromRoute")?"active":"",'"\n          data-share="on">\n          ').concat(ce("On"),'\n        </button>\n        <button type="button"\n          class="btn btn-outline-primary set-route-btn ').concat($("routing/infoFromRoute")?"":"active",'"\n          data-share="off">\n          ').concat(ce("Off"),'\n        </button>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(ce("Show distance and duration along route, not from beginning to end"),"\n      </small>\n      \x3c!-- Cache import --\x3e\n      <h5>").concat(ce("Geocache importing"),'</h5>\n      <div class="btn-group" role="group">\n        <button type="button"\n          class="btn btn-outline-primary set-cacheimport-btn ').concat($("cache/import/appendLayer")?"":"active",'"\n          data-import="overwrite">\n          ').concat(ce("Overwrite"),'\n        </button>\n        <button type="button"\n          class="btn btn-outline-primary set-cacheimport-btn ').concat($("cache/import/appendLayer")?"active":"",'"\n          data-import="append">\n          ').concat(ce("Append"),'\n        </button>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(ce("Set a method, how cache import works."),"<br/>\n        ").concat(ce("Overwrite will delete old geocaches when import new caches from file."),"\n        ").concat(ce("Append will add new geocaches without deleting old ones."),"\n      </small>\n      <h5>").concat(ce("Share only geotrip features"),'</h5>\n      <div class="btn-group" role="group">\n        <button type="button"\n          class="btn btn-outline-primary set-share-btn ').concat($("app/shareOnlyTripFeatures")?"active":"",'"\n          data-share="on">\n          ').concat(ce("On"),'\n        </button>\n        <button type="button"\n          class="btn btn-outline-primary set-share-btn ').concat($("app/shareOnlyTripFeatures")?"":"active",'"\n          data-share="off">\n          ').concat(ce("Off"),'\n        </button>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(ce("Share only features added to geotrip."),"<br/>\n        ").concat(ce("NB! Turning this off and sharing bookmark will store possibly big amount of data in service. It might fail. Use with caution!"),"\n      </small>\n      <h5>").concat(ce("Reset app"),'</h5>\n      <div>\n        <button\n          id="settings-reset"\n          class="btn btn-warning">\n          <i class="fa fa-sync-alt"></i>\n          ').concat(ce("Reset"),'\n        </button>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(ce("Reset app to default. App will reload!"),"\n      </small>\n      <h5>").concat(ce("Debug"),'</h5>\n      <div class="btn-group" role="group">\n        <button type="button"\n          class="btn btn-outline-primary set-debug-btn ').concat($("app/debug")?"active":"",'"\n          data-debug="on">\n          ').concat(ce("On"),'\n        </button>\n        <button type="button"\n          class="btn btn-outline-primary set-debug-btn ').concat($("app/debug")?"":"active",'"\n          data-debug="off">\n          ').concat(ce("Off"),'\n        </button>\n      </div>\n      <small class="form-text text-muted mb-3">\n        ').concat(ce("Debug mode. Will write debug logs into file. App will reload after change!"),"\n      </small>\n      ").concat($("app/debug")?'\n      <div class="mb-3">\n        <button\n          id="download-log"\n          class="btn btn-danger">\n          <i class="fa fa-download"></i>\n          '.concat(ce("Download debug log"),'\n        </button>\n        <input type="file" style="display:none;" />\n      </div>\n      '):"","\n    ")),this.el.find("button.set-locale-btn").on("click",(function(e){ie(fe()(e.currentTarget).data("locale"),ae.texts),t.el.find("button.set-locale-btn").removeClass("active"),fe()(e.currentTarget).addClass("active"),le("warning",ce("Language changed, page will reload!"),(function(){ks()})),$("app/debug")&&console.debug("Config.render: Locale changed to ".concat(fe()(e.currentTarget).data("locale")))})),this.el.find("#settings-account").on("blur",(function(e){$("app/settingsTabOpen")&&e.target.value.trim()!==$("app/account")&&(Q("app/account",e.target.value.trim(),!0),le("warning",ce("Account changed, page will reload!"),(function(){ks()})),$("app/debug")&&console.debug("Config.render: Account changed to ".concat(e.target.value.trim())))})),this.el.find("#settings-search").on("blur",(function(e){$("app/settingsTabOpen")&&e.target.value.trim()!==$("app/nominatimCountries")&&(Q("app/nominatimCountries",e.target.value.trim(),!0),$("app/debug")&&console.debug("Config.render: Search limit changed to ".concat(e.target.value)))})),this.el.find("#settings-routing").on("change",(function(e){var t=void 0!==$("routing/profile")?$("routing/profile"):$("app/routing").profile;e.target.value.trim()!==t&&(Q("routing/profile",e.target.value.trim(),!0),$("app/debug")&&console.debug("Config.render: Routing changed to ".concat(e.target.value)))})),this.el.find("button.set-route-btn").on("click",(function(e){Q("routing/infoFromRoute","on"===fe()(e.currentTarget).data("share"),!0),t.el.find("button.set-route-btn").removeClass("active"),fe()(e.currentTarget).addClass("active")})),this.el.find("button.set-cacheimport-btn").on("click",(function(e){Q("cache/import/appendLayer","append"===fe()(e.currentTarget).data("import"),!0),t.el.find("button.set-cacheimport-btn").removeClass("active"),fe()(e.currentTarget).addClass("active")})),this.el.find("button.set-share-btn").on("click",(function(e){Q("app/shareOnlyTripFeatures","on"===fe()(e.currentTarget).data("share"),!0),t.el.find("button.set-share-btn").removeClass("active"),fe()(e.currentTarget).addClass("active")})),this.el.find("#settings-reset").on("click",(function(e){te(),le("warning",ce("App resetted, page will reload!"),(function(){F(null),ks()})),$("app/debug")&&console.debug("Config.render: App resetted")})),this.el.find("button.set-debug-btn").on("click",(function(e){Q("app/debug","on"===fe()(e.currentTarget).data("debug"),!0),t.el.find("button.set-debug-btn").removeClass("active"),fe()(e.currentTarget).addClass("active"),le("warning",ce("Debug changed, app will reload!"),(function(){ks()})),$("app/debug")&&console.debug("Config.render: Debug changed to ".concat(fe()(e.currentTarget).data("debug")))})),this.el.find("#download-log").on("click",(function(e){var t=d,n=new window.Blob([t.join("\n")],{type:"text/plain;charset=utf-8"});Ba()(n,$("app/debugFile"))})),window.addEventListener("beforeinstallprompt",(function(n){n.preventDefault(),e=n,t.el.find(".install").show()})),this.el.find("#install").on("click",(function(n){t.el.find(".install").hide(),e.prompt(),e.userChoice.then((function(t){"accepted"===t.outcome?$("app/debug")&&console.debug("Config.render: User accepted the A2HS prompt"):$("app/debug")&&console.debug("Config.render: User dismissed the A2HS prompt"),e=null}))}))}}])&&Ja(t.prototype,n),o&&Ja(t,o),a}(re);function $a(e){return($a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ei(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function ti(e,t){return(ti=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ni(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ri(e);if(t){var r=ri(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return oi(this,n)}}function oi(e,t){return!t||"object"!==$a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ri(e){return(ri=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ai=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ti(e,t)}(a,e);var t,n,o,r=ni(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()('<button type="button"\n      class="btn btn-secondary">\n      <i class="fa fa-ellipsis-h"></i>\n    </button>'),t.create(),t.sidebar=new Ut({target:fe()("#geop"),trigger:t.el,position:"left",components:{Info:Va,Config:Qa},activeComponent:$("app/settingsTabOpen"),shadow:!0}),t}return t=a,(n=[{key:"create",value:function(){this.target&&this.el&&(this.target.append(this.el),fe()("body").append(this.sidebar).append(this.shadow))}}])&&ei(t.prototype,n),o&&ei(t,o),a}(re),ii=n(189);n(403);function ci(e){return(ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function si(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function li(e,t){return(li=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ui(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=pi(e);if(t){var r=pi(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return fi(this,n)}}function fi(e,t){return!t||"object"!==ci(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pi(e){return(pi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var di=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&li(e,t)}(a,e);var t,n,o,r=ui(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=e,t.state={control:null},t.create(),t}return t=a,(n=[{key:"render",value:function(){var e=this;if(!this.state.control){this.state.control=new ii.a({className:"ol-scale-line",target:this.el[0]});var t=$("map");t?t.addControl(this.state.control):$("map/que").push((function(t){t.addControl(e.state.control)}))}}}])&&si(t.prototype,n),o&&si(t,o),a}(re);function hi(e){return(hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yi(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function gi(e,t){return(gi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=vi(e);if(t){var r=vi(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return bi(this,n)}}function bi(e,t){return!t||"object"!==hi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vi(e){return(vi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gi(e,t)}(a,e);var t,n,o,r=mi(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()('<button type="button"\n      title="'.concat(ce("Toggle fullscreen"),'"\n      disabled\n      class="btn btn-secondary">\n      <i class="fa fa-expand-arrows-alt"></i>\n    </button>')),t.state={active:!1},t.create(),t}return t=a,(n=[{key:"render",value:function(){var e=this;this.test()&&(this.el.prop("disabled",!1),this.el.on("click",(function(t){t.preventDefault(),e.toggle()})),fe()(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",(function(t){e.toggleState()})))}},{key:"test",value:function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled)}},{key:"toggle",value:function(){this.state.active?this.off():this.on()}},{key:"toggleState",value:function(){document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?(this.state.active=!0,this.el.addClass("active")):(this.state.active=!1,this.el.removeClass("active"))}},{key:"on",value:function(){document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(window.Element.ALLOW_KEYBOARD_INPUT)}},{key:"off",value:function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}}])&&yi(t.prototype,n),o&&yi(t,o),a}(re);function ki(e){return(ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ai(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Si(e,t){return(Si=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=xi(e);if(t){var r=xi(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return ji(this,n)}}function ji(e,t){return!t||"object"!==ki(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xi(e){return(xi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ci=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Si(e,t)}(a,e);var t,n,o,r=Oi(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()('<button type="button"\n      title="'.concat(ce("Keep awake"),'"\n      disabled\n      class="btn btn-secondary">\n      <i class="fa fa-desktop"></i>\n    </button>')),t.state={active:!1},t.create(),t}return t=a,(n=[{key:"render",value:function(){var e=this;this.test()&&(this.el.prop("disabled",!1),this.el.on("click",(function(t){t.preventDefault(),e.toggle()})))}},{key:"test",value:function(){return!0}},{key:"toggle",value:function(){this.state.active?this.off():this.on()}},{key:"on",value:function(){this.state.active=!0,this.el.addClass("active"),document.addEventListener("click",g,!1)}},{key:"off",value:function(){this.state.active=!1,this.el.removeClass("active"),p.disable()}}])&&Ai(t.prototype,n),o&&Ai(t,o),a}(re);n(404);function Ri(e){return(Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pi(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ei(e,t){return(Ei=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Mi(e);if(t){var r=Mi(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Ti(this,n)}}function Ti(e,t){return!t||"object"!==Ri(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mi(e){return(Mi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Li=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ei(e,t)}(a,e);var t,n,o,r=_i(a);function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=r.call(this,e,t)).id="routinginfo",n.el=fe()('<span class="text-center d-none">\n      <i class="fas fa-location-arrow"></i>\n      <span></span>\n      <button class="btn btn-link">\n        <i class="fas fa-times"></i>\n      </button>\n    </span>'),n.state={active:!1,prev:null},n.toggleFn=t.toggle,n.create(),ee("routing/info",(function(e){!n.state.active&&e&&n.activate(),e?n.el.find("span").html(e):n.deactivate()})),n}return t=a,(n=[{key:"render",value:function(){this.el.on("click","button",(function(e){uo(),Q("routing/stops",[]),Q("routing/info",null),Q("navigate/to",null)}))}},{key:"activate",value:function(e){this.state.prev=this.toggleFn(this.id),this.el.removeClass("d-none"),this.state.active=!0}},{key:"deactivate",value:function(){this.toggleFn(this.state.prev),this.el.addClass("d-none"),this.el.find("span").html(""),this.state.active=!1}}])&&Pi(t.prototype,n),o&&Pi(t,o),a}(re),Gi=n(155),Fi=n(66),Di=n(297),Ni=n(187),Ii=n(298),Ui=n(36);n(405);function qi(e){return(qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wi(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Vi(e,t){return(Vi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Hi(e);if(t){var r=Hi(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Bi(this,n)}}function Bi(e,t){return!t||"object"!==qi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hi(e){return(Hi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ji=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vi(e,t)}(a,e);var t,n,o,r=zi(a);function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=r.call(this,e)).id="measure",n.el=fe()('<span class="text-center d-none">\n      <i class="fa fa-ruler-combined"></i>\n      <span></span>\n      <button class="btn btn-link">\n        <i class="fas fa-times"></i>\n      </button>\n    </span>'),n.state={map:null,measureType:null,snapTolerance:10,snapFeatures:null,layer:null,source:null,drawing:new wo.a({geometry:new vo.a([])}),circle:new wo.a,sketch:new wo.a({geometry:new vo.a([])}),measureLine:new vo.a([]),prev:null},n.toggleFn=t.toggle,n.create(),n.interaction={snap:null,modify:new Di.a({features:new go.a([n.state.drawing]),insertVertexCondition:function(e){return"circle"===n.state.measureType?Object(Ui.i)(e):Object(Ui.d)(e)},deleteCondition:function(e){return Object(Ui.e)(e)},style:rt({circle:{radius:6,stroke:{color:"black",width:1},fill:{color:"white"}}})})},n.handlers={onmodify:function(e){n.onmodify(e)},clicked:function(e){n.clicked(e)},mousemoved:function(e){n.mousemoved(e)}},$("map/contextmenu").push({content:'<i class="fa fa-ruler-combined"></i> '.concat(ce("Measure"),'\n        <a href="#" class="btn btn-link context-item-btn"><i class="far fa-dot-circle"></i></a>'),onClick:function(e,t){n.init(t)},onBtnClick:function(e,t){e.preventDefault(),n.init(t,"circle")},closeOnClick:!0}),n}return t=a,(n=[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"distance";this.state.map||(this.state.map=$("map")),this.state.layer||(this.state.layer=this.createLayer(),this.state.source=this.state.layer.getSource(),this.state.layer.setMap(this.state.map)),this.reset(),this.state.measureType=t,this.render(),this.state.snapFeatures=new go.a(this.getAllFeatures()),this.state.drawing.getGeometry().setCoordinates([e]),this.state.snapFeatures.push(this.state.drawing),"circle"===t?(this.state.circle.setGeometry(new Po.a(e)),this.state.source.addFeatures([this.state.circle,this.state.drawing,this.state.sketch]),le("info",ce("Measure angle and distance"))):(this.state.source.addFeatures([this.state.drawing,this.state.sketch]),le("info",ce("Measure distance and area. Click to last point finish measurement. Click to first point calculates area."))),$("components/featureInfo")&&$("components/featureInfo").disable(),this.enableClick(),this.state.map.getInteractions().getArray().forEach((function(e){e instanceof Ni.a&&e.setActive(!1)})),this.state.prev=this.toggleFn(this.id),this.el.removeClass("d-none")}},{key:"createLayer",value:function(){return wt({type:"FeatureCollection",id:S(),title:"Measure",style:[{stroke:{color:"black",width:1},fill:{color:"rgba(255, 255, 255, 0)"}},{circle:{radius:5,stroke:{color:"black",width:1},fill:{color:"white"}},geometry:function(e){if(e.getGeometry()instanceof vo.a){var t=e.getGeometry().getCoordinates();return new Gi.a(t)}}}]})}},{key:"render",value:function(){var e=this;this.el.on("click","button",(function(t){e.reset()}));var t=this.el.find("span");t.html(this.renderResults()),"circle"===this.state.measureType&&(t.on("focus","input",(function(t){e.interaction.modify.setActive(!1)})),t.on("blur","input",(function(n){var o=t.find("input[name=angle]").val(),r=t.find("input[name=radius]").val(),a=e.state.drawing.getGeometry().getCoordinates(),i=e.getCoordinateByAngleDistance(a[0],Number(o),Number(r));e.state.drawing.getGeometry().setCoordinates([a[0],i]),e.interaction.modify.setActive(!0)})))}},{key:"renderResults",value:function(){var e="";return"circle"===this.state.measureType?e+='\n        <label for="angle" class="d-none d-sm-inline-block">'.concat(ce("Angle"),': </label>\n        <input type="text" name="angle" class="input-sm" disabled> <b class="angle-unit">&deg</b>\n        <label for="radius" class="d-none d-sm-inline-block">').concat(ce("Radius"),': </label>\n        <input type="text" name="radius" class="input-sm" disabled> <b class="radius-unit">m</b>'):e+='\n        <label for="length" class="d-none d-sm-inline-block">'.concat(ce("Length"),': </label>\n        <input type="text" name="length" class="input-sm" disabled> <b class="length-unit">m</b>\n        <label for="area" class="d-none d-sm-inline-block">').concat(ce("Area"),': </label>\n        <input type="text" name="area" class="input-sm" disabled> <b class="area-unit">m<sup>2</sup></b>'),e}},{key:"updateResults",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if("circle"===this.state.measureType)this.updateCircleResults();else{var t,n=j(e||this.state.drawing.getGeometry(),null,[2,2],!0),o=this.state.drawing.getGeometry().getCoordinates();o[0][0]===o[o.length-1][0]&&o[0][1]===o[o.length-1][1]&&(t=x(new Fi.b([o]),null,[2,2],!0));var r=this.el.find("span");r.find("input[name=length]").val(n[0]),r.find("b.length-unit").html(n[1]),t&&(r.find("input[name=area]").val(t[0]),r.find("b.area-unit").html(t[1]))}}},{key:"updateCircleResults",value:function(){var e=this.state.sketch.getGeometry(),t=e.getCoordinates();0===t.length&&(t=(e=this.state.drawing.getGeometry()).getCoordinates());var n=t[0],o=t[t.length-1],r=m(Math.atan2(o[0]-n[0],o[1]-n[1]));r<0&&(r=360+r);var a=Object(c.c)(e),i=this.el.find("span");i.find("input[name=angle]").val(Math.round(100*(r+1e-5))/100),i.find("input[name=radius]").val(Math.round(100*(a+1e-5))/100)}},{key:"reset",value:function(){this.toggleFn(this.state.prev),this.el.addClass("d-none"),this.el.find("span").html(""),this.state.drawing.getGeometry().un("change",this.handlers.onmodify),this.state.map.removeInteraction(this.interaction.modify),this.state.map.removeInteraction(this.interaction.snap),this.state.snapFeatures=null,this.disableClick(),$("components/featureInfo")&&$("components/featureInfo").enable(),this.state.drawing.getGeometry().setCoordinates([]),this.state.sketch.getGeometry().setCoordinates([]),"circle"===this.state.measureType&&this.state.circle.setGeometry(null),this.state.source.clear(),this.state.map.getInteractions().getArray().forEach((function(e){e instanceof Ni.a&&e.setActive(!0)})),fe()(document).off("keydown")}},{key:"enableClick",value:function(){this.state.map.on("click",this.handlers.clicked),this.state.map.on("pointermove",this.handlers.mousemoved)}},{key:"disableClick",value:function(){this.state.map.un("click",this.handlers.clicked),this.state.map.un("pointermove",this.handlers.mousemoved)}},{key:"clicked",value:function(e){this.state.sketch.getGeometry().setCoordinates([]);var t=this.state.drawing.getGeometry().getCoordinates(),n=this.getSnappedCoordinate(e.coordinate,this.state.snapFeatures.getArray(),this.state.snapTolerance);if("circle"===this.state.measureType){var o=t[0];this.state.drawing.getGeometry().setCoordinates([o,n]),this.el.find("input[name=angle],input[name=radius]").prop("disabled",!1),this.finish()}else t.length>1&&t[0][0]===n[0]&&t[0][1]===n[1]?(t.push(n),this.state.drawing.getGeometry().setCoordinates(t),this.finish()):t.length>1&&t[t.length-1][0]===n[0]&&t[t.length-1][1]===n[1]?this.finish():(t.push(n),this.state.drawing.getGeometry().setCoordinates(t))}},{key:"onmodify",value:function(e){if("circle"===this.state.measureType){var t=this.state.drawing.getGeometry().getCoordinates(),n=this.state.circle.getGeometry(),o=this.getCoordinatesDistance(t[0],t[1]);n.setCenter(t[0]),n.setRadius(o)}this.updateResults()}},{key:"mousemoved",value:function(e){var t=this.state.drawing.getGeometry().getCoordinates(),n="circle"===this.state.measureType?t[0]:t[t.length-1],o=this.getSnappedCoordinate(e.coordinate,this.state.snapFeatures.getArray(),this.state.snapTolerance);if(this.state.sketch.getGeometry().setCoordinates([n,o]),"circle"===this.state.measureType){var r=this.getCoordinatesDistance(n,o);this.state.circle.getGeometry().setRadius(r),this.updateResults()}else{var a=t.slice(0);a.push(o),this.state.measureLine.setCoordinates(a),this.updateResults(this.state.measureLine)}}},{key:"finish",value:function(){this.disableClick(),this.state.sketch.getGeometry().setCoordinates([]),this.updateResults(),this.state.map.addInteraction(this.interaction.modify),this.interaction.snap=new Ii.a({features:this.state.snapFeatures}),this.state.map.addInteraction(this.interaction.snap),this.state.drawing.getGeometry().on("change",this.handlers.onmodify)}},{key:"getSnappedCoordinate",value:function(e,t,n){for(var o=this,r=e,a=function(e,t){var n=o.state.map.getPixelFromCoordinate(e),r=o.state.map.getPixelFromCoordinate(t);return o.getCoordinatesDistance(n,r)},i=0,c=t.length;i<c;i++){var s=t[i].getGeometry().getCoordinates();if(s&&"number"==typeof s[0]){if(a(s,e)<=n){r=s;break}}else{var l=s.filter((function(t){if(a(t,e)<=n)return!0}));l.length>0&&(r=l[0])}}return r}},{key:"getCoordinateByAngleDistance",value:function(e,t,n){var o=6378137,r=Object(He.q)(e),a=b(t),i=b(r[1]),c=b(r[0]);return i=Math.asin(Math.sin(i)*Math.cos(n/o)+Math.cos(i)*Math.sin(n/o)*Math.cos(a)),c+=Math.atan2(Math.sin(a)*Math.sin(n/o)*Math.cos(i),Math.cos(n/o)-Math.sin(i)*Math.sin(i)),Object(He.h)([m(c),m(i)])}},{key:"getCoordinatesDistance",value:function(e,t){var n=Math.abs(e[0]-t[0]),o=Math.abs(e[1]-t[1]);return Math.sqrt(n*n+o*o)}},{key:"getAllFeatures",value:function(){var e=[];return $("map/layer/layers").forEach((function(t){"FeatureCollection"===t.get("conf").type&&(e=e.concat(t.getSource().getFeatures()))})),$("map/layer/overlays").forEach((function(t){"FeatureCollection"===t.get("conf").type&&"Measure"!==t.get("title")&&(e=e.concat(t.getSource().getFeatures()))})),e}}])&&Wi(t.prototype,n),o&&Wi(t,o),a}(re);n(406);function Yi(e){return(Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zi(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Xi(e,t){return(Xi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ki(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=$i(e);if(t){var r=$i(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Qi(this,n)}}function Qi(e,t){return!t||"object"!==Yi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $i(e){return($i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ec=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xi(e,t)}(a,e);var t,n,o,r=Ki(a);function a(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).state={visibleMobile:"scaleline"},t.toggleComponents={},t.el=fe()('<footer id="statusbar" class="panel-bar">\n      <div id="settingsbar" class="slot btn-group float-left"></div>\n      <div id="mouseposition" class="slot slot-xs-block float-left d-none d-lg-block"></div>\n      <div id="routinginfo" class="slot slot-xs-block float-left d-none d-lg-block"></div>\n      <div id="measure" class="slot slot-xs-block float-left d-none d-lg-block"></div>\n      <div id="screen" class="slot btn-group float-right">\n        <div class="btn-group dropup d-block d-lg-none">\n          <button type="button"\n            class="btn btn-secondary dropdown-toggle dropdown-toggle-split"\n            data-toggle="dropdown">\n          </button>\n          <div class="dropdown-menu dropdown-menu-right"></div>\n        </div>\n      </div>\n      <div id="bookmark" class="slot float-right d-none d-lg-block"></div>\n      <div id="scaleline" class="slot float-right d-none d-lg-block"></div>\n    </footer>'),t.create();var n={toggle:function(e){return t.toggleMobileVisible(e)}};return t.toggleComponents={scaleline:$("app/scaleLine")&&new di(t.el.find("#scaleline"),n),bookmark:$("app/shareState")&&new Ee(t.el.find("#bookmark"),n),mouseposition:$("app/mousePosition")&&new jn(t.el.find("#mouseposition"),n),routinginfo:$("app/routing")&&new Li(t.el.find("#routinginfo"),n),measure:$("app/measureTool")&&new Ji(t.el.find("#measure"),n)},t.components=Object.assign({},t.toggleComponents,{settings:$("app/settings")&&new ai(t.el.find("#settingsbar")),screenlock:$("app/screenLock")&&new Ci(t.el.find("#screen")),fullscreen:$("app/fullScreen")&&new wi(t.el.find("#screen"))}),t.render(),t}return t=a,(n=[{key:"render",value:function(){var e=this;this.el.find("#screen .dropdown-menu").html("\n      ".concat(Object.keys(this.toggleComponents).map((function(t){return'<a class="dropdown-item" href="#" data-visible="'.concat(t,'">\n          <i class="far ').concat(t===e.state.visibleMobile?"fa-dot-circle":"fa-circle",'"></i>\n          ').concat(ce(t),"\n        </a>")})).join(""),"\n      </div>\n    </div>")),this.toggleMobileVisible(this.state.visibleMobile),this.el.find("#screen a[data-visible]").on("click",(function(t){e.toggleMobileVisible(fe()(t.currentTarget).data("visible"))}))}},{key:"toggleMobileVisible",value:function(e){var t=this,n=this.state.visibleMobile;return this.state.visibleMobile=e,Object.keys(this.toggleComponents).forEach((function(e){t.el.find("#".concat(e)).addClass("d-none d-lg-block")})),this.el.find("#".concat(e)).removeClass("d-none d-lg-block"),this.el.find("#screen a[data-visible] i").removeClass("fa-dot-circle").addClass("fa-circle"),this.el.find("#screen a[data-visible=".concat(e," ]")).find("i").removeClass("fa-circle").addClass("fa-dot-circle"),n}}])&&Zi(t.prototype,n),o&&Zi(t,o),a}(re);function tc(e){return(tc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nc(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function oc(e,t){return(oc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ic(e);if(t){var r=ic(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return ac(this,n)}}function ac(e,t){return!t||"object"!==tc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ic(e){return(ic=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oc(e,t)}(a,e);var t,n,o,r=rc(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).elPlus=fe()('\n      <button class="btn btn-link" title="'.concat(ce("Zoom in"),'"><i class="fa fa-plus"></i></button>\n    ')),t.elMinus=fe()('\n      <button class="btn btn-link" title="'.concat(ce("Zoom out"),'"><i class="fa fa-minus"></i></button>\n    ')),t.create(),t}return t=a,(n=[{key:"create",value:function(){var e=this;this.target&&this.elPlus&&(this.target.append(this.elPlus),this.elPlus.on("click",(function(t){var n=$("map").getView(),o=n.getZoom()+1;e.zoomTo(n,o)}))),this.target&&this.elMinus&&(this.target.append(this.elMinus),this.elMinus.on("click",(function(t){var n=$("map").getView(),o=n.getZoom()-1;e.zoomTo(n,o)})))}},{key:"zoomTo",value:function(e,t){e.animate({zoom:t,duration:250,anchor:$("map/anchor")&&$("map/anchor").getCoordinates()})}}])&&nc(t.prototype,n),o&&nc(t,o),a}(re);n(407);function sc(e){return(sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lc(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function uc(e,t){return(uc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=dc(e);if(t){var r=dc(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return pc(this,n)}}function pc(e,t){return!t||"object"!==sc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dc(e){return(dc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uc(e,t)}(a,e);var t,n,o,r=fc(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()('\n      <button id="compass" class="btn btn-link" title="'.concat(ce("North up!"),'">\n        <i class="icon"></i>\n      </button>\n    ')),t.state={removed:!0},$("map/que").push((function(e){var n=e.getView();t.rotateIcon(n),n.on("change:rotation",(function(e){t.rotateIcon(n)}))})),t}return t=a,(n=[{key:"render",value:function(){this.el.on("click",(function(e){$("map").getView().animate({rotation:0,duration:250,anchor:$("map/anchor")&&$("map/anchor").getCoordinates()})}))}},{key:"rotateIcon",value:function(e){var t=this,n=e.getRotation();0!==n&&this.state.removed?(this.create(),this.state.removed=!1):0===n&&this.el.fadeOut(400,(function(){t.el.remove(),t.el.show(),t.state.removed=!0})),this.el.find(".icon").css({"-webkit-transform":"rotate(".concat(n,"rad)"),"-moz-transform":"rotate(".concat(n,"rad)"),transform:"rotate(".concat(n,"rad)")})}}])&&lc(t.prototype,n),o&&lc(t,o),a}(re),yc=n(308);n(408);function gc(e){return(gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mc(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function bc(e,t){return(bc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=kc(e);if(t){var r=kc(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return wc(this,n)}}function wc(e,t){return!t||"object"!==gc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kc(e){return(kc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ac=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bc(e,t)}(a,e);var t,n,o,r=vc(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()('\n      <button id="geolocation" class="btn btn-link" disabled title="'.concat(ce("My location"),'">\n        <i class="fa fa-location-arrow"></i>\n      </button>\n    ')),t.state={active:0,status:["","active","tracking"],track:new wo.a(new vo.a([])),position:new wo.a({id:"position",radius:0,geometry:new bo.a([])}),zoom:16,layer:t.createLayer(),locator:new yc.a({projection:$("map/projection"),trackingOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:3e4}}),isFirst:!1,lastPosition:null,lastHeading:null,minAccuracy:100,pressStart:null,pressTimer:null},t.handlers={updateView:function(e){t.updateView(e)},disableTracking:function(e){t.disableTracking()}},t.test()&&(window.geopLocator=t.state.locator,t.create(),t.init()),t}return t=a,(n=[{key:"render",value:function(){var e=this;this.el.prop("disabled",!1),this.el.on("click contextmenu",(function(e){e.preventDefault()})),this.el.on("mousedown touchstart",(function(t){t.preventDefault(),e.state.pressStart=(new Date).getTime(),e.state.pressTimer=setTimeout((function(){e.disable(),fe()(t.currentTarget).removeClass(e.state.status.join(" "))}),800)})).on("mouseleave",(function(t){t.preventDefault(),e.state.pressStart=0,clearTimeout(e.state.pressTimer)})).on("mouseup touchend",(function(t){t.preventDefault(),(new Date).getTime()<e.state.pressStart+800&&(clearTimeout(e.state.pressTimer),e.state.active=e.state.active+1>=e.state.status.length?0:e.state.active+1,0===e.state.active?(e.disable(),fe()(t.currentTarget).removeClass(e.state.status.join(" "))):(e.enable(),fe()(t.currentTarget).addClass(e.state.status[e.state.active])))}))}},{key:"test",value:function(){return!!navigator.geolocation}},{key:"init",value:function(){var e=this;this.state.layer.getSource().addFeatures([this.state.track,this.state.position]),this.state.locator.on("change:position",(function(t){e.positionChanged(t)})),this.state.locator.on("change:heading",(function(t){e.headingChanged(t)})),this.state.locator.on("change:accuracy",(function(t){e.accuracyChanged(t)})),this.state.locator.on("change:speed",(function(t){e.speedChanged(t)})),this.state.locator.on("error",(function(t){e.error(t)}))}},{key:"error",value:function(e){this.disable(),this.el.removeClass(this.state.status.join(" "));var t=ce("Unable to find location.");switch(e.code){case e.PERMISSION_DENIED:t=ce("User denied the request for Geolocation.");break;case e.POSITION_UNAVAILABLE:t=ce("Location information is unavailable.");break;case e.TIMEOUT:t=ce("The request to get user location timed out.");break;case e.UNKNOWN_ERROR:t=ce("An unknown error occurred.")}le("error",t),$("app/debug")&&console.error("geolocation error",JSON.stringify(e))}},{key:"enable",value:function(){var e=$("map");"tracking"===this.state.status[this.state.active]?(Q("map/anchor",this.state.position.getGeometry()),this.updateView(),e.on("pointerdrag",this.handlers.disableTracking),e.render()):(this.state.isFirst=!0,this.searchStart(),this.state.layer.setMap(e),this.state.locator.setTracking(!0)),Q("map/geolocation",!0)}},{key:"disable",value:function(){this.disableTracking(),this.searchEnd(),this.state.locator.setTracking(!1),this.state.position.getGeometry().setCoordinates([]),this.state.track.getGeometry().setCoordinates([]),this.state.layer.setMap(null),this.state.lastPosition=null,this.state.lastHeading=null,this.state.active=this.state.status.indexOf(""),Q("map/geolocation",!1)}},{key:"disableTracking",value:function(){$("map").un("pointerdrag",this.handlers.disableTracking),Q("map/anchor",null),this.el.removeClass(this.state.status[this.state.active]),this.state.active=this.state.status.indexOf("active")}},{key:"searchStart",value:function(){this.el.find("i").removeClass("fa-location-arrow").addClass("fa-spinner fa-pulse")}},{key:"searchEnd",value:function(){this.el.find("i").removeClass("fa-spinner fa-pulse").addClass("fa-location-arrow")}},{key:"isValid",value:function(e){return e<=this.state.minAccuracy}},{key:"positionChanged",value:function(e){var t=this.state.locator.getPosition();if(t){if(this.state.lastPosition=t,this.state.position.getGeometry().setCoordinates(t),this.isValid(this.state.locator.getAccuracy())&&(this.state.track.getGeometry().appendCoordinate(t),!0===this.state.isFirst)){var n=$("map").getView();n.setCenter(t),n.setZoom(this.state.zoom),this.state.isFirst=!1,this.searchEnd()}Q("map/geolocation/position",t)}this.updateView()}},{key:"headingChanged",value:function(e){var t=this.state.locator.getHeading();void 0!==t&&(this.state.lastHeading=t,this.state.position.set("heading",t)),this.updateView()}},{key:"accuracyChanged",value:function(e){var t=this.state.locator.getAccuracy();void 0!==t&&this.state.position.set("radius",t),this.updateView()}},{key:"speedChanged",value:function(e){var t=this.state.locator.getSpeed()||0;this.state.position.set("speed",t),this.updateView()}},{key:"getCenterWithHeading",value:function(e,t,n){var o=$("map").getSize();return[e[0]-Math.sin(t)*o[1]*n*1/4,e[1]+Math.cos(t)*o[1]*n*1/4]}},{key:"updateView",value:function(){if($("app/debug")&&console.debug("updateView: ".concat(JSON.stringify(this.state.lastPosition),"; heading: ").concat(this.state.lastHeading,"; accuracy: ").concat(this.state.locator.getAccuracy())),"tracking"===this.state.status[this.state.active]&&this.isValid(this.state.locator.getAccuracy())){var e=$("map").getView();this.state.lastPosition&&this.state.lastHeading?(e.setCenter(this.getCenterWithHeading(this.state.lastPosition,-this.state.lastHeading,e.getResolution())),e.setRotation(-this.state.lastHeading)):this.state.lastPosition?e.setCenter(this.getCenterWithHeading(this.state.lastPosition,e.getRotation(),e.getResolution())):e.setRotation(-this.state.lastHeading)}}},{key:"createLayer",value:function(){var e=rt({icon:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAyCAMAAABvV9spAAAABGdBTUEAALGPC/xhBQAAACBjSFJN AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABUFBMVEUAAABpaWkAAAAAAAAA AAAAAAAAAABpaWkAAAAAAAAAAAAAAAAAAAA1NTUAAAAAAAAAAAAAAAAAAAAPDw+4uLje3t709PQP Dw8AAAAAAAAAAAAAAAAAAAAAAAB8fHzv7+98fHwAAAAAAAAAAADAwMD+/v4AAAAAAAAAAACJiYkA AAAmJiby8vLLy8vl5eUAAAD29vZWVlYAAAA5OTn+/v4AAADz8/MAAAAAAADh4eEAAAAAAAC7u7sA AADo6OgAAABbW1v6+voAAAAAAACdnZ339/c9PT3d3d0AAAAAAAAAAACRkZHHx8fh4eH09PQAAAAA AAAAAAAAAAD////6/f7g8Plqt+A0ndUHh8uZzuoNis0AhMqSyujb7vgKicxhs94pmNPy+fwChcr5 /P42ntV0vOLv9/sbkdC43fAEhsvN5/UsmdP5/P2i0uxsuOA5n9bwio4hAAAAU3RSTlMAIx0gEhQT JgIGMzpBTS0mAxYqQpTE6D8pGwQOGC5h3F0kDw2K+yUKI10fNeCTwxnrQRo6/iziFSe6ESF/K8gI RvIFC2XqO7MBBx5dk7ziEBcoCTVzjyoAAAABYktHRFN6Zx0GAAAACXBIWXMAAAFiAAABYgFfJ9BT AAAAB3RJTUUH4gwECRg4eAJxNwAAAYNJREFUOMvt0ls3AlEUwPFNEzO6mIkyU7nUSIN0pUE0zKCL W7VDhO6Rku//5iQ0H8BalrX8H85Z+/dwHvY6AP/9TGPjBsponJgcTjTQzOCeMpnNFovZZJ0eTAwN LGHONjNrdyA67LNzvECYBSe43PMLi4hYLJJjccnjBYIguvhlH15d35RKN9dX6FteMZJ3/EZp1Ye3 d+WP7m7Rt7pG+cElrAfwvvzdPQbWBRdQ0gY+PI748QE3JAo4PoiVsq4KBnkOQtYwVvVcxbA1BEIE a3U912sYESAa22yU9FxqbMai4N6KY1PPTYxvuUHe3sGWnlu4sy3DbmIP208jfWrjXmIXxNB+Ep87 X9p5xuR+SASFMhwc4kt3qN0XPDwwUAqomiwdHWPvtf/21n/t4fGRJGsq2bfISScp/Cx1InEi2Xea zYhylj89O7+4OD875bOymGHTQJzRLnNZT95my3uyuUuNGejAVUXzUjLHyZRXU9ShEqdZJ6MU/P6C wjhZOv3bv/Bv9Q7DpHOEPfXX5AAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOC0xMi0wNFQxNjoyNDo1 Ni0wNzowMAoLzxUAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTgtMTItMDRUMTY6MjQ6NTYtMDc6MDB7 VnepAAAAAElFTkSuQmCC"}}),t=rt({icon:{rotation:0,rotateWithView:!0,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAyCAMAAABvV9spAAAABGdBTUEAALGPC/xhBQAAACBjSFJN AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABxVBMVEUAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADn5+fn5+cAAAAAAACioqIAAAAAAAAAAAAAAADt7u7m 8vkAAAAAAAAAAACxsbEAAAAcHBzz9PXT6vUAAAAAAADFxcUAAAAAAAAAAABGRkb4+fq63vEAAAAA AADX19f+//90dHT8/f3J5PMAAAAAAADo6Ojs7e2qqqr8/f3JyclRUVEAAADw8PLq6+tpaWkAAAAA AAAAAADx8fLMzMy9vb0AAAAAAAAAAAA1NTW6urrLy8sAAAAAAAAAAAAAAAAPDw+4uLje3t709PQA AAAAAAB8fHzv7+8AAADAwMD+/v4AAACJiYkAAAAmJiby8vLLy8sAAADl5eX29vZWVlYAAAA5OTn+ /v7z8/Ph4eG7u7sAAADo6OhbW1v6+vqdnZ339/c9PT3d3d2RkZHHx8fh4eH09PQAAAAAAAD///9h s94ChcpGptkAhMovm9Sf0essmdN8wOTA4PL6/f7g8Plqt+A0ndUHh8uZzuoNis2Syujb7vgKicwp mNPy+fz5/P42ntV0vOLv9/sbkdC43fAEhsvN5/X5/P2i0uxsuOA5n9YUwW0GAAAAdXRSTlMAAQID BAYICgsRFAwdop8TIF0HDxws1v0FFyd8Hzfp/RgplQkSIUL1/g0qqv5N/P4VJLzgV/ulW0XBzlxA Pj3EdHg5P0FNd3AOGSYzQpTE6B4uYdwtivsjXRs14JMWw+tBGjr+4rp/K8hG8mXqO7Ndk7ziEChI 22u6AAAAAWJLR0R1qGqY+wAAAAlwSFlzAAABYgAAAWIBXyfQUwAAAAd0SU1FB+IMBAUxJCFfS/cA AAJeSURBVDjL7ZPXUxpRFIfv7rIFMBFFdBc1srKoi22xx5ZEMQErsbCiYu+9HRDF2Huvf292QYTk Le/5Hu6d+ebMuWfO/C5CETAMJzQaAscwlAhGkBRNUySB/WUZrU6nZf7wGE7qdUkfPibp9CQe95iG TjakAKQYkmkNFm+RakwzpWdkpJvSjKnvbXCW4cyZEAhAppljWDxWTGmzsj/lBIM5n7KztNRbOc7q LXwubIVCW5DLW/TRcoywCra8/IKQQkF+nk2wquUYzooWe2HRtqq3iwrtFpFVhox0Li7ZCe+Wlu6G d0qKo92VmSVHGfwCKC8H5SpzSOrsyoNcBUBlVXVNTXVVJUAFpz6q6s9QW1ff0NjYUF9XC1+imhS5 r9+amp3Olhans7np+w9OWQwiSJe7ta29o7MLoKuzo72t1eIiCaSxCp6f3T0AsLenHD3dvR7BqkGk 6Ob7vLB/cHh0dHiwD94+3i2SiNbJ/V44PglFODkGb7+so5HLNzAIp6F3TmFwwOdCgjwEZ+dxfX4G Q7KA/PwwBEIJBGCY9yN37whcJOoLGOl1I98oXAYTdfASRn1obHzi6ihRH11NjI8hi2kSrhP1NUya LEgyT8FNor6BKbOEtLZpuL2L27tbmLZpkeiemYX7h5h9uIfZGbeIKMEwNw+P4agNP8L8nEGgEMtI 8sIiPD2/vL6+PD/B4oIsMayyb9EvLy3DG8tLsl9U9q0EUJQ8/Mrq2vr62uoK75HESAzVbG9wHsem 3b7p8HAbsYxjBEsxRkHy+yXByFBsLLLqvyEpK01bKVL9P+g//8Bv4afHimhpWRsAAAAldEVYdGRh dGU6Y3JlYXRlADIwMTgtMTItMDRUMTI6NDk6MzYtMDc6MDARlu33AAAAJXRFWHRkYXRlOm1vZGlm eQAyMDE4LTEyLTA0VDEyOjQ5OjM2LTA3OjAwYMtVSwAAAABJRU5ErkJggg=="}}),n=rt({stroke:{color:"rgba(0, 133, 203, 1)",width:3,lineDash:[5,5]}}),o=rt({fill:{color:"rgba(0, 0, 0, 0.05)"},geometry:function(e){if("position"===e.get("id")){var t=e.getGeometry().getCoordinates(),n=Object(He.q)(t);return new Po.a(t,e.get("radius")*v(n))}}});return wt({type:"FeatureCollection",title:"Geolocation",zIndex:101,style:function(r){var a=[n];return"position"===r.get("id")&&(r.get("radius")>10&&r.get("radius")<5e3&&a.push(o),r.get("speed")>1?a.push(t):a.push(e),r.get("heading")&&t.getImage().setRotation(r.get("heading"))),a}})}}])&&mc(t.prototype,n),o&&mc(t,o),a}(re);n(409);function Sc(e){return(Sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oc(e,t){return(Oc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Cc(e);if(t){var r=Cc(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return xc(this,n)}}function xc(e,t){return!t||"object"!==Sc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cc(e){return(Cc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oc(e,t)}(n,e);var t=jc(n);function n(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(o=t.call(this,e)).el=fe()('<nav id="toolbar" class="btn-group-vertical btn-group-lg"></nav>'),o.create(),o.components={zoom:new cc(o.el),geolocation:$("app/geoLocation")&&new Ac(o.el),compass:new hc(o.el)},o}return n}(re),Pc=n(140);n(410);function Ec(e){return(Ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Tc(e,t){return(Tc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Gc(e);if(t){var r=Gc(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Lc(this,n)}}function Lc(e,t){return!t||"object"!==Ec(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gc(e){return(Gc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Fc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tc(e,t)}(a,e);var t,n,o,r=Mc(a);function a(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()('<div id="contextmenu-map"></div>');var n=$("map/contextmenu");return n||Q("map/contextmenu",n=[]),t.state={overlay:null,items:n,timeout:null,disableClick:!1},t.create(),t}return t=a,(n=[{key:"render",value:function(){var e=this;this.state.overlay=new ln.a({element:this.el[0],autoPan:!0,autoPanMargin:150,positioning:"center-center",offset:[0,0]});var t=$("map");t?this.init(t):$("map/que").push((function(t){e.init(t)}))}},{key:"init",value:function(e){var t=this;e.addOverlay(this.state.overlay),e.on("singleclick",(function(e){e.originalEvent.ctrlKey||t.state.disableClick||t.el.popover("dispose")})),e.getViewport().addEventListener("contextmenu",(function(n){n.preventDefault(),Q("event/contextmenu",!0);var o=e.getEventCoordinate(n),r=Tt(e,e.getEventPixel(n),o);r&&r[1].getGeometry()instanceof bo.a&&(o=r[1].getGeometry().getCoordinates()),t.open(o,t.getContent(o,r)),t.state.disableClick=!0,t.state.timeout=setTimeout((function(){t.state.disableClick=!1}),1e3)}))}},{key:"open",value:function(e,t){Pc.default.Defaults.modifiers.preventOverflow.enabled=!1,Pc.default.Defaults.modifiers.hide.enabled=!1,this.el.popover("dispose"),this.state.overlay.setPosition(e),this.el.popover(t.definition),this.el.on("shown.bs.popover",(function(e){t.onShow(fe()(e.target).data("bs.popover").tip)})),this.el.on("hidden.bs.popover",(function(){t.onHide(),Pc.default.Defaults.modifiers.preventOverflow.enabled=!0,Pc.default.Defaults.modifiers.hide.enabled=!0})),this.el.popover("show")}},{key:"getContent",value:function(e,t){var n=this,o=this.state.items.map((function(t,n){var o="function"==typeof t.content?t.content(e):t.content;return'<li class="list-group-item item-'.concat(n,'">').concat(o,"</li>")}));return{definition:{container:this.el,placement:"right",animation:!1,html:!0,content:o.join(""),offset:20*(this.state.items.length-1)+"px, 0",template:'\n          <div class="contextmenu popover">\n            <div class="arrow"></div>\n            <div class="popover-body"></div>\n          </div>'},onShow:function(o){fe()(o).on("contextmenu",(function(e){e.stopPropagation()})),n.state.items.forEach((function(r,a){"function"==typeof r.onClick&&fe()(o).on("click",".item-"+a,(function(o){o.preventDefault(),r.onClick(o,e,t),r.closeOnClick&&n.el.popover("dispose")})),"function"==typeof r.onBtnClick&&fe()(o).on("click",".item-".concat(a," .context-item-btn"),(function(o){o.preventDefault(),o.stopPropagation(),r.onBtnClick(o,e,t),r.closeOnClick&&n.el.popover("dispose")}))}))},onHide:function(){}}}}])&&_c(t.prototype,n),o&&_c(t,o),a}(re);function Dc(e){return(Dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nc(e,t){return(Nc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ic(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=qc(e);if(t){var r=qc(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Uc(this,n)}}function Uc(e,t){return!t||"object"!==Dc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qc(e){return(qc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Wc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nc(e,t)}(n,e);var t=Ic(n);function n(e){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),o=t.call(this,e),$("map/contextmenu").push({content:'<i class="fa fa-street-view size-1_1"></i> '.concat(ce("Street view")),onClick:function(e,t){var n=Object(He.q)(t).slice(0,2).reverse().join(",");fe()("<a>").attr("href",q.google.streetview+n).attr("target","_blank")[0].click()}}),o}return n}(re);n(411);function Vc(e){return(Vc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zc(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Bc(e,t){return(Bc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Yc(e);if(t){var r=Yc(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Jc(this,n)}}function Jc(e,t){return!t||"object"!==Vc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yc(e){return(Yc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bc(e,t)}(a,e);var t,n,o,r=Hc(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()('<div id="tooltip"></div>'),t.state={tooltipVisible:!1,overlay:null,currentFeature:null},t.create(),t}return t=a,(n=[{key:"render",value:function(){var e=this;this.state.overlay=new ln.a({element:this.el[0],autoPan:!1,positioning:"center-center",offset:[0,-14],stopEvent:!1});var t=$("map");t?this.init(t):$("map/que").push((function(t){e.init(t)}))}},{key:"init",value:function(e){var t=this;e.addOverlay(this.state.overlay),e.on("pointermove",(function(n){if(!n.dragging){var o=e.getEventPixel(n.originalEvent),r=e.hasFeatureAtPixel(o);e.getTarget().style.cursor=r?"pointer":"",t.state.tooltipVisible=t.open(!!r&&n.originalEvent,e)}}))}},{key:"open",value:function(e,t){if(!e)return this.el.html(""),this.state.overlay.setPosition(void 0),this.state.currentFeature=null,!1;var n=t.getEventCoordinate(e),o=t.forEachFeatureAtPixel(t.getEventPixel(e),(function(e,t){return e}));return o!==this.state.currentFeature&&(o.get("name")||o.get("title"))&&("Point"===o.getGeometry().getType()&&(n=o.getGeometry().getCoordinates()),this.el.html(ce(o.get("name")||o.get("title"))),this.state.overlay.setPosition(n),this.state.currentFeature=o),!0}}])&&zc(t.prototype,n),o&&zc(t,o),a}(re);n(412);function Xc(e){return(Xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kc(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Qc(e,t){return(Qc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ns(e);if(t){var r=ns(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return es(this,n)}}function es(e,t){return!t||"object"!==Xc(t)&&"function"!=typeof t?ts(e):t}function ts(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ns(e){return(ns=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var os=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qc(e,t)}(a,e);var t,n,o,r=$c(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=fe()('<div id="popup-map"></div>'),t.state={overlay:null,infoStore:[],geomTypes:{points:["Point"],linestrings:["LineString","MultiLineString"],polygons:["Polygon","MultiPolygon"]},offset:0,open:!1,addPoints:[]},t.handlers={clicked:function(e){e.originalEvent.ctrlKey||$("event/contextmenu")?Q("event/contextmenu",!1):t.open(e)}},t.format={geojson:new Be.a},t.create(),Q("components/featureInfo",ts(t)),t}return t=a,(n=[{key:"render",value:function(){var e=this;this.state.overlay=new ln.a({element:this.el[0],positioning:"center-center",offset:[0,-this.state.offset]});var t=$("map");t?(this.state.map=t,this.init(t)):$("map/que").push((function(t){e.state.map=t,e.init(t)}))}},{key:"init",value:function(e){e.addOverlay(this.state.overlay),this.enable()}},{key:"enable",value:function(){this.state.map.on("singleclick",this.handlers.clicked)}},{key:"disable",value:function(){this.state.map.un("singleclick",this.handlers.clicked)}},{key:"show",value:function(e,t,n,o){var r=this;this.state.overlay.setPosition(t),this.el.popover(o.definition),this.el.on("shown.bs.popover",(function(t){r.state.open=!0;var a=o.definition.container.find(".popup").height();r.state.overlay.setOffset([0,a+r.state.offset+20>e.pixel[1]?r.state.offset:-r.state.offset]),o.onShow(n,fe()(t.target).data("bs.popover").tip)})),this.el.on("hidden.bs.popover",(function(e){o.onHide(e)})),this.el.popover("show"),Q("popup/show",{layerId:n?n[0].get("id"):null,feature:n?n[1]:null})}},{key:"open",value:function(e){var t,n=this,o=e.coordinate,r=Tt(this.state.map,e.pixel,o);if(!this.state.open||(this.el.popover("dispose"),this.state.open=!1,r))if(r){if("Point"===r[1].getGeometry().getType()&&(o=r[1].getGeometry().getCoordinates()),(t=r[0]&&this.state.infoStore[r[0].get("id")]?this.state.infoStore[r[0].get("id")](r[1]):this.getContent(r[1],r[0]))&&this.show(e,o,r,t),r[1].get("isCache")){this.state.addPoints.forEach((function(e){e.set("hidden",!0)})),this.state.addPoints=[];var a=r[1].get("eid");this.state.addPoints=r[0].getSource().getFeatures().filter((function(e){return!(!e.get("isCachePoint")||!e.get("pid")||e.get("pid")!==a||(e.set("hidden",!1),0))}))}}else!function(){for(var a=n.state.map.getView().getResolution(),i=$("map/layer/layers").getArray().filter((function(e){return"TileWMS"===e.get("conf").type&&e.getVisible()})),c=null,s=function(s){var l=i[s].getSource().getParams().LAYERS;c=i[s].getSource().getFeatureInfoUrl(o,a,n.state.map.getView().getProjection(),{INFO_FORMAT:"application/json",QUERY_LAYERS:l.split(",").reverse().join(","),FEATURE_COUNT:l.split(",").length}),n.getWMSFeatureInfo(c,(function(a){if(a){var c=n.format.geojson.readFeatures(a);c.length&&(t=n.getContent(c[0],i[s]),n.show(e,o,r,t))}}))},l=i.length-1;l>=0;l--)s(l)}()}},{key:"getContent",value:function(e,t){var n=this;if(e&&t){var o,r,a=e.getProperties(),i=$("geocache/trip");if(t.get("_featureInfo")){var s=t.get("_featureInfo");o="function"==typeof s.title?s.title(e):s.title,r="function"==typeof s.content?s.content(e):s.content}else o='\n          <i class="fa fa-map-marker-alt"></i>\n          '.concat(ce("Feature"),'\n          <div class="tools">\n            <a href="#" class="remove-marker" title="Eemalda">\n              <i class="far fa-trash-alt"></i>\n            </a>\n            ').concat(e.getGeometry()instanceof bo.a?'\n            <a href="#" class="cache-toggle" data-id="'.concat(e.get("id"),'" title="').concat(ce("Add to geotrip"),'">\n              <i class="fas ').concat(i&&i.getArray().indexOf(e)>-1?"fa-minus-square":"fa-thumbtack",'"></i>\n            </a>\n            '):"","\n          </div>"),r=Object.keys(a).filter((function(e){return"string"==typeof a[e]||"number"==typeof a[e]||"boolean"==typeof a[e]})).map((function(e){return"".concat(e,": ").concat((t=a[e],String(t).replace(/((http|https|ftp|ftps):\/\/[a-zA-Z0-9\-.]+\.[a-zA-Z]{2,3}(\/\S*)?)/g,'<a href="$1" target="_blank">$1</a>')));var t})),this.state.geomTypes.linestrings.indexOf(e.getGeometry().getType())>-1&&r.push("".concat(ce("Length"),": ").concat(j(e.getGeometry()))),this.state.geomTypes.polygons.indexOf(e.getGeometry().getType())>-1&&r.push("".concat(ce("Area"),": ").concat(x(e.getGeometry()))),r=r.join("<br>");if(this.state.geomTypes.points.indexOf(e.getGeometry().getType())>-1&&$("map/geolocation")){var l=$("map/geolocation/position"),u=Object(c.b)(Object(He.q)(l),Object(He.q)(e.getGeometry().getCoordinates()));r+='<div class="distance"><i class="fas fa-location-arrow"></i>\n          '.concat(j(null,u),"</div>")}return{definition:{container:this.el,placement:"top",animation:!1,html:!0,title:o,content:r,template:'\n            <div class="popup popover">\n              <div class="arrow"></div>\n              <h3 class="popover-header"></h3>\n              <div class="popover-body"></div>\n            </div>'},onShow:function(e,t){var o=$("geocache/trip");fe()(t).on("contextmenu",(function(e){e.stopPropagation()})),fe()(t).on("click",".remove-marker",(function(t){t.preventDefault(),e&&e[0]&&(e[0].getSource().removeFeature(e[1]),o&&o.remove(e[1]),n.el.popover("dispose"))})),fe()(t).on("click",".cache-toggle",(function(t){t.preventDefault(),fe()(t.currentTarget).find("i").toggleClass("fa-thumbtack fa-minus-square"),o&&(o.getArray().indexOf(e[1])>-1?o.remove(e[1]):o.push(e[1]))})),fe()(t).on("click",".distance",(function(t){t.preventDefault(),fo([Object(He.q)($("map/geolocation/position")),Object(He.q)(e[1].getGeometry().getCoordinates())]).then((function(t){t&&Q("navigate/to",e[1])})).catch((function(t){Q("navigate/to",e[1])}))})),e&&e[0]&&e[0].get("_featureInfo")&&"function"==typeof e[0].get("_featureInfo").onShow&&e[0].get("_featureInfo").onShow(e,t)},onHide:function(){}}}}},{key:"getWMSFeatureInfo",value:function(e,t){fe.a.ajax({type:"GET",crossDomain:!0,url:e,dataType:"json",context:this}).done(t).fail((function(e){t(null)}))}}])&&Kc(t.prototype,n),o&&Kc(t,o),a}(re);function rs(e){return(rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function as(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function is(e,t){return(is=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ls(e);if(t){var r=ls(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return ss(this,n)}}function ss(e,t){return!t||"object"!==rs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ls(e){return(ls=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var us=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&is(e,t)}(a,e);var t,n,o,r=cs(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).el=null,t.state={active:!1,to:null,route:new wo.a(new vo.a([]))},t.state.route.setStyle(rt({stroke:{color:"rgba(0, 133, 203, 0.6)",width:1}})),ee("navigate/to",(function(e){e?t.activate(e):t.deactivate()})),ee("map/geolocation/position",(function(){t.state.active&&t.update()})),t}return t=a,(n=[{key:"update",value:function(){var e=$("map/geolocation/position"),t=this.state.to.getGeometry().getCoordinates(),n=E(e,t),o=Object(c.b)(Object(He.q)(e),Object(He.q)(t));Q("routing/info","\n      ".concat(j(null,o,[0,1]),"\n      <i>&middot;</i> ").concat(Math.round(n),"&deg;\n    ")),this.state.route.getGeometry().setCoordinates([e,t])}},{key:"activate",value:function(e){this.state.to=e,(lo||(lo=ho()).setMap($("map")),lo).getSource().addFeature(this.state.route),this.state.active=!0,this.update()}},{key:"deactivate",value:function(){this.state.route.getGeometry().setCoordinates([]),this.state.active=!1}}])&&as(t.prototype,n),o&&as(t,o),a}(re);n(413);function fs(e){return(fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ps(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ds(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function hs(e,t){return(hs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ys(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ms(e);if(t){var r=ms(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return gs(this,n)}}function gs(e,t){return!t||"object"!==fs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ms(e){return(ms=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hs(e,t)}(a,e);var t,n,o,r=ys(a);function a(){return ps(this,a),r.apply(this,arguments)}return t=a,(n=[{key:"render",value:function(){var e=$("app/debug");e&&(["debug","error","info"].forEach((function(e){console[e+"_"]=console[e],console[e]=function(){for(var t=(new Date).toISOString(),n=t,o=0,r=arguments.length;o<r;o++){var a=arguments[o];n+=" "+f(a),"object"===f(a)&&"object"===("undefined"==typeof JSON?"undefined":f(JSON))&&"function"==typeof JSON.stringify?function(){var e=[];n+=" "+JSON.stringify(a,(function(t,n){if("object"===f(n)&&null!==n){if(-1!==e.indexOf(n))try{return JSON.parse(JSON.stringify(n))}catch(e){return}e.push(n)}return n}))}():n+=" "+a}d.push(n),console[e+"_"].apply(void 0,arguments)}})),console.debug("Debug mode enabled")),ie($("app/locale"),Me),e&&console.debug("Locale: "+$("app/locale")),this.components={map:new Mt(this.target),contextmenu:new Fc(this.target),header:new Fa(this.target),statusbar:new ec(this.target),toolbar:new Rc(this.target),streetview:$("app/streetView")&&new Wc(this.target),tooltip:$("app/tooltip")&&new Zc(this.target),popup:$("app/featureInfo")&&new os(this.target),routing:$("app/routing")&&new yo(this.target),navigation:$("app/routing")&&new us(this.target)},this.components.map.init()}}])&&ds(t.prototype,n),o&&ds(t,o),a}(re),vs=null,ws=fe()("#geop");function ks(){vs&&(vs.destroy(),vs=null,ws.html("")),window.location.reload()}!function(){if("serviceWorker"in navigator==0)return console.log("Service worker is not supported"),!1;navigator.serviceWorker.register("sw.js").then((function(e){e.onupdatefound=function(){if(navigator.serviceWorker.controller){var t=e.installing;t.onstatechange=function(){switch(t.state){case"installed":break;case"redundant":throw new Error("The installing service worker became redundant.")}}}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}(),"onhashchange"in window&&(T.newURL=k(document.URL),T.hash=L(k(document.URL).hash),window.addEventListener("hashchange",(function(e){T.oldURL=T.newURL,T.newURL=k(e.newURL),T.hash=L(T.newURL.hash),M.forEach((function(e){e(T.hash)})),_=!1}),!1)),Te().then((function(e){new bs(ws).render()}))}});